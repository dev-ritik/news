(function(b){b.fn.ticker=function(h){var f=b.extend({},b.fn.ticker.defaults,h);if(b(this).length==0){if(window.console&&window.console.log){window.console.log("Element does not exist in DOM!")}else{alert("Element does not exist in DOM!")}return false}var a="#"+b(this).attr("id");var g=b(this).get(0).tagName;return this.each(function(){var B=t();var z={position:0,time:0,distance:0,newsArr:{},play:true,paused:false,contentLoaded:false,dom:{contentID:"#ticker-content-"+B,titleID:"#ticker-title-"+B,titleElem:"#ticker-title-"+B+" SPAN",tickerID:"#ticker-"+B,wrapperID:"#ticker-wrapper-"+B,revealID:"#ticker-swipe-"+B,revealElem:"#ticker-swipe-"+B+" SPAN",controlsID:"#ticker-controls-"+B,prevID:"#prev-"+B,nextID:"#next-"+B,playPauseID:"#play-pause-"+B}};
if(g!="UL"&&g!="OL"&&f.htmlFeed===true){d("Cannot use <"+g.toLowerCase()+"> type of element for this plugin - must of type <ul> or <ol>");return false}f.direction=="rtl"?f.direction="right":f.direction="left";C();function w(i){var j=0,k;for(k in i){if(i.hasOwnProperty(k)){j++}}return j}function t(){var i=new Date;return i.getTime()}function d(i){if(f.debugMode){if(window.console&&window.console.log){window.console.log(i)}else{alert(i)}}}function C(){v();b(a).wrap('<div id="'+z.dom.wrapperID.replace("#","")+'"></div>');
b(z.dom.wrapperID).children().remove();b(z.dom.wrapperID).append('<div id="'+z.dom.tickerID.replace("#","")+'" class="ticker"><div id="'+z.dom.titleID.replace("#","")+'" class="ticker-title"><span><!-- --></span></div><p class="ticker-content"> <span id="'+z.dom.contentID.replace("#","")+'" ></span></p><div id="'+z.dom.revealID.replace("#","")+'" class="ticker-swipe"><span><!-- --></span></div></div>');b(z.dom.wrapperID).removeClass("no-js").addClass("ticker-wrapper has-js "+f.direction);b(z.dom.tickerElem+","+z.dom.contentID).hide();
if(f.controls){b(z.dom.controlsID).live("click mouseover mousedown mouseout mouseup",function(i){var j=i.target.id;if(i.type=="click"){switch(j){case z.dom.prevID.replace("#",""):z.paused=true;b(z.dom.playPauseID).addClass("paused");u("prev");break;case z.dom.nextID.replace("#",""):z.paused=true;b(z.dom.playPauseID).addClass("paused");u("next");break;case z.dom.playPauseID.replace("#",""):if(z.play==true){z.paused=true;b(z.dom.playPauseID).addClass("paused");y()}else{z.paused=false;b(z.dom.playPauseID).removeClass("paused");
e()}break}}else{if(i.type=="mouseover"&&b("#"+j).hasClass("controls")){b("#"+j).addClass("over")}else{if(i.type=="mousedown"&&b("#"+j).hasClass("controls")){b("#"+j).addClass("down")}else{if(i.type=="mouseup"&&b("#"+j).hasClass("controls")){b("#"+j).removeClass("down")}else{if(i.type=="mouseout"&&b("#"+j).hasClass("controls")){b("#"+j).removeClass("over")}}}}}});b(z.dom.wrapperID).append('<ul id="'+z.dom.controlsID.replace("#","")+'" class="ticker-controls"><li id="'+z.dom.prevID.replace("#","")+'" class="jnt-prev controls"><a href=""><!-- --></a></li><li id="'+z.dom.playPauseID.replace("#","")+'" class="jnt-play-pause controls"><a href=""><!-- --></a></li><li id="'+z.dom.nextID.replace("#","")+'" class="jnt-next controls"><a href=""><!-- --></a></li></ul><a class="mailer_icon" title="Subscribe to Newsletter" href=/newsletterhome.cms?utm_source='+window.location.href+"&utm_medium=referral&utm_campaign=breakingnewsletter ></a>")
}if(f.displayType!="fade"){}if(!f.ajaxFeed){c()}}function v(){if(z.contentLoaded==false){if(f.ajaxFeed){if(f.feedType=="xml"){b.ajax({url:f.feedUrl,cache:false,dataType:f.feedType,async:true,success:function(n){count=0;for(var l=0;l<n.childNodes.length;l++){if(n.childNodes[l].nodeName=="rss"){xmlContent=n.childNodes[l]}}for(var k=0;k<xmlContent.childNodes.length;k++){if(xmlContent.childNodes[k].nodeName=="channel"){xmlChannel=xmlContent.childNodes[k]}}for(var m=0;m<xmlChannel.childNodes.length;m++){if(xmlChannel.childNodes[m].nodeName=="item"){xmlItems=xmlChannel.childNodes[m];
var i,j=false;for(var o=0;o<xmlItems.childNodes.length;o++){if(xmlItems.childNodes[o].nodeName=="title"){i=xmlItems.childNodes[o].lastChild.nodeValue}else{if(xmlItems.childNodes[o].nodeName=="link"){j=xmlItems.childNodes[o].lastChild.nodeValue}}if((i!==false&&i!="")&&j!==false){z.newsArr["item-"+count]={type:f.titleText,content:'<a href="'+j+'">'+i+"</a>"};count++;i=false;j=false}}}}if(w(z.newsArr<1)){d("Couldn't find any content from the XML feed for the ticker to use!");return false}z.contentLoaded=true;
c()}})}else{d("Code Me!")}}else{if(f.htmlFeed){if(b(a+" LI").length>0){b(a+" LI").each(function(i){z.newsArr["item-"+i]={type:f.titleText,content:b(this).html()}})}else{d("Couldn't find HTML any content for the ticker to use!");return false}}else{d("The ticker is set to not use any types of content! Check the settings for the ticker.");return false}}}}function c(){z.contentLoaded=true;z.nextnewslock=0;b(z.dom.titleElem).html(z.newsArr["item-"+z.position].type);b(z.dom.contentID).html(z.newsArr["item-"+z.position].content);
var j=b(z.dom.contentID).text();b(".ticker-content").css("margin-left","0px");b(".ticker-content span").css("margin-left","0px");var m=90;var l=window.innerWidth;if(l>=768&&l<=999){m=40}var k=1;if((j.length>m)&&k==1){z.nextnewslock=1;var i=(navigator.userAgent.match(/(iPad)/g)?true:false);if(i){timer=3000}else{timer=6500}shift=0;setTimeout(function(){mycount=function(p,o){var q=window.innerWidth;if(q>=768&&q<=999){o+=8.5}else{o+=11.5}p++;if((j.length-m)>=p){o=mycount(p++,o)}return o};var n=mycount(1,0);
if(z.nextnewslock==1){b(".ticker-content span").css("margin-left","").delay(1).animate({marginLeft:"-"+n+"px"},((j.length-m)*310),"linear",function(){try{if(homeObj.breakingNewsPause==1){b(".ticker-content span").css("margin-left","0px")}}catch(o){console.log(o)}})}},timer)}if(z.position==(w(z.newsArr)-1)){z.position=0}else{z.position++}distance=b(z.dom.contentID).width();time=distance/f.speed;A()}function A(){b(z.dom.contentID).css("opacity","1");if(z.play){var i=b(z.dom.titleID).width()+45;b(z.dom.revealID).css(f.direction,i+"px");
if(f.displayType=="fade"){b(z.dom.revealID).hide(0,function(){b(z.dom.contentID).css(f.direction,i+"px").fadeIn(f.fadeInSpeed,x)})}else{if(f.displayType=="scroll"){}else{b(z.dom.revealElem).show(0,function(){b(z.dom.contentID).css(f.direction,i+"px").show();animationAction=f.direction=="right"?{marginRight:distance+"px"}:{marginLeft:distance+"px"};b(z.dom.revealID).css("margin-"+f.direction,"0px").delay(20).animate(animationAction,time,"linear",x)})}}}else{return false}}function x(){if(z.play){b(z.dom.contentID).delay(2500).fadeOut(f.fadeOutSpeed);
if(f.displayType=="fade"){b(z.dom.contentID).fadeOut(f.fadeOutSpeed,function(){b(z.dom.wrapperID).find(z.dom.revealElem+","+z.dom.contentID).hide().end().find(z.dom.tickerID+","+z.dom.revealID).show().end().find(z.dom.tickerID+","+z.dom.revealID).removeAttr("style");c()})}else{b(z.dom.revealID).hide(0,function(){b(z.dom.contentID).fadeOut(f.fadeOutSpeed,function(){b(z.dom.wrapperID).find(z.dom.revealElem+","+z.dom.contentID).hide().end().find(z.dom.tickerID+","+z.dom.revealID).show().end().find(z.dom.tickerID+","+z.dom.revealID).removeAttr("style");
c()})})}}else{b(z.dom.revealElem).hide()}}function y(){homeObj.breakingNewsPause=1;z.play=false;b(z.dom.tickerID+","+z.dom.revealID+","+z.dom.titleID+","+z.dom.titleElem+","+z.dom.revealElem+","+z.dom.contentID).stop(true,true);b(z.dom.revealID+","+z.dom.revealElem).hide();b(z.dom.wrapperID).find(z.dom.titleID+","+z.dom.titleElem).show().end().find(z.dom.contentID).show()}function e(){z.nextnewslock=0;z.play=true;z.paused=false;homeObj.breakingNewsPause=0;x()}function u(i){y();homeObj.breakingNewsPause=1;
b(".ticker-content span").css("margin-left","0px");switch(i){case"prev":if(z.position==0){z.position=w(z.newsArr)-2}else{if(z.position==1){z.position=w(z.newsArr)-1}else{z.position=z.position-2}}b(z.dom.titleElem).html(z.newsArr["item-"+z.position].type);b(z.dom.contentID).html(z.newsArr["item-"+z.position].content);break;case"next":b(z.dom.titleElem).html(z.newsArr["item-"+z.position].type);b(z.dom.contentID).html(z.newsArr["item-"+z.position].content);break}if(z.position==(w(z.newsArr)-1)){z.position=0
}else{z.position++}}})};b.fn.ticker.defaults={speed:0.1,ajaxFeed:false,feedUrl:"",feedType:"xml",displayType:"reveal",htmlFeed:true,debugMode:true,controls:true,titleText:"Breaking News",direction:"ltr",pauseOnItems:3000,fadeInSpeed:600,fadeOutSpeed:300}})(jQuery);var TimesApps=window.TimesApps||{};TimesApps.isIncognito=false;(function(){function e(l,b){var c=0,k=50,m=10,n=false;var a=window.setInterval(function(){if(l()){window.clearInterval(a);b(n)}if(c++>k){window.clearInterval(a);n=true;b(n)}},10)
}function f(b){var a=b.toLowerCase();if(a.indexOf("msie")===0&&a.indexOf("trident")===0){return false}var c=/(?:msie|rv:)\s?([\d\.]+)/.exec(a);if(c&&parseInt(c[1],10)>=10){return true}return false}function d(a){var c;if(window.webkitRequestFileSystem){window.webkitRequestFileSystem(window.TEMPORARY,1,function(){c=false},function(g){c=true})}else{if(window.indexedDB&&/Firefox/.test(window.navigator.userAgent)){var l;try{l=window.indexedDB.open("test")}catch(b){c=true}if(typeof c==="undefined"){e(function m(){return l.readyState==="done"?true:false
},function k(g){if(!g){c=l.result?false:true}})}}else{if(f(window.navigator.userAgent)){c=false;try{if(!window.indexedDB){c=true}}catch(b){c=true}}else{if(window.localStorage&&/Safari/.test(window.navigator.userAgent)){try{window.localStorage.setItem("test",1)}catch(b){c=true}if(typeof c==="undefined"){c=false;window.localStorage.removeItem("test")}}}}}e(function m(){return typeof c!=="undefined"?true:false},function k(g){a(c)})}d(function(a){TimesApps.isIncognito=typeof a==="undefined"?false:a?true:false;
if(TimesApps.isIncognito&&typeof ga!="undefined"){ga("send","event","Incognito_WEB",window.navigator.userAgent,window.location.href)}})})();(function(c){function b(g){var q=g||window.event,e=[].slice.call(arguments,1),f=0,h=!0,o=0,p=0;return g=c.event.fix(q),g.type="mousewheel",q.wheelDelta&&(f=q.wheelDelta/120),q.detail&&(f=-q.detail/3),p=f,q.axis!==undefined&&q.axis===q.HORIZONTAL_AXIS&&(p=0,o=-1*f),q.wheelDeltaY!==undefined&&(p=q.wheelDeltaY/120),q.wheelDeltaX!==undefined&&(o=-1*q.wheelDeltaX/120),e.unshift(g,f,o,p),(c.event.dispatch||c.event.handle).apply(this,e)
}var d=["DOMMouseScroll","mousewheel"];if(c.event.fixHooks){for(var a=d.length;a;){c.event.fixHooks[d[--a]]=c.event.mouseHooks}}c.event.special.mousewheel={setup:function(){if(this.addEventListener){for(var e=d.length;e;){this.addEventListener(d[--e],b,!1)}}else{this.onmousewheel=b}},teardown:function(){if(this.removeEventListener){for(var e=d.length;e;){this.removeEventListener(d[--e],b,!1)}}else{this.onmousewheel=null}}},c.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")
},unmousewheel:function(e){return this.unbind("mousewheel",e)}})})(jQuery);(function(a){var d={init:function(e){var f={set_width:false,set_height:false,horizontalScroll:false,scrollInertia:950,mouseWheel:true,mouseWheelPixels:"auto",autoDraggerLength:true,autoHideScrollbar:false,alwaysShowScrollbar:false,snapAmount:null,snapOffset:0,scrollButtons:{enable:false,scrollType:"continuous",scrollSpeed:"auto",scrollAmount:40},advanced:{updateOnBrowserResize:true,updateOnContentResize:false,autoExpandHorizontalScroll:false,autoScrollOnFocus:true,normalizeMouseWheelDelta:false},contentTouchScroll:true,callbacks:{onScrollStart:function(){},onScroll:function(){},onTotalScroll:function(){},onTotalScrollBack:function(){},onTotalScrollOffset:0,onTotalScrollBackOffset:0,whileScrolling:function(){}},theme:"light"},e=a.extend(true,f,e);
return this.each(function(){var n=a(this);if(e.set_width){n.css("width",e.set_width)}if(e.set_height){n.css("height",e.set_height)}if(!a(document).data("mCustomScrollbar-index")){a(document).data("mCustomScrollbar-index","1")}else{var t=parseInt(a(document).data("mCustomScrollbar-index"));a(document).data("mCustomScrollbar-index",t+1)}n.wrapInner("<div class='mCustomScrollBox mCS-"+e.theme+"' id='mCSB_"+a(document).data("mCustomScrollbar-index")+"' style='position:relative; height:100%; overflow:hidden; max-width:100%;' />").addClass("mCustomScrollbar _mCS_"+a(document).data("mCustomScrollbar-index"));
var I=n.children(".mCustomScrollBox");if(e.horizontalScroll){I.addClass("mCSB_horizontal").wrapInner("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />");var j=I.children(".mCSB_h_wrapper");j.wrapInner("<div class='mCSB_container' style='position:absolute; left:0;' />").children(".mCSB_container").css({width:j.children().outerWidth(),position:"relative"}).unwrap()}else{I.wrapInner("<div class='mCSB_container' style='position:relative; top:0;' />")}var p=I.children(".mCSB_container");
if(a.support.touch){p.addClass("mCS_touch")}p.after("<div class='mCSB_scrollTools' style='position:absolute;'><div class='mCSB_draggerContainer'><div class='mCSB_dragger' style='position:absolute;' oncontextmenu='return false;'><div class='mCSB_dragger_bar' style='position:relative;'></div></div><div class='mCSB_draggerRail'></div></div></div>");var m=I.children(".mCSB_scrollTools"),g=m.children(".mCSB_draggerContainer"),k=g.children(".mCSB_dragger");if(e.horizontalScroll){k.data("minDraggerWidth",k.width())
}else{k.data("minDraggerHeight",k.height())}if(e.scrollButtons.enable){if(e.horizontalScroll){m.prepend("<a class='mCSB_buttonLeft' oncontextmenu='return false;'></a>").append("<a class='mCSB_buttonRight' oncontextmenu='return false;'></a>")}else{m.prepend("<a class='mCSB_buttonUp' oncontextmenu='return false;'></a>").append("<a class='mCSB_buttonDown' oncontextmenu='return false;'></a>")}}I.bind("scroll",function(){if(!n.is(".mCS_disabled")){I.scrollTop(0).scrollLeft(0)}});n.data({mCS_Init:true,mCustomScrollbarIndex:a(document).data("mCustomScrollbar-index"),horizontalScroll:e.horizontalScroll,scrollInertia:e.scrollInertia,scrollEasing:"mcsEaseOut",mouseWheel:e.mouseWheel,mouseWheelPixels:e.mouseWheelPixels,autoDraggerLength:e.autoDraggerLength,autoHideScrollbar:e.autoHideScrollbar,alwaysShowScrollbar:e.alwaysShowScrollbar,snapAmount:e.snapAmount,snapOffset:e.snapOffset,scrollButtons_enable:e.scrollButtons.enable,scrollButtons_scrollType:e.scrollButtons.scrollType,scrollButtons_scrollSpeed:e.scrollButtons.scrollSpeed,scrollButtons_scrollAmount:e.scrollButtons.scrollAmount,autoExpandHorizontalScroll:e.advanced.autoExpandHorizontalScroll,autoScrollOnFocus:e.advanced.autoScrollOnFocus,normalizeMouseWheelDelta:e.advanced.normalizeMouseWheelDelta,contentTouchScroll:e.contentTouchScroll,onScrollStart_Callback:e.callbacks.onScrollStart,onScroll_Callback:e.callbacks.onScroll,onTotalScroll_Callback:e.callbacks.onTotalScroll,onTotalScrollBack_Callback:e.callbacks.onTotalScrollBack,onTotalScroll_Offset:e.callbacks.onTotalScrollOffset,onTotalScrollBack_Offset:e.callbacks.onTotalScrollBackOffset,whileScrolling_Callback:e.callbacks.whileScrolling,bindEvent_scrollbar_drag:false,bindEvent_content_touch:false,bindEvent_scrollbar_click:false,bindEvent_mousewheel:false,bindEvent_buttonsContinuous_y:false,bindEvent_buttonsContinuous_x:false,bindEvent_buttonsPixels_y:false,bindEvent_buttonsPixels_x:false,bindEvent_focusin:false,bindEvent_autoHideScrollbar:false,mCSB_buttonScrollRight:false,mCSB_buttonScrollLeft:false,mCSB_buttonScrollDown:false,mCSB_buttonScrollUp:false});
if(e.horizontalScroll){if(n.css("max-width")!=="none"){if(!e.advanced.updateOnContentResize){e.advanced.updateOnContentResize=true}}}else{if(n.css("max-height")!=="none"){var r=false,l=parseInt(n.css("max-height"));if(n.css("max-height").indexOf("%")>=0){r=l,l=n.parent().height()*r/100}n.css("overflow","hidden");I.css("max-height",l)}}n.mCustomScrollbar("update");if(e.advanced.updateOnBrowserResize){var h,i=a(window).width(),u=a(window).height();a(window).bind("resize."+n.data("mCustomScrollbarIndex"),function(){if(h){clearTimeout(h)
}h=setTimeout(function(){if(!n.is(".mCS_disabled")&&!n.is(".mCS_destroyed")){var w=a(window).width(),v=a(window).height();if(i!==w||u!==v){if(n.css("max-height")!=="none"&&r){I.css("max-height",n.parent().height()*r/100)}n.mCustomScrollbar("update");i=w;u=v}}},150)})}if(e.advanced.updateOnContentResize){var q;if(e.horizontalScroll){var o=p.outerWidth()}else{var o=p.outerHeight()}q=setInterval(function(){if(e.horizontalScroll){if(e.advanced.autoExpandHorizontalScroll){p.css({position:"absolute",width:"auto"}).wrap("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />").css({width:p.outerWidth(),position:"relative"}).unwrap()
}var v=p.outerWidth()}else{var v=p.outerHeight()}if(v!=o){n.mCustomScrollbar("update");o=v}},300)}})},update:function(){var n=a(this),k=n.children(".mCustomScrollBox"),r=k.children(".mCSB_container");r.removeClass("mCS_no_scrollbar");n.removeClass("mCS_disabled mCS_destroyed");k.scrollTop(0).scrollLeft(0);var D=k.children(".mCSB_scrollTools"),o=D.children(".mCSB_draggerContainer"),m=o.children(".mCSB_dragger");if(n.data("horizontalScroll")){var p=D.children(".mCSB_buttonLeft"),y=D.children(".mCSB_buttonRight"),f=k.width();
if(n.data("autoExpandHorizontalScroll")){r.css({position:"absolute",width:"auto"}).wrap("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />").css({width:r.outerWidth(),position:"relative"}).unwrap()}var aa=r.outerWidth()}else{var B=D.children(".mCSB_buttonUp"),g=D.children(".mCSB_buttonDown"),u=k.height(),i=r.outerHeight()}if(i>u&&!n.data("horizontalScroll")){D.css("display","block");var w=o.height();if(n.data("autoDraggerLength")){var z=Math.round(u/i*w),l=m.data("minDraggerHeight");
if(z<=l){m.css({height:l})}else{if(z>=w-10){var q=w-10;m.css({height:q})}else{m.css({height:z})}}m.children(".mCSB_dragger_bar").css({"line-height":m.height()+"px"})}var t=m.height(),C=(i-u)/(w-t);n.data("scrollAmount",C).mCustomScrollbar("scrolling",k,r,o,m,B,g,p,y);var x=Math.abs(r.position().top);n.mCustomScrollbar("scrollTo",x,{scrollInertia:0,trigger:"internal"})}else{if(aa>f&&n.data("horizontalScroll")){D.css("display","block");var h=o.width();if(n.data("autoDraggerLength")){var j=Math.round(f/aa*h),v=m.data("minDraggerWidth");
if(j<=v){m.css({width:v})}else{if(j>=h-10){var e=h-10;m.css({width:e})}else{m.css({width:j})}}}var A=m.width(),C=(aa-f)/(h-A);n.data("scrollAmount",C).mCustomScrollbar("scrolling",k,r,o,m,B,g,p,y);var x=Math.abs(r.position().left);n.mCustomScrollbar("scrollTo",x,{scrollInertia:0,trigger:"internal"})}else{k.unbind("mousewheel focusin");if(n.data("horizontalScroll")){m.add(r).css("left",0)}else{m.add(r).css("top",0)}if(n.data("alwaysShowScrollbar")){if(!n.data("horizontalScroll")){m.css({height:o.height()})
}else{if(n.data("horizontalScroll")){m.css({width:o.width()})}}}else{D.css("display","none");r.addClass("mCS_no_scrollbar")}n.data({bindEvent_mousewheel:false,bindEvent_focusin:false})}}},scrolling:function(e,n,j,g,m,F,r,D){var h=a(this);if(!h.data("bindEvent_scrollbar_drag")){var k,l,p,H,C;if(a.support.pointer){p="pointerdown";H="pointermove";C="pointerup"}else{if(a.support.msPointer){p="MSPointerDown";H="MSPointerMove";C="MSPointerUp"}}if(a.support.pointer||a.support.msPointer){g.bind(p,function(J){J.preventDefault();
h.data({on_drag:true});g.addClass("mCSB_dragger_onDrag");var I=a(this),x=I.offset(),y=J.originalEvent.pageX-x.left,K=J.originalEvent.pageY-x.top;if(y<I.width()&&y>0&&K<I.height()&&K>0){k=K;l=y}});a(document).bind(H+"."+h.data("mCustomScrollbarIndex"),function(J){J.preventDefault();if(h.data("on_drag")){var I=g,x=I.offset(),y=J.originalEvent.pageX-x.left,K=J.originalEvent.pageY-x.top;A(k,l,K,y)}}).bind(C+"."+h.data("mCustomScrollbarIndex"),function(x){h.data({on_drag:false});g.removeClass("mCSB_dragger_onDrag")
})}else{g.bind("mousedown touchstart",function(J){J.preventDefault();J.stopImmediatePropagation();var I=a(this),x=I.offset(),y,L;if(J.type==="touchstart"){var K=J.originalEvent.touches[0]||J.originalEvent.changedTouches[0];y=K.pageX-x.left;L=K.pageY-x.top}else{h.data({on_drag:true});g.addClass("mCSB_dragger_onDrag");y=J.pageX-x.left;L=J.pageY-x.top}if(y<I.width()&&y>0&&L<I.height()&&L>0){k=L;l=y}}).bind("touchmove",function(J){J.preventDefault();J.stopImmediatePropagation();var x=J.originalEvent.touches[0]||J.originalEvent.changedTouches[0],I=a(this),L=I.offset(),y=x.pageX-L.left,K=x.pageY-L.top;
A(k,l,K,y)});a(document).bind("mousemove."+h.data("mCustomScrollbarIndex"),function(J){if(h.data("on_drag")){var I=g,x=I.offset(),y=J.pageX-x.left,K=J.pageY-x.top;A(k,l,K,y)}}).bind("mouseup."+h.data("mCustomScrollbarIndex"),function(x){h.data({on_drag:false});g.removeClass("mCSB_dragger_onDrag")})}h.data({bindEvent_scrollbar_drag:true})}function A(y,I,J,x){if(h.data("horizontalScroll")){h.mCustomScrollbar("scrollTo",(g.position().left-(I))+x,{moveDragger:true,trigger:"internal"})}else{h.mCustomScrollbar("scrollTo",(g.position().top-(y))+J,{moveDragger:true,trigger:"internal"})
}}if(a.support.touch&&h.data("contentTouchScroll")){if(!h.data("bindEvent_content_touch")){var i,u,t,w,B,z,E;n.bind("touchstart",function(x){x.stopImmediatePropagation();i=x.originalEvent.touches[0]||x.originalEvent.changedTouches[0];u=a(this);t=u.offset();B=i.pageX-t.left;w=i.pageY-t.top;z=w;E=B});n.bind("touchmove",function(x){x.preventDefault();x.stopImmediatePropagation();i=x.originalEvent.touches[0]||x.originalEvent.changedTouches[0];u=a(this).parent();t=u.offset();B=i.pageX-t.left;w=i.pageY-t.top;
if(h.data("horizontalScroll")){h.mCustomScrollbar("scrollTo",E-B,{trigger:"internal"})}else{h.mCustomScrollbar("scrollTo",z-w,{trigger:"internal"})}})}}if(!h.data("bindEvent_scrollbar_click")){j.bind("click",function(y){var I=(y.pageY-j.offset().top)*h.data("scrollAmount"),x=a(y.target);if(h.data("horizontalScroll")){I=(y.pageX-j.offset().left)*h.data("scrollAmount")}if(x.hasClass("mCSB_draggerContainer")||x.hasClass("mCSB_draggerRail")){h.mCustomScrollbar("scrollTo",I,{trigger:"internal",scrollEasing:"draggerRailEase"})
}});h.data({bindEvent_scrollbar_click:true})}if(h.data("mouseWheel")){if(!h.data("bindEvent_mousewheel")){e.bind("mousewheel",function(I,L){var y,x=h.data("mouseWheelPixels"),J=Math.abs(n.position().top),K=g.position().top,M=j.height()-g.height();if(h.data("normalizeMouseWheelDelta")){if(L<0){L=-1}else{L=1}}if(x==="auto"){x=100+Math.round(h.data("scrollAmount")/2)}if(h.data("horizontalScroll")){K=g.position().left;M=j.width()-g.width();J=Math.abs(n.position().left)}if((L>0&&K!==0)||(L<0&&K!==M)){I.preventDefault();
I.stopImmediatePropagation()}y=J-(L*x);h.mCustomScrollbar("scrollTo",y,{trigger:"internal"})});h.data({bindEvent_mousewheel:true})}}if(h.data("scrollButtons_enable")){if(h.data("scrollButtons_scrollType")==="pixels"){if(h.data("horizontalScroll")){D.add(r).unbind("mousedown touchstart MSPointerDown pointerdown mouseup MSPointerUp pointerup mouseout MSPointerOut pointerout touchend",f,ab);h.data({bindEvent_buttonsContinuous_x:false});if(!h.data("bindEvent_buttonsPixels_x")){D.bind("click",function(x){x.preventDefault();
q(Math.abs(n.position().left)+h.data("scrollButtons_scrollAmount"))});r.bind("click",function(x){x.preventDefault();q(Math.abs(n.position().left)-h.data("scrollButtons_scrollAmount"))});h.data({bindEvent_buttonsPixels_x:true})}}else{F.add(m).unbind("mousedown touchstart MSPointerDown pointerdown mouseup MSPointerUp pointerup mouseout MSPointerOut pointerout touchend",f,ab);h.data({bindEvent_buttonsContinuous_y:false});if(!h.data("bindEvent_buttonsPixels_y")){F.bind("click",function(x){x.preventDefault();
q(Math.abs(n.position().top)+h.data("scrollButtons_scrollAmount"))});m.bind("click",function(x){x.preventDefault();q(Math.abs(n.position().top)-h.data("scrollButtons_scrollAmount"))});h.data({bindEvent_buttonsPixels_y:true})}}function q(x){if(!g.data("preventAction")){g.data("preventAction",true);h.mCustomScrollbar("scrollTo",x,{trigger:"internal"})}}}else{if(h.data("horizontalScroll")){D.add(r).unbind("click");h.data({bindEvent_buttonsPixels_x:false});if(!h.data("bindEvent_buttonsContinuous_x")){D.bind("mousedown touchstart MSPointerDown pointerdown",function(x){x.preventDefault();
var y=o();h.data({mCSB_buttonScrollRight:setInterval(function(){h.mCustomScrollbar("scrollTo",Math.abs(n.position().left)+y,{trigger:"internal",scrollEasing:"easeOutCirc"})},17)})});var f=function(x){x.preventDefault();clearInterval(h.data("mCSB_buttonScrollRight"))};D.bind("mouseup touchend MSPointerUp pointerup mouseout MSPointerOut pointerout",f);r.bind("mousedown touchstart MSPointerDown pointerdown",function(x){x.preventDefault();var y=o();h.data({mCSB_buttonScrollLeft:setInterval(function(){h.mCustomScrollbar("scrollTo",Math.abs(n.position().left)-y,{trigger:"internal",scrollEasing:"easeOutCirc"})
},17)})});var ab=function(x){x.preventDefault();clearInterval(h.data("mCSB_buttonScrollLeft"))};r.bind("mouseup touchend MSPointerUp pointerup mouseout MSPointerOut pointerout",ab);h.data({bindEvent_buttonsContinuous_x:true})}}else{F.add(m).unbind("click");h.data({bindEvent_buttonsPixels_y:false});if(!h.data("bindEvent_buttonsContinuous_y")){F.bind("mousedown touchstart MSPointerDown pointerdown",function(x){x.preventDefault();var y=o();h.data({mCSB_buttonScrollDown:setInterval(function(){h.mCustomScrollbar("scrollTo",Math.abs(n.position().top)+y,{trigger:"internal",scrollEasing:"easeOutCirc"})
},17)})});var v=function(x){x.preventDefault();clearInterval(h.data("mCSB_buttonScrollDown"))};F.bind("mouseup touchend MSPointerUp pointerup mouseout MSPointerOut pointerout",v);m.bind("mousedown touchstart MSPointerDown pointerdown",function(x){x.preventDefault();var y=o();h.data({mCSB_buttonScrollUp:setInterval(function(){h.mCustomScrollbar("scrollTo",Math.abs(n.position().top)-y,{trigger:"internal",scrollEasing:"easeOutCirc"})},17)})});var G=function(x){x.preventDefault();clearInterval(h.data("mCSB_buttonScrollUp"))
};m.bind("mouseup touchend MSPointerUp pointerup mouseout MSPointerOut pointerout",G);h.data({bindEvent_buttonsContinuous_y:true})}}function o(){var x=h.data("scrollButtons_scrollSpeed");if(h.data("scrollButtons_scrollSpeed")==="auto"){x=Math.round((h.data("scrollInertia")+100)/40)}return x}}}if(h.data("autoScrollOnFocus")){if(!h.data("bindEvent_focusin")){e.bind("focusin",function(){e.scrollTop(0).scrollLeft(0);var J=a(document.activeElement);if(J.is("input,textarea,select,button,a[tabindex],area,object")){var I=n.position().top,x=J.position().top,y=e.height()-J.outerHeight();
if(h.data("horizontalScroll")){I=n.position().left;x=J.position().left;y=e.width()-J.outerWidth()}if(I+x<0||I+x>y){h.mCustomScrollbar("scrollTo",x,{trigger:"internal"})}}});h.data({bindEvent_focusin:true})}}if(h.data("autoHideScrollbar")&&!h.data("alwaysShowScrollbar")){if(!h.data("bindEvent_autoHideScrollbar")){e.bind("mouseenter",function(x){e.addClass("mCS-mouse-over");b.showScrollbar.call(e.children(".mCSB_scrollTools"))}).bind("mouseleave touchend",function(x){e.removeClass("mCS-mouse-over");
if(x.type==="mouseleave"){b.hideScrollbar.call(e.children(".mCSB_scrollTools"))}});h.data({bindEvent_autoHideScrollbar:true})}}},scrollTo:function(f,h){var m=a(this),e={moveDragger:false,trigger:"external",callbacks:true,scrollInertia:m.data("scrollInertia"),scrollEasing:m.data("scrollEasing")},h=a.extend(e,h),g,j=m.children(".mCustomScrollBox"),o=j.children(".mCSB_container"),k=j.children(".mCSB_scrollTools"),n=k.children(".mCSB_draggerContainer"),l=n.children(".mCSB_dragger"),u=draggerSpeed=h.scrollInertia,i,t,q,p;
if(!o.hasClass("mCS_no_scrollbar")){m.data({mCS_trigger:h.trigger});if(m.data("mCS_Init")){h.callbacks=false}if(f||f===0){if(typeof(f)==="number"){if(h.moveDragger){g=f;if(m.data("horizontalScroll")){f=l.position().left*m.data("scrollAmount")}else{f=l.position().top*m.data("scrollAmount")}draggerSpeed=0}else{g=f/m.data("scrollAmount")}}else{if(typeof(f)==="string"){var K;if(f==="top"){K=0}else{if(f==="bottom"&&!m.data("horizontalScroll")){K=o.outerHeight()-j.height()}else{if(f==="left"){K=0}else{if(f==="right"&&m.data("horizontalScroll")){K=o.outerWidth()-j.width()
}else{if(f==="first"){K=m.find(".mCSB_container").find(":first")}else{if(f==="last"){K=m.find(".mCSB_container").find(":last")}else{K=m.find(f)}}}}}}if(K.length===1){if(m.data("horizontalScroll")){f=K.position().left}else{f=K.position().top}g=f/m.data("scrollAmount")}else{g=f=K}}}if(m.data("horizontalScroll")){if(m.data("onTotalScrollBack_Offset")){t=-m.data("onTotalScrollBack_Offset")}if(m.data("onTotalScroll_Offset")){p=j.width()-o.outerWidth()+m.data("onTotalScroll_Offset")}if(g<0){g=f=0;clearInterval(m.data("mCSB_buttonScrollLeft"));
if(!t){i=true}}else{if(g>=n.width()-l.width()){g=n.width()-l.width();f=j.width()-o.outerWidth();clearInterval(m.data("mCSB_buttonScrollRight"));if(!p){q=true}}else{f=-f}}var r=m.data("snapAmount");if(r){f=Math.round(f/r)*r-m.data("snapOffset")}b.mTweenAxis.call(this,l[0],"left",Math.round(g),draggerSpeed,h.scrollEasing);b.mTweenAxis.call(this,o[0],"left",Math.round(f),u,h.scrollEasing,{onStart:function(){if(h.callbacks&&!m.data("mCS_tweenRunning")){v("onScrollStart")}if(m.data("autoHideScrollbar")&&!m.data("alwaysShowScrollbar")){b.showScrollbar.call(k)
}},onUpdate:function(){if(h.callbacks){v("whileScrolling")}},onComplete:function(){if(h.callbacks){v("onScroll");if(i||(t&&o.position().left>=t)){v("onTotalScrollBack")}if(q||(p&&o.position().left<=p)){v("onTotalScroll")}}l.data("preventAction",false);m.data("mCS_tweenRunning",false);if(m.data("autoHideScrollbar")&&!m.data("alwaysShowScrollbar")){if(!j.hasClass("mCS-mouse-over")){b.hideScrollbar.call(k)}}}})}else{if(m.data("onTotalScrollBack_Offset")){t=-m.data("onTotalScrollBack_Offset")}if(m.data("onTotalScroll_Offset")){p=j.height()-o.outerHeight()+m.data("onTotalScroll_Offset")
}if(g<0){g=f=0;clearInterval(m.data("mCSB_buttonScrollUp"));if(!t){i=true}}else{if(g>=n.height()-l.height()){g=n.height()-l.height();f=j.height()-o.outerHeight();clearInterval(m.data("mCSB_buttonScrollDown"));if(!p){q=true}}else{f=-f}}var r=m.data("snapAmount");if(r){f=Math.round(f/r)*r-m.data("snapOffset")}b.mTweenAxis.call(this,l[0],"top",Math.round(g),draggerSpeed,h.scrollEasing);b.mTweenAxis.call(this,o[0],"top",Math.round(f),u,h.scrollEasing,{onStart:function(){if(h.callbacks&&!m.data("mCS_tweenRunning")){v("onScrollStart")
}if(m.data("autoHideScrollbar")&&!m.data("alwaysShowScrollbar")){b.showScrollbar.call(k)}},onUpdate:function(){if(h.callbacks){v("whileScrolling")}},onComplete:function(){if(h.callbacks){v("onScroll");if(i||(t&&o.position().top>=t)){v("onTotalScrollBack")}if(q||(p&&o.position().top<=p)){v("onTotalScroll")}}l.data("preventAction",false);m.data("mCS_tweenRunning",false);if(m.data("autoHideScrollbar")&&!m.data("alwaysShowScrollbar")){if(!j.hasClass("mCS-mouse-over")){b.hideScrollbar.call(k)}}}})}if(m.data("mCS_Init")){m.data({mCS_Init:false})
}}}function v(w){if(m.data("mCustomScrollbarIndex")){this.mcs={top:o.position().top,left:o.position().left,draggerTop:l.position().top,draggerLeft:l.position().left,topPct:Math.round((100*Math.abs(o.position().top))/Math.abs(o.outerHeight()-j.height())),leftPct:Math.round((100*Math.abs(o.position().left))/Math.abs(o.outerWidth()-j.width()))};switch(w){case"onScrollStart":m.data("mCS_tweenRunning",true).data("onScrollStart_Callback").call(m,this.mcs);break;case"whileScrolling":m.data("whileScrolling_Callback").call(m,this.mcs);
break;case"onScroll":m.data("onScroll_Callback").call(m,this.mcs);break;case"onTotalScrollBack":m.data("onTotalScrollBack_Callback").call(m,this.mcs);break;case"onTotalScroll":m.data("onTotalScroll_Callback").call(m,this.mcs);break}}}},stop:function(){var f=a(this),g=f.children().children(".mCSB_container"),e=f.children().children().children().children(".mCSB_dragger");b.mTweenAxisStop.call(this,g[0]);b.mTweenAxisStop.call(this,e[0])},disable:function(g){var f=a(this),h=f.children(".mCustomScrollBox"),j=h.children(".mCSB_container"),i=h.children(".mCSB_scrollTools"),e=i.children().children(".mCSB_dragger");
h.unbind("mousewheel focusin mouseenter mouseleave touchend");j.unbind("touchstart touchmove");if(g){if(f.data("horizontalScroll")){e.add(j).css("left",0)}else{e.add(j).css("top",0)}}i.css("display","none");j.addClass("mCS_no_scrollbar");f.data({bindEvent_mousewheel:false,bindEvent_focusin:false,bindEvent_content_touch:false,bindEvent_autoHideScrollbar:false}).addClass("mCS_disabled")},destroy:function(){var e=a(this);e.removeClass("mCustomScrollbar _mCS_"+e.data("mCustomScrollbarIndex")).addClass("mCS_destroyed").children().children(".mCSB_container").unwrap().children().unwrap().siblings(".mCSB_scrollTools").remove();
a(document).unbind("mousemove."+e.data("mCustomScrollbarIndex")+" mouseup."+e.data("mCustomScrollbarIndex")+" MSPointerMove."+e.data("mCustomScrollbarIndex")+" MSPointerUp."+e.data("mCustomScrollbarIndex"));a(window).unbind("resize."+e.data("mCustomScrollbarIndex"))}},b={showScrollbar:function(){this.stop().animate({opacity:1},"fast")},hideScrollbar:function(){this.stop().animate({opacity:0},"fast")},mTweenAxis:function(g,i,h,f,p,Q){var Q=Q||{},w=Q.onStart||function(){},q=Q.onUpdate||function(){},x=Q.onComplete||function(){};
var o=v(),m,k=0,t=g.offsetTop,u=g.style;if(i==="left"){t=g.offsetLeft}var n=h-t;r();e();function v(){if(window.performance&&window.performance.now){return window.performance.now()}else{if(window.performance&&window.performance.webkitNow){return window.performance.webkitNow()}else{if(Date.now){return Date.now()}else{return new Date().getTime()}}}}function y(){if(!k){w.call()}k=v()-o;j();if(k>=g._time){g._time=(k>g._time)?k+m-(k-g._time):k+m-1;if(g._time<k+1){g._time=k+1}}if(g._time<f){g._id=_request(y)
}else{x.call()}}function j(){if(f>0){g.currVal=l(g._time,t,n,f,p);u[i]=Math.round(g.currVal)+"px"}else{u[i]=h+"px"}q.call()}function e(){m=1000/60;g._time=k+m;_request=(!window.requestAnimationFrame)?function(z){j();return setTimeout(z,0.01)}:window.requestAnimationFrame;g._id=_request(y)}function r(){if(g._id==null){return}if(!window.requestAnimationFrame){clearTimeout(g._id)}else{window.cancelAnimationFrame(g._id)}g._id=null}function l(E,D,C,B,F){switch(F){case"linear":return C*E/B+D;break;case"easeOutQuad":E/=B;
return -C*E*(E-2)+D;break;case"easeInOutQuad":E/=B/2;if(E<1){return C/2*E*E+D}E--;return -C/2*(E*(E-2)-1)+D;break;case"easeOutCubic":E/=B;E--;return C*(E*E*E+1)+D;break;case"easeOutQuart":E/=B;E--;return -C*(E*E*E*E-1)+D;break;case"easeOutQuint":E/=B;E--;return C*(E*E*E*E*E+1)+D;break;case"easeOutCirc":E/=B;E--;return C*Math.sqrt(1-E*E)+D;break;case"easeOutSine":return C*Math.sin(E/B*(Math.PI/2))+D;break;case"easeOutExpo":return C*(-Math.pow(2,-10*E/B)+1)+D;break;case"mcsEaseOut":var A=(E/=B)*E,z=A*E;
return D+C*(0.499999999999997*z*A+-2.5*A*A+5.5*z+-6.5*A+4*E);break;case"draggerRailEase":E/=B/2;if(E<1){return C/2*E*E*E+D}E-=2;return C/2*(E*E*E+2)+D;break}}},mTweenAxisStop:function(e){if(e._id==null){return}if(!window.requestAnimationFrame){clearTimeout(e._id)}else{window.cancelAnimationFrame(e._id)}e._id=null},rafPolyfill:function(){var f=["ms","moz","webkit","o"],e=f.length;while(--e>-1&&!window.requestAnimationFrame){window.requestAnimationFrame=window[f[e]+"RequestAnimationFrame"];window.cancelAnimationFrame=window[f[e]+"CancelAnimationFrame"]||window[f[e]+"CancelRequestAnimationFrame"]
}}};b.rafPolyfill.call();a.support.touch=!!("ontouchstart" in window);a.support.pointer=window.navigator.pointerEnabled;a.support.msPointer=window.navigator.msPointerEnabled;var c=("https:"==document.location.protocol)?"https:":"http:";a.event.special.mousewheel||document.write('<script src="'+c+'//cdnjs.cloudflare.com/ajax/libs/jquery-mousewheel/3.0.6/jquery.mousewheel.min.js"><\/script>');a.fn.mCustomScrollbar=function(e){if(d[e]){return d[e].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof e==="object"||!e){return d.init.apply(this,arguments)
}else{a.error("Method "+e+" does not exist")}}}})(jQuery);var videos_section_slider=(function(){var h='[data-plugin="videos_section_slider"]';function j(b,c,a){if((Math.abs(parseFloat(b.css("margin-left")))+c.outerWidth())<a){return false}return true}function i(a){if(Math.abs(parseInt(a.css("margin-left")))===0){return true}return false}function g(b,c,a,d){var e=a-(Math.abs(parseFloat(b.css("margin-left")))+c.outerWidth());return e<d?e:0}function f(a,c,b,d){$.ajax({url:c,success:function(e){var l=$("<div>");
l.html(e);a.append(l.find("li"));if(typeof b=="function"){b()}},error:function(){if(typeof d=="function"){d()}}})}return{init:function(c,I,a){var D=0,B=false,H=a?a:$('<span class="btn prev disabled"><i></i></span>'),M=I?I:$('<span class="btn next disabled"><i></i></span>'),z=c.find("ul"),A=c.find("li"),F=z.closest(".slideshowbox"),C=A.length,K=A.eq(0).outerWidth(true)*Math.floor((c.outerWidth()/A.eq(0).outerWidth(true))),G=0,e=0,J=0,L=false,E=false,d=false;function b(k,l){if(l==="charts"){return}if(B){return
}if(L){B=true;H.addClass("disabled");z.animate({"margin-left":"0px"},500,function(){B=false;D=0;J=0;if(z.outerWidth(true)>=G){M.addClass("disabled");L=false}else{L=true;M.removeClass("disabled")}})}else{if(z.outerWidth(true)>=G){M.addClass("disabled");L=false}else{L=true;M.removeClass("disabled")}}if(c.outerWidth()>0&&A.eq(0).outerWidth(true)>0){K=A.eq(0).outerWidth(true)*Math.floor((c.outerWidth()/A.eq(0).outerWidth(true)))}}if(c.find(".npbtn.next").length){e=0;A.each(function(){e+=$(this).outerWidth(true)
});e=Math.round(e*10)/10;if(e===G){return}else{b();return}}A.each(function(){G+=$(this).outerWidth(true);G=Math.round(G*10)/10});if(G>z.outerWidth(true)){if(!a){c.append(H)}if(!I){c.append(M)}L=true;M.removeClass("disabled")}require(["tiljs/event"],function(k){k.subscribe("window.resize",b)});M.on("click",function(){var l=g(z,F,G,K),k=K;if(d||B||j(z,F,G)){return}if(H.hasClass("disabled")){H.removeClass("disabled")}if(l>0){k=l;J=l}if(!E&&c.data("next-url")){d=true;M.addClass("loader");f(z,c.data("next-url"),function(){G=0;
A=z.find("li");A.each(function(){G+=$(this).outerWidth(true)});G=Math.round(G*10)/10;E=true;d=false;M.removeClass("loader disabled");require(["tiljs/plugin/lazy","toicommonjs/rodate"],function(n,m){n.load();m.uptime();if(TimesApps.WatchLaterManager.getInitStatus()){TimesApps.WatchLaterManager.updateStatus(c)}else{$(window).load(function(){TimesApps.WatchLaterManager.updateStatus(c)})}})},function(){d=false})}B=true;z.animate({"margin-left":parseFloat(z.css("margin-left"))-(k)+"px"},500,function(){B=false;
D+=1;if(j(z,F,G)){M.addClass("disabled")}})});H.on("click",function(){var k=K,l;if(d||B||i(z)){return}if(M.hasClass("disabled")){M.removeClass("disabled")}B=true;if(J>0){k=J}l=parseFloat(z.css("margin-left"))+(k);if(l>0||Math.abs(l)<1){l=0}z.animate({"margin-left":l+"px"},500,function(){B=false;D-=1;if(J>0){J=0}if(i(z)){H.addClass("disabled")}})})}}})();$(function(){$('[data-plugin="videos_section_slider"]').each(function(){videos_section_slider.init($(this))})});var requirejs,require,define;(function(M){var J,Q,E,D,N={},O={},x={},A={},F=Object.prototype.hasOwnProperty,I=[].slice,G=/\.js$/;
function w(b,a){return F.call(b,a)}function C(g,k){var n,a,c,q,m,d,i,e,o,p,b,f,j=k&&k.split("/"),h=x.map,l=(h&&h["*"])||{};if(g){g=g.split("/");m=g.length-1;if(x.nodeIdCompat&&G.test(g[m])){g[m]=g[m].replace(G,"")}if(g[0].charAt(0)==="."&&j){f=j.slice(0,j.length-1);g=f.concat(g)}for(o=0;o<g.length;o++){b=g[o];if(b==="."){g.splice(o,1);o-=1}else{if(b===".."){if(o===0||(o===1&&g[2]==="..")||g[o-1]===".."){continue}else{if(o>0){g.splice(o-1,2);o-=2}}}}}g=g.join("/")}if((j||l)&&h){n=g.split("/");for(o=n.length;
o>0;o-=1){a=n.slice(0,o).join("/");if(j){for(p=j.length;p>0;p-=1){c=h[j.slice(0,p).join("/")];if(c){c=c[a];if(c){q=c;d=o;break}}}}if(q){break}if(!i&&l&&l[a]){i=l[a];e=o}}if(!q&&i){q=i;d=e}if(q){n.splice(0,d,q);g=n.join("/")}}return g}function y(b,a){return function(){var c=I.call(arguments,0);if(typeof c[0]!=="string"&&c.length===1){c.push(null)}return Q.apply(M,c.concat([b,a]))}}function B(a){return function(b){return C(b,a)}}function L(a){return function(b){N[a]=b}}function K(a){if(w(O,a)){var b=O[a];
delete O[a];A[a]=true;J.apply(M,b)}if(!w(N,a)&&!w(A,a)){throw new Error("No "+a)}return N[a]}function z(a){var c,b=a?a.indexOf("!"):-1;if(b>-1){c=a.substring(0,b);a=a.substring(b+1,a.length)}return[c,a]}function H(a){return a?z(a):[]}E=function(c,d){var b,a=z(c),f=a[0],e=d[1];c=a[1];if(f){f=C(f,e);b=K(f)}if(f){if(b&&b.normalize){c=b.normalize(c,B(e))}else{c=C(c,e)}}else{c=C(c,e);a=z(c);f=a[0];c=a[1];if(f){b=K(f)}}return{f:f?f+"!"+c:c,n:c,pr:f,p:b}};function P(a){return function(){return(x&&x.config&&x.config[a])||{}
}}D={require:function(a){return y(a)},exports:function(b){var a=N[b];if(typeof a!=="undefined"){return a}else{return(N[b]={})}},module:function(a){return{id:a,uri:"",exports:N[a],config:P(a)}}};J=function(g,h,j,k){var c,l,b,i,e,d,a=[],f=typeof j,m;k=k||g;d=H(k);if(f==="undefined"||f==="function"){h=!h.length&&j.length?["require","exports","module"]:h;for(e=0;e<h.length;e+=1){i=E(h[e],d);l=i.f;if(l==="require"){a[e]=D.require(g)}else{if(l==="exports"){a[e]=D.exports(g);m=true}else{if(l==="module"){c=a[e]=D.module(g)
}else{if(w(N,l)||w(O,l)||w(A,l)){a[e]=K(l)}else{if(i.p){i.p.load(i.n,y(k,true),L(l),{});a[e]=N[l]}else{throw new Error(g+" missing "+l)}}}}}}b=j?j.apply(N[g],a):undefined;if(g){if(c&&c.exports!==M&&c.exports!==N[g]){N[g]=c.exports}else{if(b!==M||!m){N[g]=b}}}}else{if(g){N[g]=j}}};requirejs=require=Q=function(d,b,c,a,e){if(typeof d==="string"){if(D[d]){return D[d](b)}return K(E(d,H(b)).f)}else{if(!d.splice){x=d;if(x.deps){Q(x.deps,x.callback)}if(!b){return}if(b.splice){d=b;b=c;c=null}else{d=M}}}b=b||function(){};
if(typeof c==="function"){c=a;a=e}if(a){J(M,d,b,c)}else{setTimeout(function(){J(M,d,b,c)},4)}return Q};Q.config=function(a){return Q(a)};requirejs._defined=N;define=function(b,a,c){if(typeof b!=="string"){throw new Error("See almond README: incorrect module build, no module name")}if(!a.splice){c=a;a=[]}if(!w(N,b)&&!w(O,b)){O[b]=[b,a,c]}};define.amd={jQuery:true}}());(function(){var j={};var k={};var l=[];var n=".min";var i=[{module:"json",variable:"JSON",js:"//cdnjs.cloudflare.com/ajax/libs/json2/20121008/json2"+n},{module:"jquery",variable:"jQuery",js:["//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery"+n,"//cdnjs.cloudflare.com/ajax/libs/jquery/1.8.2/jquery"+n]}];
for(var h=0;h<i.length;h++){var m=i[h];if(!window[m.variable]){k[m.module]=m.js;j[m.module]={exports:m.variable};l.push(m.module)}else{define(m.module,(function(a,b){return function(){return window[a.variable]}}(m,n)))}}require({deps:l,shim:j,paths:k})}());define("config",[],function(){return{}});require.config({shim:{},paths:{},config:{"tiljs/page":{channel:"TOI",siteId:"541cc79a8638cfd34bdc56d1a27c8cd7",domain:"indiatimes.com"},"tiljs/plugin/lazy":{skew:0,error_image:$("[data-default-image-msid]").length?("/photo/"+$("[data-default-image-msid]").attr("data-default-image-msid")+".cms"):"/photo/34824568.cms"},"tiljs/social/facebook":{xfbml:true,parse:false,appid:117787264903013,load_js:false,init:false},"tiljs/social/twitter":{parse:false,load_js:false,init:false},"tiljs/analytics/mytimes":{appKey:"TOI"},"tiljs/apps/times/comments":{loadCommentFromMytimes:true,commentType:"comments_agree"},"tiljs/apps/times/api":{post_comment:{url:"/postro2.cms",params:{medium:"WEB"}},comments:{url:"/commentsdata.cms",type:"json",params:{appkey:"TOI",msid:window.msid,sortcriteria:"CreationDate",order:"asc",size:25,lastdeenid:123,after:true,withReward:true}},comments_oldest:{url:"/commentsdata.cms",type:"json",params:{appkey:"TOI",msid:window.msid,sortcriteria:"CreationDate",order:"desc",size:25,lastdeenid:123,after:true,withReward:true}},comments_agree:{url:"/commentsdata.cms",type:"json",params:{appkey:"TOI",msid:window.msid,sortcriteria:"AgreeCount",order:"desc",size:25,lastdeenid:123,after:true,withReward:true,medium:"WEB"}},comments_disagree:{url:"/commentsdata.cms",type:"json",params:{appkey:"TOI",msid:window.msid,sortcriteria:"DisagreeCount",order:"desc",size:25,lastdeenid:123,after:true,withReward:true}},comments_discussed:{url:"/commentsdata.cms",type:"json",params:{appkey:"TOI",msid:window.msid,sortcriteria:"discussed",order:"desc",size:25,lastdeenid:123,after:true,withReward:true}}}}});
define("jquery",[],function(){return jQuery});define("tiljs/compatibility",["jquery"],function(c){var d={};if(!Array.prototype.indexOf){Array.prototype.indexOf=d.Array_indexOf=function(f,b){if(this===undefined||this===null){throw new TypeError('"this" is null or not defined')}var a=this.length>>>0;b=+b||0;if(Math.abs(b)===Infinity){b=0}if(b<0){b+=a;if(b<0){b=0}}for(;b<a;b++){if(this[b]===f){return b}}return -1}}if(!String.prototype.trim){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/gm,"")
}}if(!String.prototype.splice){String.prototype.splice=function(f,a,b){return(this.slice(0,f)+b+this.slice(f+Math.abs(a)))}}c(function(){c("body").on("focus","[placeholder]",function(){var a=c(this);if(a.val()===a.attr("placeholder")){a.val("");a.removeClass("placeholder")}});c("body").on("blur","[placeholder]",function(){var a=c(this);if(a.val()===""||a.val()===a.attr("placeholder")){a.addClass("placeholder");a.val(a.attr("placeholder"))}});c("[placeholder]").blur()});return d});define("tiljs/cookie",[],function(){var b={};
b.get=function(o){var a=o?undefined:{};var k=document.cookie?document.cookie.split("; "):[];for(var l=0,p=k.length;l<p;l++){var i=k[l].split("=");var m=decodeURIComponent(i.shift());var n=i.join("=");n=b._parseCookieValue(n);if(o&&o===m){a=n;break}if(!o&&n!==undefined){a[m]=n}}return a};b.getAll=function(){return b.get()};b.remove=function(a,e,f){if(a){f=(f||document.location.host).split(":")[0];e=e||document.location.pathname;b.set(a,null,-1,e,f)}};b.set=function(o,m,j,k,n,l){var a="";j=(j!==undefined)?j:30;
var p=new Date();p.setTime(p.getTime()+(j*24*60*60*1000));a="; expires="+p.toGMTString();n=(n||document.location.host).split(":")[0];k=k||document.location.pathname;if(/\/.*\..*/.test(k)){k=k.split("/");k.pop();k=k.join("/")}document.cookie=o+"="+m+a+((k)?";path="+k:"")+((n&&n!="localhost")?";domain="+n:"")+((l)?";secure":"")};b._parseCookieValue=function(a){if(a.indexOf('"')===0){a=a.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\")}try{return decodeURIComponent(a.replace(/\+/g," "))}catch(d){}};
return b});define("tiljs/event",[],function(){var f={},e={},g="__on_",h=(function(){var a=0;return function(){return a++}})();f.publish=function(k,b){if(!k){return null}if(e[k]){for(var a in e[k]){if(e[k].hasOwnProperty(a)){var c=e[k][a];try{c(b)}catch(d){f.publish("logger.error",d.stack)}}}}};f.subscribeAll=function(i,a,l){if(i instanceof Array){var c=[];var b=[];for(var d=0;d<i.length;d++){c.push(f.subscribe(i[d],function(j){b.push(j);if(c.length===b.length){if(a){a(b)}b=[]}},l))}return c}return f.subscribe(i,a,l)
};f.subscribe=function(i,a,l){if(i instanceof Array){var c=[];for(var d=0;d<i.length;d++){c.push(f.subscribe(i[d],a,l))}return c}if(!i||!a){return null}if(!e[i]){e[i]={}}var b=i+":"+h();e[i][b]=a;if(l){l.__callback=a}f.publish(g+i,l);return b};f.unsubscribe=function(b){if(!b){return null}var a=b.split(":");if(a.length===2){var c=a[0];if(e[c][b]){delete e[c][b];return true}}return false};f.getSubscriptions=function(a){if(!a){return e}return e[a]};f.onsubscribe=function(c,a){if(!c||!a){return null}c=g+c;
if(!e[c]){e[c]={}}var b=c+":"+h();e[c][b]=a;return b};return f});define("tiljs/logger",["./cookie","module","./event","jquery"],function(v,t,w,n){var p={},u=[];var m=["log","debug","info","warn","error"];var o={cookieName:"d",hashString:"#debugdsfgw456g",prefix:"[times_log] ",time:false,handleWindowError:true,handleJqueryError:true,logModuleLoad:true,log:false};var q=n.extend({},o,t.config());function r(b){var c=new RegExp("/(.*):([0-9]*):([0-9]*)","g");var a=c.exec(b);a=c.exec(b);a=c.exec(b);if(a){a.shift()
}return a?a.join(":").replace(q.hashString,""):null}p={};p.disable=function(){q.log=false;v.remove(q.cookieName,"/");var b,a;for(b in m){if(m.hasOwnProperty(b)){a=m[b];p[a]=(function(c){return function(){u.push.apply(u,arguments)}})(a)}}return"Logging Disabled"};p.enable=function(){q.log=true;v.set(q.cookieName,q.hashString,30,"/");var a,c;for(a in m){if(m.hasOwnProperty(a)){c=m[a];function b(){console.log.apply(this,arguments)}p[c]=(function(e){var d=function(){};var f;var g=q.prefix;if(console.log.bind==="undefined"){f=Function.prototype.bind.call(console[e],console,g)
}else{f=console[e].bind(console,g)}return f})(c);(function(d){w.subscribe("logger."+d,function(e){Function.prototype.apply.call(p[d],console,arguments)})}(c))}}return"Logging Enabled"};p.isEnabled=function(){return q.log||(window.location.hash.length>0&&window.location.hash===(q.hashString))||(v.get(q.cookieName)===q.hashString)};p.handleWindowError=function(){window.onerror=function(c,d,e,a,b){p.error.apply(this,["Error message: "+c+"\n\tURL: "+d+(e?":"+e+":"+a:"")+"\n\tLine Number: "+e+":"+a+"\n\tError: "+b]);
return true}};p.handleJqueryError=function(){n(document).ajaxError(function(d,c,a,b){if(b==="timeout"){p.error.apply(this,[b+": "+a.url])}else{p.error.apply(this,[b])}});n(document).error(function(a){p.error.apply(this,a)})};function l(){q.log=p.isEnabled();if(q.log){p.enable()}else{p.disable()}if(q.handleWindowError===true){p.handleWindowError();w.subscribe("window.load",function(){p.handleWindowError()})}if(q.handleJqueryError===true){p.handleJqueryError()}}p.getLogs=function(){return u.slice(0)
};p.getLogsStr=function(){return p.getLogs().join("\n")};l();return p});define("tiljs/is",[],function(){var b={};b.number=function(a){return typeof a==="number"};b.string=function(a){return typeof a==="string"};b.funct=b.method=function(a){return typeof a==="function"};b.object=function(a){return a!==null&&typeof a==="object"};b.array=Array&&Array.isArray?Array.isArray:function(a){return a instanceof Array};b.undefined=function(a){return typeof a==="undefined"};b.defined=function(a){return typeof a!=="undefined"
};b.exists=function(a){return b.defined(a)||a===""};b.empty=function(f){if(!b.defined(f)){return true}else{if(b.string(f)||b.array(f)){return f.length===0}else{if(b.object(f)){var a=0,e;for(e in f){if(f.hasOwnProperty(e)){a++}}return a===0}else{if(b.number(f)){return false}else{return true}}}}};b.alphaOnly=function(a){return/^[A-z\s]+$/.test(a)};b.numberOnly=function(a){return/^[0-9]+$/.test(a)};b.mobile=function(){return(function(a){return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4))
})(navigator.userAgent||navigator.vendor||window.opera)};b.tablet=function(){return(function(a){return/(?:ipad|tab)/i.test(a)})(navigator.userAgent||navigator.vendor||window.opera)};b.desktop=function(){return !b.mobile()&&!b.tablet()};b.touch=function(){return(("ontouchstart" in window)||("DocumentTouch" in window))};b.IE=function(){var d=window.navigator.userAgent;var a=d.indexOf("MSIE ");if(a>0||!!navigator.userAgent.match(/Trident.*rv\:11\./)){return true}else{return false}};b.IE11=function(){return(!!navigator.userAgent.match(/Trident\/7\./))
};b.visible=function(a){return a&&a.is(":visible")};b.iframe=function(a){return a.tagName==="IFRAME"};b.dateStr=function(d){try{new Date(d);return true}catch(a){return false}};b.email=function(a){var d=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return d.test(a)};b.url=function(d){var a=/((([A-Za-z]{3,9}:(?:\/\/)?)(?:[\-;:&=\+\$,\w]+@)?[A-Za-z0-9\.\-]+|(?:www\.|[\-;:&=\+\$,\w]+@)[A-Za-z0-9\.\-]+)((?:\/[\+~%\/\.\w\-]*)?\??(?:[\-\+=&;%@\.\w]*)#?(?:[\.\!\/\\\w]*))?)/g;
return a.test(d)};return b});define("tiljs/string",[],function(){var b={};b.camelCase=function(a){return a.replace(/(?:^|\s)\w/g,function(d){return d.toUpperCase()}).replace(/(\s|-|_)/g,"")};b.splice=function(g,a,f,h){return(g.slice(0,a)+h+g.slice(a+Math.abs(f)))};b.startsWith=function(a,d){return a.indexOf(d)===0};return b});define("json",[],function(){return JSON});define("tiljs/util",["./logger","jquery","./is","./string","json"],function(i,l,n,j,p){i.log("util loaded");var k={};k.extend=l.extend;
k.deepextend=function(){return l.extend.apply(this,arguments)};k.xor=function(a,c){var d={},b;for(b in c){if(!a.hasOwnProperty(b)){d[b]=c[b]}}return d};k.convertObj=function(c,a){var b={};util.each(c,function(d,e){b[d]=a(d,e)});return b};k.each=function(c,a){var d,b;if(!a){return null}if(c instanceof Array){for(d=0;d<c.length;d++){if(a(d,c[d])===false){break}}}else{if(c instanceof Object){for(b in c){if(c.hasOwnProperty(b)){if(a(b,c[b])===false){break}}}}else{}}};k.wrapCallback=function(a,b){try{if(a){a.apply(this,args)
}}catch(c){i.error(c)}};k.formatNumber=function(a){if(a>=1000000000){return(a/1000000000).toFixed(1)+"G"}if(a>=1000000){return(a/1000000).toFixed(1)+"M"}if(a>=1000){return(a/1000).toFixed(1)+"K"}return a};k.getJsonFromString=function(a,d,c){d=d||"&";c=c||"=";var e={};var b=a.split(d);k.each(b,function(g,h){var f=h.split(c);e[f[0]]=f[1]});return e};k.val=function(a,b){if(n.funct(a)){return a(b)}return a};k.throttle=function(d,a){var c;var b=0;return function e(){var r=+new Date()-b;var g=this;var h=arguments;
function f(){b=+new Date();a.apply(g,h)}c&&clearTimeout(c);if(r>d){f()}else{c=setTimeout(f,d-r)}}};k.getDate=function(a){try{if(n.number(a)){return new Date(a)}else{a=a.replace(/(\d)(A|P)M/,"$1 $2M")}return new Date(a)}catch(b){i.error(b);return null}};var o=0;k.uuid=function(){var a=new Date().getTime();var b="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var d=(a+Math.random()*16)%16|0;a=Math.floor(a/16);return(c=="x"?d:(d&7|8)).toString(16)});return b};k.mapObj=function(b,a){if(!n.object(b)&&!n.object(a)){throw new Error("Invalid Parameters")
}var c={};k.each(b,function(d,e){if(n.funct(e)){c[d]=e(a)}else{c[d]=a[e]}});return c};k.getDomainOnly=function(a){return"."+(a||document.location.host).split(":")[0].split(".").reverse().slice(0,2).reverse().join(".")};k.format=function(a,b){var c=a;k.each(b,function(d,e){c=c.replace("{{:"+d+"}}",b[d])});c=c.replace(/{{:[a-zA_Z0-9]+}}/,"");return c};k.stringify=JSON?JSON.stringify:null;k.checkNoScript=function(a){};k.getClick=function(){return n.touch()?"touchstart":"click"};k.getParam=function(a){var b=window.location.search.replace("?","");
if(n.defined(a)){return k.deparam(b)[a]}else{return k.deparam(b)}};k.deparam=function(a){var b={};k.each(a.replace(/\+/g," ").split("&"),function(e,c){var d=c.split("=");b[decodeURIComponent(d[0])]=decodeURIComponent(d[1]||"")});return b};k.data=function(b){var a={};var c=l(b)[0].attributes;l.each(c,function(e,f){var d=f.nodeName.substr(0,5);if(d==="data-"){a[f.nodeName.replace(d,"")]=f.nodeValue}});return a};var m=function(a){Error.prototype.constructor.apply(this,arguments);this.message=a};m.prototype=new Error();
k.wrapCallback=function(a){return function(){try{return a.apply(this,arguments)}catch(b){if(b instanceof m){throw b}i.error(b);throw b}}};k.md5=function(f){function K(F,x){return(F<<x)|(F>>>(32-x))}function E(ae,G){var F,I,Z,x,H;Z=(ae&2147483648);x=(G&2147483648);F=(ae&1073741824);I=(G&1073741824);H=(ae&1073741823)+(G&1073741823);if(F&I){return(H^2147483648^Z^x)}if(F|I){if(H&1073741824){return(H^3221225472^Z^x)}else{return(H^1073741824^Z^x)}}else{return(H^Z^x)}}function e(x,F,G){return(x&F)|((~x)&G)
}function d(x,F,G){return(x&G)|(F&(~G))}function c(x,F,G){return(x^F^G)}function ab(x,F,G){return(F^(x|(~G)))}function h(x,ae,I,Z,H,F,G){x=E(x,E(E(e(ae,I,Z),H),G));return E(K(x,F),ae)}function T(x,ae,I,Z,H,F,G){x=E(x,E(E(d(ae,I,Z),H),G));return E(K(x,F),ae)}function z(x,ae,I,Z,H,F,G){x=E(x,E(E(c(ae,I,Z),H),G));return E(K(x,F),ae)}function g(x,ae,I,Z,H,F,G){x=E(x,E(E(ab(ae,I,Z),H),G));return E(K(x,F),ae)}function S(F){var af;var x=F.length;var I=x+8;var ae=(I-(I%64))/64;var H=(ae+1)*16;var ag=Array(H-1);
var Z=0;var G=0;while(G<x){af=(G-(G%4))/4;Z=(G%4)*8;ag[af]=(ag[af]|(F.charCodeAt(G)<<Z));G++}af=(G-(G%4))/4;Z=(G%4)*8;ag[af]=ag[af]|(128<<Z);ag[H-2]=x<<3;ag[H-1]=x>>>29;return ag}function w(H){var G="",x="",F,I;for(I=0;I<=3;I++){F=(H>>>(I*8))&255;x="0"+F.toString(16);G=G+x.substr(x.length-2,2)}return G}function D(G){G=G.replace(/rn/g,"n");var x="";for(var F=0;F<G.length;F++){var H=G.charCodeAt(F);if(H<128){x+=String.fromCharCode(H)}else{if((H>127)&&(H<2048)){x+=String.fromCharCode((H>>6)|192);x+=String.fromCharCode((H&63)|128)
}else{x+=String.fromCharCode((H>>12)|224);x+=String.fromCharCode(((H>>6)&63)|128);x+=String.fromCharCode((H&63)|128)}}}return x}var y=Array();var P,V,B,q,U,ad,ac,L,J;var a=7,Q=12,N=17,M=22;var v=5,u=9,t=14,r=20;var b=4,aa=11,Y=16,X=23;var C=6,A=10,R=15,O=21;f=D(f);y=S(f);ad=1732584193;ac=4023233417;L=2562383102;J=271733878;for(P=0;P<y.length;P+=16){V=ad;B=ac;q=L;U=J;ad=h(ad,ac,L,J,y[P+0],a,3614090360);J=h(J,ad,ac,L,y[P+1],Q,3905402710);L=h(L,J,ad,ac,y[P+2],N,606105819);ac=h(ac,L,J,ad,y[P+3],M,3250441966);
ad=h(ad,ac,L,J,y[P+4],a,4118548399);J=h(J,ad,ac,L,y[P+5],Q,1200080426);L=h(L,J,ad,ac,y[P+6],N,2821735955);ac=h(ac,L,J,ad,y[P+7],M,4249261313);ad=h(ad,ac,L,J,y[P+8],a,1770035416);J=h(J,ad,ac,L,y[P+9],Q,2336552879);L=h(L,J,ad,ac,y[P+10],N,4294925233);ac=h(ac,L,J,ad,y[P+11],M,2304563134);ad=h(ad,ac,L,J,y[P+12],a,1804603682);J=h(J,ad,ac,L,y[P+13],Q,4254626195);L=h(L,J,ad,ac,y[P+14],N,2792965006);ac=h(ac,L,J,ad,y[P+15],M,1236535329);ad=T(ad,ac,L,J,y[P+1],v,4129170786);J=T(J,ad,ac,L,y[P+6],u,3225465664);
L=T(L,J,ad,ac,y[P+11],t,643717713);ac=T(ac,L,J,ad,y[P+0],r,3921069994);ad=T(ad,ac,L,J,y[P+5],v,3593408605);J=T(J,ad,ac,L,y[P+10],u,38016083);L=T(L,J,ad,ac,y[P+15],t,3634488961);ac=T(ac,L,J,ad,y[P+4],r,3889429448);ad=T(ad,ac,L,J,y[P+9],v,568446438);J=T(J,ad,ac,L,y[P+14],u,3275163606);L=T(L,J,ad,ac,y[P+3],t,4107603335);ac=T(ac,L,J,ad,y[P+8],r,1163531501);ad=T(ad,ac,L,J,y[P+13],v,2850285829);J=T(J,ad,ac,L,y[P+2],u,4243563512);L=T(L,J,ad,ac,y[P+7],t,1735328473);ac=T(ac,L,J,ad,y[P+12],r,2368359562);ad=z(ad,ac,L,J,y[P+5],b,4294588738);
J=z(J,ad,ac,L,y[P+8],aa,2272392833);L=z(L,J,ad,ac,y[P+11],Y,1839030562);ac=z(ac,L,J,ad,y[P+14],X,4259657740);ad=z(ad,ac,L,J,y[P+1],b,2763975236);J=z(J,ad,ac,L,y[P+4],aa,1272893353);L=z(L,J,ad,ac,y[P+7],Y,4139469664);ac=z(ac,L,J,ad,y[P+10],X,3200236656);ad=z(ad,ac,L,J,y[P+13],b,681279174);J=z(J,ad,ac,L,y[P+0],aa,3936430074);L=z(L,J,ad,ac,y[P+3],Y,3572445317);ac=z(ac,L,J,ad,y[P+6],X,76029189);ad=z(ad,ac,L,J,y[P+9],b,3654602809);J=z(J,ad,ac,L,y[P+12],aa,3873151461);L=z(L,J,ad,ac,y[P+15],Y,530742520);
ac=z(ac,L,J,ad,y[P+2],X,3299628645);ad=g(ad,ac,L,J,y[P+0],C,4096336452);J=g(J,ad,ac,L,y[P+7],A,1126891415);L=g(L,J,ad,ac,y[P+14],R,2878612391);ac=g(ac,L,J,ad,y[P+5],O,4237533241);ad=g(ad,ac,L,J,y[P+12],C,1700485571);J=g(J,ad,ac,L,y[P+3],A,2399980690);L=g(L,J,ad,ac,y[P+10],R,4293915773);ac=g(ac,L,J,ad,y[P+1],O,2240044497);ad=g(ad,ac,L,J,y[P+8],C,1873313359);J=g(J,ad,ac,L,y[P+15],A,4264355552);L=g(L,J,ad,ac,y[P+6],R,2734768916);ac=g(ac,L,J,ad,y[P+13],O,1309151649);ad=g(ad,ac,L,J,y[P+4],C,4149444226);
J=g(J,ad,ac,L,y[P+11],A,3174756917);L=g(L,J,ad,ac,y[P+2],R,718787259);ac=g(ac,L,J,ad,y[P+9],O,3951481745);ad=E(ad,V);ac=E(ac,B);L=E(L,q);J=E(J,U)}var W=w(ad)+w(ac)+w(L)+w(J);return W.toLowerCase()};k.encodeHTML=function(a){return l("<div/>").text(a).html()};k.decodeHTML=function(a){return l("<div/>").html(a).text()};k.reloadIframe=function(a){if(l(a).length>0){l(a).attr("src",l(a).attr("src"));return true}return false};k.trimText=function(a,b){var c=a.substr(0,b);if(a.length>b){c=a.replace(new RegExp("^(.{"+b+"}[^\\s]*).*"),"$1")
}return c};return k});define("tiljs/timer",["./util","./is"],function(e,f){var d={};d.every=function(b,a){return setInterval(a,b)};d.after=d.delay=function(b,a){return setTimeout(a,b)};d.available=function(h,a,b,c){if(c==0){a(null)}if(window[h]){if(a){a(window[h])}}else{b=b||2000;setTimeout(function(){d.available(h,a,b,--c)},b)}};d.cancel=function(a){try{clearTimeout(a)}catch(b){}try{clearInterval(a)}catch(b){}};d.elapsedTime=function(i,x,z){if(!f.number(i)){try{i=parseInt(i,10);return d.elapsedTime(i,x,z)
}catch(l){return""}}var a={year:"year",day:"day",hour:"hour",minute:"minute",second:"second",ago:"ago"};var t=e.extend(true,{},a,x);var b=[{name:t.year,div:31536000000,mod:10000},{name:t.day,div:86400000,mod:365},{name:t.hour,div:3600000,mod:24},{name:t.minute,div:60000,mod:60},{name:t.second,div:1000,mod:60}];var u=0,w=b.length,v,c=[],y=new Date().getTime()-i;while(u<w){v=Math.floor(y/b[u].div)%b[u].mod;if(v&&v>=0){c.push(v+" "+b[u].name+(v>1?"s":""))}u+=1}if(c.length===0){c.push("1 "+t.second)}if(z===true){return c[0]+" "+t.ago
}else{return c.join(", ")+" "+t.ago}};return d});define("tiljs/ajax",["./timer","./util","jquery","./is","module"],function(k,j,l,n,o){var m={timeout:60000},p=j.extend(true,{},m,o.config()),i={};l.ajaxSetup({timeout:p.timeout});i.getAll=function(g,u,a,d){var c=this,v=[],f=[],e,b;function h(q){f.push(q);if(f.length===g.length){a.apply(c,f)}}for(e=0;e<g.length;e++){b=u&&u.length>e?u[e]:{};v.push(l.get(g[e],b,h,d))}return v};i.param=l.param;i.ajax=l.ajax;i.get=function(d,b,a,c){if(n.funct(d)){return d(b,a)
}else{return l.get(d,b,a,c)}};i.post=function(d,b,a,c){return l.post(d,b,a,c)};i.postCrossDomain=function(d,a){var e="postFrame"+new Date().getTime()+Math.floor((Math.random()*1000)),c=l("<iframe></iframe>").attr("name",e),b=l("<form action='"+d+"' method='post' target='"+e+"'></form>");j.each(a,function(f,g){b.append(l("<input type='hidden' name='"+f+"' />").attr("value",g))});c.appendTo("body");b.appendTo("body").submit().remove();k.after(10000,function(){c.remove()})};i.getJSONP=function(c,b,a){return i.get(c,b,a,"jsonp")
};i.getJSON=function(c,b,a){return i.get(c,b,a,"json")};return i});var TimesApps=window.TimesApps||{};TimesApps.checkGdprAndCall=function(i,l,h){var k="geo_continent";if(window.TimesGDPR&&TimesGDPR.common.consentModule.gdprCallback){TimesGDPR.common.consentModule.gdprCallback(function(a){if(a&&a.isEUuser&&typeof l=="function"){l()}else{if(!a.isEUuser&&typeof i=="function"){i()}}})}else{if(window.self!=window.parent){var j=(toiprops&&toiprops.cookie&&toiprops.cookie.get(k))||"";var g=j.toUpperCase()==="EU";
if(g&&typeof l=="function"){l()}}else{if(typeof l=="function"){l()}}}};define("tiljs/user",["./util","./ajax","./cookie","./event","jquery","./is","./logger","./string"],function(o,l,t,u,q,p,k,n){var r={},m=function(c,b){var d={},a=this;if(b&&p.object(b)){c=o.mapObj(b,c)}o.each(c,function(f,g){d[f]=g;var e=n.camelCase(f);a["get"+e]=function(){return d[f]}});this.getMappedUser=function(){return d};this.getOriginalUser=function(){return c};this.toString=this.toJson=function(){return o.stringify(d,true,"\t")
}};r.getNewUser=function(a,b){if(a instanceof m){return a}else{if(p.object(a)){return new m(a,b)}else{return null}}};r.isUser=function(a){return a instanceof m};return r});define("tiljs/page",["module","./util","jquery"],function(k,h,i){var j={msid:window.msid,channel:"",siteId:"",domain:""};var l=h.extend(true,{},j,k.config());var g={};g.getMsid=function(b){try{if(!b||b.length===0||b==="#"){b=location.href;return/(\d*)\.cms/.exec(b)[1]}else{return l.msid}}catch(a){return l.msid}};g.getSiteId=function(){return l.siteId
};g.getDomain=function(){return l.domain};g.getChannel=function(){return l.channel};g.getMeta=function(b){if(b){return i("meta[property='"+b+"']").attr("content")}else{var a={};i("meta[property]").each(function(c,d){var e=i(d);a[e.attr("property")]=e.attr("content")});return a}};return g});define("tiljs/analytics/mytimes",["module","../ajax","../util"],function(l,j,h){var i={};var k={url:"https://myt.indiatimes.com/mytimes/",appKey:""};var g=h.extend(true,{},k,l.config());i.log=function(c,a){var b=new Image();
b.src=c+"?"+j.param(a)};i.logActivity=function(c){var b=g.url+"addActivity";var a=h.extend(true,{},c);i.log(b,a)};i.logCommentActivity=function(b){var a=h.extend(true,{appKey:g.appKey,parentCommentId:0,activityType:"",baseEntityType:"ARTICLE",objectType:"A",url:document.location.href},b);i.logActivity(a)};i.agreeComment=function(b){var a={parentCommentId:b,activityType:"Agreed"};i.logCommentActivity(a)};i.disagreeComment=function(b){var a={parentCommentId:b,activityType:"Disagreed"};i.logCommentActivity(a)
};i.recommendComment=function(b){var a={parentCommentId:b,activityType:"Reccomended"};i.logCommentActivity(a)};i.logShareCount=function(b,c){var d=g.url+"entityCount";var a={appKey:g.appKey,via:c,entityId:b};i.log(d,a)};i.getShareCount=function(c,a){var d=g.url+"sharedEntity";var b={appKey:g.appKey,msids:c};j.ajax({type:"GET",url:d,jsonpCallback:"getShareCount"+Math.random()*1000000000000000000,dataType:"jsonp",data:b,success:function(e){var f=e&&e.length>0?e[0]:null;if(f&&a){if(a){a(f)}else{a(null)
}}},error:a})};i.getNotifications=function(a){var c=g.url+"notification";var b={appKey:g.appKey,openNetworkId:"sso",size:100,lastSeenId:0,after:true};j.ajax({type:"GET",url:c,jsonpCallback:"getNotifications"+Math.random()*1000000000000000000,dataType:"jsonp",data:b,success:a,error:a})};i.followUser=function(b,a){j.getJSONP(g.url+"followuser",{userId:b,fromMyTimes:true},a)};i.unfollowUser=function(b,a){j.getJSONP(g.url+"unfollowuser",{userId:b,fromMyTimes:true},a)};i.getFollowers=function(a){j.getJSONP(g.url+"activity/myfriends",{openNetworkId:"sso",size:-1,lastSeenId:0,after:true,type:"follower"},a)
};i.getFollowee=function(a){j.getJSONP(g.url+"activity/myfriends",{openNetworkId:"sso",size:-1,lastSeenId:0,after:true,type:"followee"},a)};i.followUser=function(b,a){j.getJSONP(g.url+"followuser",{userId:b,fromMyTimes:true,medium:"WEB"},a)};i.updateUserCity=function(b,a){j.getJSONP(g.url+"/profile/update?city="+b,{openNetworkId:"sso",size:-1,lastSeenId:0,after:true},a)};return i});define("tiljs/apps/times/api",["module","../../util","../../ajax","../../cookie","../../event","../../string","../../page","../../analytics/mytimes"],function(u,o,l,v,w,n,m,q){var r={};
var p={ticket:{url:"https://jsso.indiatimes.com/sso/crossdomain/getTicket"},usersInfo:{url:"https://myt.indiatimes.com/mytimes/profile/info/v1/",params:{ssoid:""}},badges:{url:"https://rewards.indiatimes.com/bp/api/urs/mubhtry",params:{format:"json",pcode:m.getChannel(),uid:""}},rewards:{url:"https://rewards.indiatimes.com/bp/api/urs/ups",params:{format:"json",pcode:m.getChannel(),uid:""}},comments:{url:document.location.host=="test.indiatimes.com"||document.location.host=="test.happytrips.com"?"lib/getComments.php":"/json/new_cmtofart2_nit_v1.cms",type:"json",params:{msid:"",curpg:1,pcode:m.getChannel()}}};
p.comments_newest=p.comments;p.comments_oldest={url:p.comments.url,type:p.comments.type,params:{msid:"",curpg:1,ordertype:"asc",pcode:m.getChannel()}};p.comments_recommended={url:p.comments.url,type:p.comments.type,params:{msid:"",curpg:1,commenttype:"mostrecommended",pcode:m.getChannel()}};p.comments_discussed={url:p.comments.url,type:p.comments.type,params:{msid:"",curpg:1,commenttype:"mostdiscussed",pcode:m.getChannel()}};p.comments_agree={url:p.comments.url,type:p.comments.type,params:{msid:"",curpg:1,commenttype:"agree",pcode:m.getChannel()}};
p.comments_disagree={url:p.comments.url,type:p.comments.type,params:{msid:"",curpg:1,commenttype:"disagree",pcode:m.getChannel()}};p.validate_comment={url:"/validatecomment.cms",type:"html",params:{fromname:null,fromaddress:null,userid:null,location:null,imageurl:null,loggedstatus:null,message:null,roaltdetails:null,ArticleID:null,msid:null,parentid:null,rootid:null}};p.post_comment={url:"/postro.cms",type:"html",params:{fromname:null,fromaddress:null,userid:null,location:null,imageurl:null,loggedstatus:null,message:null,roaltdetails:null,ArticleID:null,msid:null,parentid:null,rootid:null}};
p.post_comment_withoutverification={url:"/postro_nover.cms",type:"html",params:{fromname:null,fromaddress:null,userid:null,location:null,imageurl:null,loggedstatus:null,message:null,roaltdetails:null,ArticleID:null,msid:null,parentid:null,rootid:null}};p.post_comment_withverification={url:"/postroemailverification.cms",type:"html",params:{fromname:null,fromaddress:null,userid:null,location:null,imageurl:null,loggedstatus:null,message:null,roaltdetails:null,ArticleID:null,msid:null,parentid:null,rootid:null}};
p.rate={url:"/rate_techreview.cms",type:"html",params:{msid:null,getuserrating:null,vote:null,criticrating:null}};p.rate_comment={url:"/ratecomment_new.cms",type:"html",params:{opinionid:null,typeid:null,rateid:null}};p.rate_comment_offensive={url:"/offensive/mark",type:"html",params:{ofusername:null,ofreason:"NONE",ofcommenteroid:null,ofcommenthostid:83,ofcommentchannelid:-2128958273,ofcommentid:null,ofuserisloggedin:null,ofuserssoid:null,ofuseremail:null}};var t=o.extend(true,{},p,u.config());r.updateConfig=function(a){t=o.extend(true,t,a)
};r.getConfig=function(a){return t};r.getTicket=function(b,a){return r.api("ticket",b,a)};r.getUsersInfo=function(b,a){return r.api("usersInfo",{ssoid:b.ssoids},a)};r.getBadges=function(b,a){return r.api("badges",b,a)};r.getRewards=function(b,a){return r.api("rewards",b,a)};r.getComments=r.getComments_newest=function(b,a){return r.api("comments",b,a)};r.getComments_oldest=function(b,a){return r.api("comments_oldest",b,a)};r.getComments_recommended=function(b,a){return r.api("comments_recommended",b,a)
};r.getComments_discussed=function(b,a){return r.api("comments_discussed",b,a)};r.getComments_agree=function(b,a){return r.api("comments_agree",b,a)};r.getComments_disagree=function(b,a){return r.api("comments_disagree",b,a)};r.validateComment=function(b,a){return r.post("validate_comment",b,a)};r.postComment=function(b,a){return r.post("post_comment",b,a)};r.postCommentWithoutVerification=function(b,a){return r.post("post_comment_withoutverification",b,a)};r.postCommentWithVerification=function(b,a){return r.post("post_comment_withverification",b,a)
};r.rate=function(d,c,a){var b={msid:d.msid,getuserrating:d.user_rating,vote:d.rating,criticrating:d.critic_rating};return r.api("rate",b,c)};r.rateComment=function(a,c,b){if(b){switch(a.typeid){case 100:q.agreeComment(a.opinionid);break;case 101:q.disagreeComment(a.opinionid);break;case 102:q.recommendComment(a.opinionid);break;case 103:r.rateCommentOffensive(a,b);break}}return r.api("rate_comment",a,c)};r.rateCommentOffensive=function(a,b,c){if(b){var d={};d.ofcommenteroid=a.opinionid;d.ofcommentid=window.msid;
d.ofuserisloggedin=1;d.ofuserssoid=d.ofuseremail=b.getEmail();d.ofusername=b.getFullName();return r.api("rate_comment_offensive",d,c)}else{w.publish("logger.error","Cannot rate comment offensive, user not available.")}};r.api=function(a,b,c){var d=t[a];return l.get(o.val(d.url,d.params),o.extend(true,{},d.params,b),function(f){if(c){try{c(f)}catch(e){w.publish("logger.error",e.stack)}}},d.type||"jsonp").error(function(){if(c){try{c()}catch(e){w.publish("logger.error",e.stack)}}})};r.post=function(a,b,c){var d=t[a];
return l.post(o.val(d.url,d.params),o.extend(true,{},d.params,b),function(f){if(c){try{c(f)}catch(e){w.publish("logger.error",e.stack)}}}).error(function(g,e,f){g.publish("comment.post.error",f)})};r.get=function(a,c){if(c){var d=t[a];var b=o.extend(true,{},d.params,c);return{url:o.val(d.url,b),params:b}}else{return t[a]}};r.init=function(){o.each(t,function(b,a){var c=n.camelCase("get "+b);r[c]=function(e,d){l.getJSONP(o.val(a.url,a.params),o.extend(true,{},a.params,e),function(f){if(d){d(f)}})}
})};return r});define("tiljs/ui",["./util","./logger","./event","jquery","./is","./timer"],function(m,l,t,o,n,r){l.log("ui loaded");var u={},q={},k,p;u.window=function(h,i){l.log("ui.window called");var d,f,a,b,e,g;d={width:300,height:300,name:"Window",mask:true,resizable:false,disableScroll:false,closeCallback:function(){l.log("Empty ui.window callback function.")}};f=m.extend(true,{},d,i);a=window.screen.width/2-f.width/2;b=window.screen.height/2-f.height/2;e=["width="+f.width,"height="+f.height,"left="+(n.defined(f.left)?f.left:a),"top="+(n.defined(f.top)?f.top:(b-20)),"scrollbars="+(n.defined(f.scrollbars)&&(f.scrollbars==1)?f.scrollbars:0),"resizable="+f.resizable];
if(f.mask===true&&n.desktop()){u.mask(null,{},false)}if(f.disableScroll===true){u.disableScroll()}g=window.open(h,f.name,e.join(","));if(g){g.focus();l.log("Popup opened: "+h);l.log(g)}try{g.reposition=function(){var w=window.screen.width/2-f.width/2,j=(window.screen.height/2-f.height/2);g.moveTo(w,j)}}catch(c){l.warn("Handled Exception in IE10.");l.error(c)}if(!g){alert("Popups are blocked. Please enable them.");l.error("Popups are blocked. Please enable them.");u.unmask();return g}(function(A,y,j){var z=window.setInterval(function(){try{l.log("Checking if popup is closed:"+y+":"+A.closed);
if(A===null||A.closed!==false){u.window.close(j.name)}}catch(v){l.warn("Handled exception while closing popup.");l.error(v.stack);window.clearInterval(z);z=null}},500);q[j.name]={opt:j,popup:A,interval:z,url:y}}(g,h,f));return g};u.window.close=function(b,a){if(!b){l.error("Window name is required to close it.");return}var c=q[b];if(a===true){m.each(q,function(d){u.window.close(d)})}else{if(c){l.log("Closing popup is closed:"+c.opt.name+":"+c.url);if(c.opt.mask===true){u.unmask()}if(c.opt.disableScroll===true){u.enableScroll()
}window.clearInterval(c.interval);c.interval=null;c.popup.close();q[c.opt.name]=null;c.opt.closeCallback(c.popup)}else{l.warn("Popup '"+b+"' not found.")}}};if(window.closeWindow){l.warn("window.closeWindow is already defined, open windows may not close properly.")}else{window.closeWindow=u.window.close}u.iframe=function(a,b){var d={width:300,height:300,name:"Window",disablePopup:true,closeCallback:function(){l.log("Empty ui.iframe callback function.")}},g=m.extend(true,{},d,b),f=o("<iframe class='loginsignupframe'></iframe>"),e,c;
f.attr("src",a);f.css({width:"100%",height:"100%",border:"4px solid #cccccc",backgroundColor:"#FFF"});e=f[0];c=u.popup(f,g);e.close=function(){f.remove();c.remove();u.unmask()};e.resizeTo=function(h,i){if(h&&i){c.width(h);c.height(i)}};e.reposition=c.reposition;return e};u.closeButton=function(a){var b=o("<span></span>");b.on("click",a);return b};u.popup=function(e,g){var d,a,b,f,c;d={width:300,height:300,name:"Window",closeCallback:function(){l.log("Empty ui.popup callback function.")},disableScroll:false};
f=m.extend(true,{},d,g);c=o("<div></div>");c.width(f.width);c.height(f.height);c.css({position:"absolute",zIndex:p.zIndex+1});c.append(e);if(f.disableScroll===true){u.disableScroll()}if(f.closeCallback){if(window.closePopup){l.warn("'window.closePopup' is already defined.")}if(window.disablePopup){l.warn("'window.disablePopup' is already defined.")}window.closePopup=window.disablePopup=function(){c.remove();u.unmask();if(f.disableScroll===true){u.enableScroll()}if(f.closeCallback){f.closeCallback()
}window.closePopup=null;window.disablePopup=null};a=u.closeButton(window.closePopup);a.addClass("popup_close_button");a.css({position:"absolute",top:"5px",right:"5px",cursor:"pointer",background:"url('/photo/25494620.cms') no-repeat scroll -160px -20px rgba(0, 0, 0, 0)",width:"18px",height:"18px"});c.append(a)}o("body").append(c);b=u.mask(c,{},false);c.reposition=function(){var j=o(window),y=j.width(),h=j.height(),x=((y/2)-(c.width()/2)),i=((h/2)-(c.height()/2));if(x<0){x=0}if(i<0){i=0}c.css({left:x,top:i+o(window).scrollTop()})
};c.reposition();c.close=function(){c.remove();u.unmask()};t.subscribe("window.resize",function(){c.reposition()});return c};u.img=function(a,c){var b=o("<img>");b.attr("src",a);m.each(c,function(d,e){b.attr(d,e)});return b};u.anchor=function(a,d,c){var b=o("<a>");b.attr("href",a);b.text(d);m.each(c,function(e,f){b.attr(e,f)});return b};u.inView=function(d,j,i){i=i||0;var b=o(window),e=o(d),g,f,a,c,h;if(e.is(":hidden")){return false}g=b.scrollTop()-i;f=g+b.height()+i;a=e.offset()?e.offset().top:0;
c=a+e.height();h=false;if(j===true){h=((c>g)&&(a<=f))}else{h=((c<=f)&&(a>=g))}return h};u.init=function(){var b=m.throttle(500,function(d){t.publish("window.scroll",d)}),c=function(d){t.publish("window.load",d)},a=m.throttle(500,function(d){t.publish("window.resize",d)});if(window.addEventListener){window.addEventListener("scroll",b,false);window.addEventListener("load",c,false);window.addEventListener("resize",a,false)}else{if(window.attachEvent){window.attachEvent("onscroll",b);window.attachEvent("onload",c);
window.attachEvent("onresize",a)}}o(function(d){t.publish("document.ready",d)})};u.getGravatar=function(b,a){if(!b||b.length===0){return null}a=a||80;return"http://www.gravatar.com/avatar/"+m.md5(b.trim().toLowerCase())+".jpg?s="+a};u.maxlength=function(b,c,d,e,a){o(e||"body").off("keyup change",b);o(e||"body").on("keyup change",b,function(){var f=o(this).val(),g=f.length;c=parseInt(c,10);d.call(this,c-g,g);if(g>c){o(this).val(f.substr(0,c));if(a){window.alert(a)}return false}})};u.getActionReferences=function(b,c){var a={current:o(b)};
a.parent=c?a.current.parents(c):a.current;a.parent.find("[data-plugin]").each(function(d,e){a[o(e).attr("data-plugin")]=o(this)});return a};k=null;p={position:"fixed",left:0,top:0,width:"100%",height:"100%",backgroundColor:"#000",opacity:0.5,zIndex:99999};u.mask=function(b,c,a){if(!k){k=o("<div></div>");k.popup=b;k.css(m.extend(p,c));if(k.popup){k.popup.show()}if(typeof a==="undefined"||a===true){k.on("click",function(){if(k.popup){k.popup.hide()}u.unmask()})}o(document).one("keyup",function(d){if(d.keyCode===27){if(k){if(k.popup){k.popup.hide()
}u.unmask()}}});o("body").append(k)}else{l.warn("Already masked. Use ui.unmask() before masking again.")}return k};u.isMasked=function(){return k?true:false};u.unmask=function(){if(k){if(k.popup){k.popup.hide()}k.remove();k=null}else{l.warn("No mask available. Use ui.mask() before unmasking.")}};u.tooltip=function(b,c){c=c||5;var a=o("<div></div>");if(c>0){r.after(function(){a.fadeOut(function(){})})}return a};u.dialog=function(a){var b=o("<div></div>");b.css({backgroundColor:"#FFF"});b.html(a.html());
return b};u.customScrollbar=function(a){if(window.$&&window.$&&window.$.fn&&window.$.fn.mCustomScrollbar){a=window.$(a);a.mCustomScrollbar("destroy");a.mCustomScrollbar({scrollButtons:{enable:true},advanced:{updateOnContentResize:true,updateOnBrowserResize:true}})}else{l.warn("mCustomScrollbar not found.")}};u.disableScroll=function(a){o("html,body").css({overflow:"hidden",height:"100%",padding:"0",margin:"0"});o(a||"#container").css({overflowY:"scroll",height:"100%"})};u.enableScroll=function(a){o("html,body").css({overflow:"",height:"",padding:"",margin:""});
o(a||"#container").css({overflowY:"",height:""})};u.init();return u});define("tiljs/load",["./event","./logger","./util","./is"],function(h,j,g,i){j.log("load loaded");var f={};f.js=function(e,a,b,c){var d=document.getElementsByTagName("head")?document.getElementsByTagName("head")[0]:null;if(d){var m=document.createElement("script");var n=false;if(b){m.id=b}if(c){m.async=c}if(!e){throw new Error("Param 'url' not defined.")}m.src=e;m.onload=m.onreadystatechange=function(){if(!m.loaded&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){m.loaded=true;
var k=new Date().getTime();var p=k-m.startTime;h.publish("load.js",["_trackTiming","js",e,p,e]);if(a){try{a()}catch(l){h.publish("logger.error",l.stack)}}m.onload=m.onreadystatechange=null}};m.startTime=new Date().getTime();d.appendChild(m);return m}else{j.info("Head Element not found. JS '"+e+"' not loaded. ");return null}};f.css=function(c,a){var b=document.getElementsByTagName("head")?document.getElementsByTagName("head")[0]:null;if(b){var d=document.createElement("link");d.setAttribute("rel","stylesheet");
d.setAttribute("type","text/css");d.setAttribute("href",c);b.appendChild(d);if(a){setTimeout(a,0)}}else{j.info("Head Element not found. CSS '"+c+"' not loaded. ")}return d};f.iframe=function(a,b,m,d){var e=document.getElementById(d)||document.body;if(e){var c=document.createElement("iframe");c.src=a;c.scrolling="no";c.frameBorder="0";c.width=b||0;c.height=m||0;e.appendChild(c);return c}else{j.info("Container with id '"+d+"' not found. iframe '"+a+"' not loaded. ")}};f.image=function(a){if(i.array(a)){g.each(ajaxLogout,function(c,d){f.image(d)
})}else{var b=new Image();b.src=a}};f._content=function(a,b){};f.isLoaded=function(a){return $('script[src="'+a+'"]').length>0||$('link[href="'+a+'"]').length>0};return f});define("tiljs/localstorage",["module","./util","json","./is","./logger"],function(r,n,l,o,k){var m={};var p={};var q=n.extend(true,{},p,r.config());var j=window.localStorage;if(!j){k.warn("'localStorage' is not available.");j={getItem:function(){},removeItem:function(){},setItem:function(){}}}m.get=function(b){var a=j.getItem(b);
if(a!=null){var c=l.parse(a);if(!c){return null}return(new Date().getTime()<c.timestamp)?c.value:null}else{return null}};m.getAll=function(){return m.get()};m.remove=function(c,a,b){if(c){j.removeItem(c)}};m.set=function(h,b,a,u,f,i){var g=new Date();var c=g.getTime()+((a||365)*24*60*60*1000);var e={value:b,timestamp:new Date().getTime()+c,path:u,domain:f};try{j.setItem(h,l.stringify(e))}catch(d){k.error("Unable to save item in localStorage:"+h)}};return m});define("api",["tiljs/apps/times/api"],function(c){var d=c;
return d});define("tiljs/plugin/plugin",["../load","../util","../event","../ui","../logger","../is"],function(l,n,q,m,j,o){var p={init:true,root:"body",dependency:function(a){this.dep_data={};if(a){a()}}};var k=function(a,b){if(!a){throw new Error("'id' param is required.")}this.id=a;this.updateConfig(b)};k.prototype.updateConfig=function(a){this.config=n.extend(true,{},p,a)};k.prototype.find=function(){return $(this.config.root).find("[data-plugin='"+this.id+"']")};k.prototype.init=function(){q.publish(r("beforeinit"));
if(o.funct(this.config.dependency)){var a=this;this.config.dependency(function(){a.render()})}else{this.render()}};k.prototype.render=function(){q.publish(r("beforerender"));var a=this;this.find().each(function(c,b){a.renderEach(b)});q.publish(r("afterrender"))};k.prototype.renderEach=function(a){};var r=function(a){return"plugin."+this.id+a};return k});define("tiljs/plugin/dynamic",["../timer","../util","../plugin/plugin"],function(g,f,h){var e=new h("dynamic-uptime");e.uptime=function(){var a=$("[data-plugin='dynamic-uptime']");
a.each(function(c,b){e.renderEach(b)})};e.renderEach=function(b){var c=$(b);var a=c.attr("data-time");var d=g.elapsedTime(a,{minute:"min",second:"sec"},true);c.html(d)};g.every(60000,function(){e.render()});e.init();return e});define("rodate",[],function(){var b={};b.uptime=function(){var a=$("[rodate]");a.each(function(f,e){b.renderEach(e)})};b.renderEach=function(j){var k=$(j);var a="";var h=k.attr("rodate");var l=h.match(/^(\d+)-(\d+)-(\d+) (\d+)\:(\d+)\:(\d+)$/);if(!!h&&!l){h=!isNaN(h)?parseInt(h):h;
var i=new Date(h);if(!isNaN(i.getTime())){rod=i}else{if(h.indexOf("hrs IST")!=-1){h=h.replace(" hrs IST","");h=h.splice(-2,0,":")}h=h.replace("IST","");h=h.replace("hrs","");h=h.replace("AM"," AM");h=h.replace("PM"," PM");rod=new Date(h);if(isNaN(rod.getTime())){if(h.indexOf(":")>-1){h=h.split(" ").join("T");h=h.concat("+05:30");rod=new Date(h)}}}l=["",rod.getYear()+1900,rod.getMonth()+1,rod.getDate(),rod.getHours(),rod.getMinutes(),rod.getSeconds()]}if(!!l&&l instanceof Array&&l.length>=6){a=b.elapsedTime(new Date(l[1],l[2]-1,l[3],l[4],l[5],l[6]).getTime(),{minute:"min",second:"sec"},true)
}k.html(a)};b.elapsedTime=function(o,u,w){if(typeof o!=="number"){return""}var a={year:"year",day:"day",hour:"hour",minute:"minute",second:"second",ago:"ago"};var p=$.extend({},a,u);var i=[{name:p.year,div:31536000000,mod:10000},{name:p.day,div:86400000,mod:365},{name:p.hour,div:3600000,mod:24},{name:p.minute,div:60000,mod:60},{name:p.second,div:1000,mod:60}];var q=0,t=i.length,r,l=[],v=new Date().getTime()-o;while(q<t){r=Math.floor(v/i[q].div)%i[q].mod;if(r&&r>=0){l.push(r+" "+i[q].name+(r>1?"s":""))
}q+=1}if(l.length===0){l.push("1 "+p.second)}if(w===true){return l[0]+" "+p.ago}else{return l.join(", ")+" "+p.ago}};return b});define("tiljs/login",["tiljs/apps/times/usermanagement"],function(b){mod_login=b;return mod_login});define("tiljs/plugin/lazy",["../event","../ui","module","../util"],function(l,j,m,h){var i={};var k={skew:1000,error_image:null};var n=h.extend(true,{},k,m.config());i.init=function(){var a=this;a.load();l.subscribe("window.scroll",function(){a.load()})};i.load=function(){var a=this;
var b=$("[data-src]");b.each(function(d,c){if(j.inView(c,true,n.skew)){a.loadEach(c)}})};i.loadEach=function(c){var d=$(c);var a=(typeof toiprops!="undefined"&&toiprops.hasOwnProperty("imgdomain"))?toiprops.imgdomain:"";var b=(/^(f|ht)tps?:\/\//i.test(d.attr("data-src")))?d.attr("data-src"):a+d.attr("data-src");if(n.error_image){d.error(function(){$(this).attr("src",a+n.error_image)})}d.attr("src",d.attr("data-src"));d.removeAttr("data-src");if(d.siblings(".loader").length>0){setTimeout(function(){if(d.hasClass("blurimage")){d.removeClass("blurimage")
}d.siblings(".loader").hide()},500)}};i.init();return i});define("jsrender",["jquery"],function(b){if(!b.fn.render){throw new Error("Missing js: http://timesofindia.indiatimes.com/jsrender.cms")}return b.fn.render});define("localstoragec",["tiljs/cookie"],function(d){var c={};c.isEnabled=function(){return typeof(Storage)!=="undefined"};c.checkExpiry=function(b){var a=localStorage.getItem(b);if(a&&!(a.hasOwnProperty("timestamp")&&a.hasOwnProperty("expires"))){return b}if(a&&(Number(new Date().getTime())-Number(a.timestamp)>Number(a.expires)*60*60*24*1000)){localStorage.removeItem(b);
return}return b};c.set=function(n,l,p,a,m,b){try{var o={value:l,timestamp:new Date().getTime(),expires:p};localStorage.setItem(n,JSON.stringify(o))}catch(e){d.set(n,l,p,a,m,b)}};c.get=function(b){var a="";try{a=JSON.parse(localStorage.getItem(b))}catch(f){a=localStorage.getItem(b)}return(a&&a.value)?a.value:a};c.csget=function(a){return(c.isEnabled()&&c.get(a))?c.get(a):d.get(a)};c.remove=function(a){return localStorage.removeItem(a)};return c});define("tiljs/comments",["./util","./ui","jquery","module","./is","./plugin/lazy","./event"],function(m,k,o,t,n,r,u){var p={gravatar:false,wrapper:"#comment-section",main:"#comments",comment:"[data-plugin='comment']",tmpl:"comment_tmpl",count:"[data-plugin='comments-count']",post_button:"[data-plugin='comment-post']",comment_input:"[data-plugin='comment-input']",form:"[data-plugin='comment-form']",loadonscroll:true};
var q=function(a){this.config=m.extend(true,{},a)};q.config=m.extend(true,{},p,t.config());var l=[{text:"Hello World",name:"Del Sanic",image:"http://www.gravatar.com/avatar/?d=identicon",uid:"123456",badge:[{name:"Silver"},{name:"Gold"}]},{text:"Test Comment",name:"John",image:"http://www.gravatar.com/avatar/?d=identicon",uid:"123457",badge:[{name:"Silver"},{name:"Gold"}]}];q.getConfig=function(){return this.config};q.prototype.getConfig=function(){return this.config};q.prototype.initialize=function(){var a=this;
this.comments=[];this.getData(function(b,c){a.renderCommentCount(c||(b?b.length:0));if(b&&b.length>0){a.renderNoComment(false);a.render(b)}else{a.renderNoComment(true)}});if(a.config.loadonscroll===true){(function(b){u.subscribe("window.scroll",function(){b.loadNextPg()})})(a)}};q.prototype.getData=function(a){a(l)};q.prototype.renderCommentCount=function(a,b){o("[data-plugin='comment-count']").text(a)};q.prototype.renderNoComment=function(a){if(a){o("[data-plugin='comment-none']").show()}else{o("[data-plugin='comment-none']").hide()
}};q.prototype.render=function(e,d,c){var a=this;if(e){var b=o(a.config.wrapper+" "+a.config.main);if(c==false||typeof c==="undefined"){b.empty()}m.each(e,function(f,g){b.append(a.renderEach(f,g));if(d){d(e)}});r.load()}};q.prototype.renderEach=function(b,a){if(this.config.tmpl&&o.fn.render){return this.renderUsingTemplate(b,a,this.config.tmpl)}else{u.publish("logger.error","$.fn.render not defined. Render using jquery. this.config.tmpl="+this.config.tmpl+"&$.fn.render="+o.fn.render);return this.renderUsingjQuery(b,a)
}};q.prototype.renderUsingTemplate=function(a,d,b,c){return o("#"+b).render(d)};q.prototype.renderUsingjQuery=function(b,a){var c=o("<li></li>");c.text(a.name+": "+a.text);return c};q.prototype.loadingDiv=function(a){o("[data-plugin='comment-loading']").text(a)};q.prototype.loadNextPg=function(){var a=this;if(a.isLoading===0&&k.inView(a.config.main+" .comment:last-child",true,1000)){a.loadComment(a.config.commentType,function(b){},true,++a.config.curpg)}};q.prototype.loading=function(a){this.loadingDiv("Loading...");
this.isLoading=1};q.prototype.loaded=function(){this.loadingDiv("");this.isLoading=0;u.publish("comments.loaded",this);if(this.config.loadonscroll==false){o(this.config.wrapper).find("#"+this.config.commentType).append("<div class='loadmore'>View more comments</div>")}};q.prototype.loadedAll=function(){this.loadingDiv("Loaded all comments");o(this.config.wrapper+" #"+this.config.commentType+" .loadmore").hide();if(this.comments.length==0){u.publish("comments.loaded.none",this)}else{if(this.comments.length>=0){u.publish("comments.loaded.all",this)
}}this.isLoading=2};return q});define("tiljs/social/social",["../load","../util","jquery","../event","../ui","../logger"],function(j,h,k,m,l,n){var i=function(a){this.id=a;this.config={js:null,js_id:null};this.config=function(c){this.config=h.extend(true,{},this.config,c);this.js=c.js;this.js_id=c.js_id};this.setJS=function(d,c){this.js=d;this.js_id=c};this.plugins={};this._getPluginID=function(c){return b.id+"-"+c};this.addPlugin=function(e){b.plugins[this._getPluginID(e.id)]=e;if(e.alias){for(var d=0;
d<e.alias.length;d++){var c=h.extend(true,{},e,{id:e.alias[d]});delete c.alias;this.addPlugin(c)}}};this.getPlugin=function(c){return b.plugins[this._getPluginID(c)]};var b=this;this.beforeinit=function(){};this.afterloadjs=function(){};this.beforeloadjs=function(){};this.init=function(c){if(b.beforeinit){b.beforeinit()}var d=b.find();n.log(b.id+" init:"+d.length);if(d&&d.length>0||c.parse===true){if(b.beforeloadjs){b.beforeloadjs()}if(b.js&&(b.isJSdependent(d)||c.parse===true)){j.js(b.js,function(e,f){return function(){if(b.afterloadjs){b.afterloadjs(c)
}b.initPlugins(f)}}(b,d),b.js_id)}else{b.initPlugins(d)}}};this.find=function(){return k("[data-plugin^='"+this.id+"-']")};this.isJSdependent=function(f){for(var e=0;e<f.length;e++){var d=f[e];var c=k(d).attr("data-plugin");if(b.plugins[c]&&b.plugins[c].js){return true}}return false};this.initPlugins=function(c){this.registerPluginEvents()};this.registerPluginEvents=function(){h.each(b.plugins,function(c,d){h.each(d.events,function(f,g){k("body").off(f,"[data-plugin='"+c+"']");k("body").on(f,"[data-plugin='"+c+"']",function(p){if(g){try{m.publish("social.action",{plugin:c,event:f,element:this,dom_event:p});
g.call(this,p)}catch(p){m.publish("logger.error",p.stack)}}p.stopPropagation();return false})});var e=k("body").find("[data-plugin='"+c+"']");e.each(function(p,f){if(d.init){try{d.init(f,d)}catch(g){m.publish("logger.error",g.stack)}}})})};this.preAttachPluginEvent=function(d){var c=0;h.each(b.plugins,function(g,e){var f=d.filter("[data-plugin='"+g+"']");f.each(function(q,r){c++;if(e.init){e.init(r,e);k(r).css("border","2px solid red")}})});n.log(b.id+" found plugin : "+c+"/"+d.length)};this.renderPlugin=function(r,f,d){var e=k(r);
var c=h.data(r);var g=h.extend(true,{},f,c);g.href=c.url||c.href||e.attr("href")||g.href;var q=k(d);k.each(g,function(p,o){q.attr("data-"+p,o)});e.empty();e.append(q);this.parse(r)};this.getAbsoluteUrl=function(d){var c=(d&&d.length>0&&d!=="#")?d:document.location.href;c=c.split("#")[0];if(c&&c.length>2&&c[0]==="/"&&c[1]!=="/"){c=location.protocol+"//"+location.host+c}return c};this._share=function(u,g,c,r){m.publish("social.onBeforeShare",{params:g,element:r,network:this.id});var t=this.getAbsoluteUrl(u);
var d="social_share_"+new Date().getTime();var f=k.extend({name:d,width:700,height:400},c);var e=l.window(t+"?"+k.param(g),f);if(e){e.moveTo(275,275)}}};i.onBeforeShare=function(a){m.subscribe("social.onBeforeShare",a)};return i});define("tiljs/social/facebook",["../social/social","../ui","../logger","../event","../util","module","jquery","../ajax","../is"],function(D,r,p,E,u,C,w,q,v){var y={parse:false,init:true,appid:null,js:"//connect.facebook.net/en_US/sdk.js",js_id:"facebook-jssdk",load_js:false,share_url:"http://www.facebook.com/sharer.php",oauth:false,status:false,xfbml:false,fb_version:"v2.12",share_params:function(c,a,d,b){return{"url[url]":c}
}};var A=u.extend(true,{},y,C.config());var t=new D("facebook","facebook");t.setJS(A.js,A.js_id);var B=t.isJSdependent;t.isJSdependent=function(a){return A.load_js||B(a)};t.addPlugin({id:"like",js:true,init:function(c,e){var f=w(c);var d=u.data(c);var g={href:location.href,layout:"button_count","show-faces":"false",width:"100",action:"like",share:false};var a=u.extend(true,{},g,d);a.href=d.url||d.href||f.attr("href")||a.href;var b=w("<div class='fb-like'></div>");w.each(a,function(h,i){b.attr("data-"+h,i)
});f.empty();f.append(b);t.parse(c)}});t.addPlugin({id:"comments",js:true,init:function(b,d){var e=w(b);var c=u.data(b);var f={href:location.href,colorscheme:"light",numposts:10};var a=u.extend(true,{},f,c);a.href=c.url||c.href||e.attr("href")||a.href;var g=w("<div class='fb-comments'></div>");w.each(a,function(h,i){g.attr("data-"+h,i)});e.empty();e.append(g);t.parse(e[0])}});t.addPlugin({id:"share",alias:["button"],events:{click:function(b){var c=u.data(this);var a=c.title||document.title;t.share(c.url||w(this).attr("href"),a,c.summary,c.image,this)
}}});t.share=function(e,a,f,b,d){if(false&&window.FB&&A.appid){FB.ui({method:"feed",display:"popup",link:t.getAbsoluteUrl(e),picture:t.getAbsoluteUrl(b),name:a,description:f},function(g){})}else{var c={u:t.getAbsoluteUrl(e),display:"popup",sdk:"joey"};if(!v.empty(A.appid)){c.app_id=A.appid}t._share(A.share_url,c,{name:"facebook_share_dialog",width:626,height:(v.IE())?600:436},d)}};t.addPlugin({id:"follow",events:{click:function(a){t.follow(w(this).attr("data-url")||w(this).attr("href"))}},init:function(a,b){}});
t.follow=function(c,d){var b=t.getAbsoluteUrl(c);var a=window.open(c,"_blank");a.focus()};t.addPlugin({id:"login",js:true,events:{click:function(a){t.login()}}});var x=null;t.parse=function(a){if(typeof FB!=="undefined"){FB.XFBML.parse(a)}else{p.warn("'FB' is required in parse")}};t.getGrantedPermissions=function(a){if(typeof FB!=="undefined"){t.api("/me/permissions",function(b){if(a){a(b)}})}else{p.warn("'FB' is required in login")}};t.hasPermissions=function(b,a){if(typeof FB!=="undefined"){t.api("/me/permissions",function(c){if(c&&c.data&&c.data.length>0){var e=typeof b==="string"?b.split(","):(b instanceof Array?b:[]);
for(var f=0;f<e.length;f++){var d=c.data[0];if(d.hasOwnProperty(e[f])){if(a){a(true);return null}}}}if(a){a(false,c&&c.error?c.error:null)}})}else{p.warn("'FB' is required in login")}};t.getPermissions=function(b,a){if(typeof FB!=="undefined"){var c=typeof b==="string"?b:(b instanceof Array?b.join(","):"");t.hasPermissions(b,function(d){if(d===true){if(a){a(d)}}else{t.login(b,function(){t.hasPermissions(b,function(e){if(a){a(e)}})})}})}else{p.warn("'FB' is required in login")}};t.login=function(b,a){if(typeof FB!=="undefined"){p.log(b);
var c=typeof b==="string"?b:(b instanceof Array?b.join(","):"");if(x!=c){FB.login(a,{scope:c})}}else{p.warn("'FB' is required in login")}};t.addPlugin({id:"logout",events:{click:function(a){t.logout()}}});t.logout=function(a){if(typeof FB!=="undefined"){FB.logout(a)}else{p.warn("'FB' is required in logout")}};t._createFBroot=function(){var a="fb-root";var b=w("#"+a);if(!b||b.length==0){b=w("<div></div>");b.attr("id",a);b.css("display","none");w("body").append(b)}return b};t.beforeinit=function(){if(!A.appid){p.warn("'config.appid' is Required")
}};t.beforeloadjs=function(){t._createFBroot()};t.afterloadjs=function(a){if(typeof FB!=="undefined"){p.log("FB js loaded");if(A.init===true||a.init===true){FB.init({appId:A.appid,oauth:A.oauth,status:A.status,cookie:true,xfbml:A.xfbml,version:A.fb_version})}E.publish("FB.onload",FB);FB.Event.subscribe("edge.remove",function(b){E.publish("FB.edge.remove",b)});FB.Event.subscribe("edge.create",function(b){E.publish("FB.edge.create",b)});FB.Event.subscribe("comment.create",function(b){E.publish("FB.comment.create",b)
});FB.Event.subscribe("auth.authResponseChange",function(d){E.publish("FB.auth.authResponseChange",d);if(d.status==="connected"){var b=d.authResponse.userID;var c=d.authResponse.accessToken;E.publish("FB.auth.authResponseChange.connected",d);E.publish("FB.connected",FB)}else{if(d.status==="not_authorized"){E.publish("FB.auth.authResponseChange.not_authorised",d)}else{E.publish("FB.auth.authResponseChange.failed",d)}}})}else{p.warn("'FB' is required in afterloadjs")}};var z=null;t.getUser=function(a){if(typeof FB!=="undefined"&&!z){FB.api("/me",function(b){if(a){z=b;
a(b)}})}else{if(a){a(z)}}};t.onlogin=function(a){E.subscribe("FB.auth.authResponseChange.connected",function(b){t.getUser(function(c){if(a){a(c,b)}})})};t.oncomment=function(a){E.subscribe("FB.comment.create",function(b){t.getUser(function(c){if(a){a(c,b)}})})};t.onlogout=function(a){E.subscribe(["FB.auth.authResponseChange.not_authorised","FB.auth.authResponseChange.failed"],function(b){if(a){z=null;a(b)}})};t.fql=function(b,a){if(typeof FB!=="undefined"){p.log(b);FB.api({method:"fql.query",query:b},a)
}else{p.warn("'FB' is required in fql")}};t.getLikes=function(a){if(typeof FB!=="undefined"){FB.api("/me/likes",function(b){if(a){z=b;a(b)}})}};t.getLikesByCategory=function(c,a){if(c.length>0&&v.string(c)){c=c.split(",")}var d=[];if(c.length>0){u.each(c,function(e,f){d.push("type='"+f+"'")})}var b=d.length>0?"AND ("+d.join(" OR ")+")":"";t.getUser(function(e){if(e){t.fql("select name from page where page_id in (SELECT page_id FROM page WHERE page_id IN (SELECT uid, page_id, type FROM page_fan WHERE uid=me()) "+b+")",function(f){if(a){a(f)
}})}else{p.warn("User is not logged in. Cannot run facebook.getLikesByCategory.")}})};t.paging=t.pageNext=function(b,a){if(b&&b.paging&&b.paging.next){return q.getJSONP(b.paging.next,a)}else{a(null)}};t.pagePrev=function(b,a){if(b&&b.paging&&b.paging.previous){return q.getJSONP(b.paging.previous,a)}else{a(null)}};t.getRegisteredUsersTxt=function(a){t.getRegisteredUsers(function(b){if(a){if(b.length==1){a(b[0].name+" has planned his/her trips on HappyTrips.com.",b)}else{if(b.length>1){a(b.length+" of your friends have planned their trips on HappyTrips.com",b)
}else{a("None of your friends have planned their trips on HappyTrips.com.",b)}}}})};t.getRegisteredUsers=function(a){t.fql("SELECT uid,name,pic_square_with_logo FROM user WHERE is_app_user AND uid IN (SELECT uid2 FROM friend WHERE uid1 = me())",a)};t.api=function(){var d=arguments[0];var a=typeof arguments[1]==="string"?arguments[1]:"GET";var c=typeof arguments[2]==="object"?arguments[2]:{};var b=typeof arguments[1]==="function"?arguments[1]:(typeof arguments[2]==="function"?arguments[2]:(typeof arguments[3]==="function"?arguments[3]:null));
if(typeof FB!=="undefined"){p.debug(d);FB.api(d,a,c,function(e){if(b){b(e)}})}else{p.warn("'FB' is required in api")}};t.getCheckins=function(a){t.api("/me/locations",a)};t.post=function(b,a){var c=typeof arguments[0]==="string"?{message:arguments[0]}:arguments[0];t.login("publish_stream",function(){t.api("/me/feed","POST",c,a)})};t.checkin=function(b,c,a){t.post({message:b,place:c},a)};w(document).ready(function(){t.init(A)});return t});define("tiljs/ext/date",[],function(){!function(i,l){var m=/(["'])((?:[^\\]|\\.)*?)\1|YYYY|([MD])\3\3(\3?)|SS|([YMDHhmsW])(\5?)|[uUAZSwo]/g,j=/(\d{4})[-.\/](\d\d?)[-.\/](\d\d?)/,k=/(\d\d?)[-.\/](\d\d?)[-.\/](\d{4})/,o=/(\d\d?):(\d\d):?(\d\d)?\.?(\d{3})?(?:\s*(?:(a)|(p))\.?m\.?)?(\s*(?:Z|GMT|UTC)?(?:([-+]\d\d):?(\d\d)?)?)?/i,p=/.[a-z]+/g,n=/\\(.)/g;
i[l].format=function(c){c=i.masks[c]||c||i.masks["default"];var b=this,a="get"+(c.slice(0,4)=="UTC:"?(c=c.slice(4),"UTC"):"");return c.replace(m,function(d,e,g,h,u,f,t){g=f=="Y"?b[a+"FullYear"]()%100:d=="YYYY"?b[a+"FullYear"]():f=="M"?b[a+"Month"]()+1:h=="M"?i.monthNames[b[a+"Month"]()+(u?12:0)]:f=="D"?b[a+"Date"]():h=="D"?i.dayNames[b[a+"Day"]()+(u?7:0)]:f=="H"?b[a+"Hours"]()%12||12:f=="h"?b[a+"Hours"]():f=="m"?b[a+"Minutes"]():f=="s"?b[a+"Seconds"]():d=="S"?b[a+"Milliseconds"]():d=="SS"?(e=b[a+"Milliseconds"](),e>99?e:(e>9?"0":"00")+e):d=="u"?(b/1000)>>>0:d=="U"?+b:d=="A"?i[b[a+"Hours"]()>11?"pm":"am"]:d=="Z"?"GMT "+(-b.getTimezoneOffset()/60):d=="w"?b[a+"Day"]()||7:f=="W"?(e=new i(+b+((4-(b[a+"Day"]()||7))*86400000)),Math.ceil(((e.getTime()-e["s"+a.slice(1)+"Month"](0,1))/86400000+1)/7)):d=="o"?new i(+b+((4-(b[a+"Day"]()||7))*86400000))[a+"FullYear"]():e?g.replace(n,"$1"):d;
return t&&g<10?"0"+g:g})};i.am="AM";i.pm="PM";i.masks={"default":"DDD MMM DD YYYY hh:mm:ss",isoUtcDateTime:'UTC:YYYY-MM-DD"T"hh:mm:ss"Z"'};i.monthNames="JanFebMarAprMayJunJulAugSepOctNovDecJanuaryFebruaryMarchAprilMayJuneJulyAugustSeptemberOctoberNovemberDecember".match(p);i.dayNames="SunMonTueWedThuFriSatSundayMondayTuesdayWednesdayThursdayFridaySaturday".match(p);String[l].date=Number[l].date=function(b){var d,c,a=new i,e=+this||""+this;if(isNaN(e)){if(d=e.match(j)){a.setFullYear(d[1],d[2]-1,d[3])
}else{if(d=e.match(k)){c=i.middle_endian?1:2;a.setFullYear(d[3],d[c]-1,d[3-c])}}d=e.match(o)||[0,0,0];a.setHours(d[6]&&d[1]<12?+d[1]+12:d[5]&&d[1]==12?0:d[1],d[2],d[3]|0,d[4]|0);if(d[7]){a.setTime(a-((a.getTimezoneOffset()+(d[8]|0)*60+((d[8]<0?-1:1)*(d[9]|0)))*60000))}}else{a.setTime(e<4294967296?e*1000:e)}return b?a.format(b):a}}(Date,"prototype");return{}});define("tiljs/apps/times/comments",["module","jquery","json","jsrender","localstoragec","../times/api","../../comments","../../ajax","../../plugin/dynamic","../../util","../times/usermanagement","../../event","../../ui","../../is","../../string","../../plugin/lazy","../../cookie","../../logger","../../timer","../../analytics/mytimes","../../compatibility","../../social/facebook","../../page","../../user","../../ext/date"],function(module,$,json,jsrender,localstoragec,api,comments,ajax,dynamic,util,login,event,ui,is,string,lazy,cookie,logger,timer,mytimes,compatibility,facebook,page,userClass,ext_date){var CONSTANT={RATE_TYPE:{AGREE:100,DISAGREE:101,RECOMMEND:102,OFFENSIVE:103}};
var default_config={validation:{minlength:1},loadCommentFromMytimes:false,commentType:"comments",loadonscroll:true,sendCommentLiveEmail:true,loginRequiredForRating:true,nonloggedinComment:true,disabledirectcomment:false,maxchar:3000,maxCommentWrapLength:500,maxResponseCount:3,hideResponses:false,share_url:"/share.cms",verify_comment_url:"/json/cmtverified.cms",messages:{name_required:"Please enter your name.",location_required:"Please enter your location.",captcha_required:"Please enter captcha value.",name_toolong:"Name cannot be longer than 30 chars.",name_not_string:"Name can only contain alphabets.",location_toolong:"Location cannot be longer than 30 chars.",location_not_string:"Location can only contain alphabets.",captcha_toolong:"Captcha cannot be longer than 4 chars.",captcha_number_only:"Captcha value can only be a number.",email_required:"Please enter your email address.",email_invalid:"Please enter a valid email address.",captcha_invalid:"Please enter a valid captcha value.",minlength:"You can't post this comment as the length it is too short. ",blank:"You can't post this comment as it is blank.",maxlength:"You have entered more than 3000 characters.",popup_blocked:"Popup is blocked.",has_url:"You can't post this comment as it contains URL.",duplicate:"You can't post this comment as it is identical to the previous one.",abusive:"You can't post this comment as it contains inappropriate content.",self_agree:"You can't Agree with your own comment",self_disagree:"You can't Disagree with your own comment",self_recommend:"You can't Recommend your own comment",self_offensive:"You can't mark your own comment as Offensive",already_agree:"You have already Agreed with this comment",already_disagree:"You have already Disagreed with this comment",already_recommended:"You have already Recommended this comment",already_offensive:"You have already marked this comment Offensive",cant_agree_disagree:"You can't Agree and Disagree with the same comment",cant_agree_offensive:"You can't Agree and mark the same comment Offensive",cant_disagree_recommend:"You can't Disagree and Recommend the same comment",cant_recommend_offensive:"You can't Recommend and mark the same comment Offensive",permission_facebook:"You can't post to facebook. Post permission is required.",offensive_reason:"Please select a reason.",offensive_reason_text:"Please enter a reason.",offensive_reason_text_limit:"Please enter less than 200 chars."}};
var times_comments=comments;comments.config=util.extend(true,{},comments.config,default_config,module.config());times_comments.prototype.updateConfig=function(update_config){};var commentType=comments.config.commentType;times_comments.prototype.initialize=function(){var tthis=this;this.config=util.extend(true,{},comments.config,module.config(),this.config);tthis.comments=[];tthis.commentCount=0;tthis.countPresent=false;tthis.pageCount=1;tthis.config.comment_block_count=tthis.config.comment_block_count||25;
tthis.config.commentType=tthis.config.commentType||commentType;tthis.config.attachReplyAction=tthis.config.attachReplyAction!==false;tthis.config.attachOpinionAction=tthis.config.attachOpinionAction!==false;if(tthis.config.disabledirectcomment){$(tthis.config.wrapper+' [data-plugin="comment-form"]').hide()}if(login.getUser()){$(tthis.config.wrapper+" [data-plugin='user-isloggedin']").show();$(tthis.config.wrapper+" [data-plugin='user-notloggedin']").hide()}else{$(tthis.config.wrapper+" [data-plugin='user-isloggedin']").hide();
$(tthis.config.wrapper+" [data-plugin='user-notloggedin']").show()}if(!tthis.config.nonloggedinComment&&tthis.pageCount===1){$(tthis.config.wrapper+' [data-plugin="user-notloggedin"]').remove()}tthis.config.opinions=[{name:"Agree",id:"agree"},{name:"Disagree",id:"disagree"},{name:"Recommend",id:"recommended"},{name:"Offensive",id:"offensive"}];if(tthis.config.attachOpinionAction===true){tthis.attachOpinionAction()}if(tthis.config.attachReplyAction===true){tthis.attachReplyAction()}this.getData(function(data,commentCount){tthis.renderCommentCount(commentCount||(data?data.length:0));
if(data&&data.length>0){tthis.renderNoComment(false);tthis.render(data)}else{tthis.renderNoComment(true)}tthis.verifyEmailComment()});(function(tthis){event.subscribe("window.scroll",function(){var config=tthis.getConfig();if(tthis.config.loadonscroll===true&&tthis.isLoading===0&&ui.inView(tthis.config.wrapper+" #"+tthis.config.commentType+" [data-plugin='comment']:visible:last",true,200)){tthis.loadComment(tthis.config.commentType,function(data){},true,++tthis.pageCount)}})})(tthis)};times_comments.run=function(config){this.config=util.extend(true,{},comments.config,module.config());
var msid=config&&config.msid?config.msid:window.msid;var main=config&&config.main?config.main:"#"+this.config.commentType;var wrapper=config&&config.wrapper?config.wrapper:this.config.wrapper;var toi_comment={};toi_comment[this.config.commentType]=new comments({main:main,msid:msid,wrapper:wrapper});toi_comment[this.config.commentType].initialize();$(wrapper+" #comment_sort").change(function(){var rootid=$(this).val(),id="comments"+(rootid&&rootid.length>0?"_"+rootid:""),sortLbl=rootid.length?rootid:"newest";
$(wrapper+" .comments-list").hide();$(wrapper+" #"+id).show();$(wrapper+".comment-section .noComment").hide();if(toi_comment[id]){toi_comment[id].updateAfterCommentsLoaded();toi_comment[id].attachReplyAction();toi_comment[id].attachOpinionAction();toi_comment[id].updateCachedRating()}else{toi_comment[id]=new comments({main:"#"+id,msid:msid,commentType:id,wrapper:wrapper});toi_comment[id].initialize()}event.publish("comment.sort",sortLbl);$(wrapper+" [data-plugin='comment-error-outer']").text("");
$(wrapper+" [data-plugin='comment-error']").text("");event.publish("comment_error")});toi_comment[this.config.commentType].processRating();(function(that){event.subscribe("user.status",function(){toi_comment[that.config.commentType].processRating(that)})}(this));event.subscribe("comments.loaded",function(commentObj){logger.log("comments.loaded:"+commentObj.config.commentType);commentObj.updateAfterCommentsLoaded();if(commentObj.config.hideResponses===true){commentObj.hideExtraResponses()}});event.subscribe("comments.loaded.none",function(commentObj){logger.log("comments.loaded.none:"+commentObj.config.commentType);
commentObj.updateAfterCommentsLoaded()});event.subscribe("login.error",function(err){if(err&&err.error){logger.error(err.error)}else{logger.error(err)}});return toi_comment};times_comments.prototype.processRating=function(){var user=login.getUser();if(!user){$(this.config.wrapper+" [data-plugin='comment-error-outer']").text("");$(this.config.wrapper+" [data-plugin='comment-error']").text("");event.publish("comment_error")}var commenttype="comments"+($(this.config.wrapper+" #comment_sort").length&&$(this.config.wrapper+" #comment_sort").val()!==""?"_"+$(this.config.wrapper+" #comment_sort").val():"");
if(user&&this&&this.config&&this.config.withrating){var savedComment=this.getSavedComment();var usr_data={};usr_data.userId=user.getId();usr_data.baseEntityId=0;usr_data.uniqueAppKey=this.config.withrating;usr_data.appKey=page.getChannel();$.getJSON("https://myt.indiatimes.com/mytimes/alreadyRated?callback=?",usr_data,function(data){event.publish("comments.user_has_rated",data);if(window.msid==this.config.msid&&this.getSavedComment()){data=(data&&data!="")?data:" ";savedComment.urs=data;this.saveComment(savedComment);
this.loadSavedComment()}})}this.markFollowingAll()};times_comments.prototype.attachUserToComment=function(commentObj,user){logger.log("Attaching user to comment");commentObj.user={id:user.getId(),uid:user.getId()?user.getUid():"",name:user.getFullName(),username:user.getUsername(),location:user.getCITY(),image:user.getThumb(),email:user.getEmail()}};times_comments.prototype.hideExtraResponses=function(){var ttthis=this;$($(this.config.wrapper+" #"+this.config.commentType+" .comment-box.level1").get().reverse()).each(function(i,v){var tc=$(this);
var tc_level=tc.data("level");var tc_next=tc.next();if(is.numberOnly(tc_next.data("level"))){var response_cnt=0;while((tc_next.data("level")!=tc_level)&&(tc_next.is(":hidden"))&&(i<ttthis.config.comment_block_count)){if(response_cnt==ttthis.config.maxResponseCount){tc_next.before('<div class="show_all_responses comment-box level'+(tc_level+1)+'" data-level="'+tc_level+'" data-action="all_responses"> Show all responses </div>');break}else{tc_next.slideDown();tc_next=tc_next.next();if(!is.numberOnly(tc_next.data("level"))){break
}}response_cnt++}}})};times_comments.prototype.updateAfterCommentsLoaded=function(){var commentObj=this;if(this.pageCount===1){if(commentObj.config.commentType===this.config.commentType){if(commentObj.comments.length>0){logger.log("updateAfterCommentsLoaded : comments.loaded:"+commentObj.config.commentType);$(commentObj.config.wrapper+".comment-section .sortby").show()}else{logger.log("updateAfterCommentsLoaded : comments.loaded.none:"+commentObj.config.commentType);$(commentObj.config.wrapper+".comment-section .sortby").hide();
$(commentObj.config.wrapper+".comment-section .noComment").text("Be the first one to review.").show()}}if(commentObj.countPresent!==true){logger.log("updateAfterCommentsLoaded : countPresent:false:"+commentObj.config.commentType);if(commentObj.comments.length===0){$(commentObj.config.wrapper+".comment-section .noComment").text("Be the first one to review.").show()}else{if(commentObj.config.commentType==="comments_discussed"){$(commentObj.config.wrapper+".comment-section .noComment").text("None of the comments have been discussed.").show()
}else{if(commentObj.config.commentType==="comments_agree"){}else{if(commentObj.config.commentType==="comments_disagree"){$(commentObj.config.wrapper+".comment-section .noComment").text("None of the comments have been down voted.").show()}}}}}}};times_comments.prototype.renderCommentCount=function(count){var tthis=this;function displayCount(type,cnt){$(tthis.config.wrapper+" [data-plugin='comment-count"+(type?"-"+type:"")+"']").text(cnt?cnt:"0");event.publish("comment.count",(cnt?cnt:"0"))}if(is.object(count)){displayCount("",count.newest);
displayCount("oldest",count.oldest);displayCount("recommended",count.recommended);displayCount("discussed",count.discussed);displayCount("agree",count.agree);displayCount("disagree",count.disagree)}else{displayCount("",count)}};times_comments.prototype.loadComment=function(commentType,callback,append,curpg){var tthis=this;if(tthis.config.loadCommentFromMytimes==true){tthis._loadCommentMytimes(commentType,function(data){tthis.render(data,callback,append)},curpg)}else{tthis._loadComment(commentType,function(data){tthis.render(data,callback,append)
},curpg)}};times_comments.prototype.getData=function(callback){var tthis=this;if(tthis.config.loadCommentFromMytimes==true){this._loadCommentMytimes(this.config.commentType,callback)}else{this._loadComment(this.config.commentType,callback)}};times_comments.prototype._loadComment=function(commentType,callback,curpg){var tthis=this;var config=tthis.config;tthis.loading();logger.log("loading comments: "+config.msid);api.api(commentType,{msid:config.msid,curpg:curpg||1},function(comments_data){logger.log("loaded comments: "+config.msid);
var commentsD=comments_data.articlecomment||comments_data.new_cmtofart2_nit||comments_data.new_cmtofart2_nit_v1||comments_data.articleshow_othcmtofart||comments_data.new_cmtofart2_nit_sub_dev||(comments_data.mytuserdata?comments_data:null);var userData=commentsD.mytuserdata&&commentsD.mytuserdata.array?(is.array(commentsD.mytuserdata.array)?commentsD.mytuserdata.array:[commentsD.mytuserdata.array]):null;var commentsData=commentsD.rothrd&&commentsD.rothrd.op?(is.array(commentsD.rothrd.op)?commentsD.rothrd.op:[commentsD.rothrd.op]):null;
if(!commentsData||commentsData.length==0){tthis.loadedAll();callback([]);return null}tthis.flagData=commentsData[0];var commentCount={total:commentsD.rothrd.opctr,newest:commentsD.rothrd.opctr,oldest:commentsD.rothrd.opctr,recommended:commentsD.rothrd.recommendcount,discussed:commentsD.rothrd.opctrtopcnt,disagree:commentsD.rothrd.disagreecount,agree:commentsD.rothrd.agreecount};var commentPageCount={comments:Math.ceil(commentsD.rothrd.opctrtopcnt/config.comment_block_count),comments_oldest:Math.ceil(commentsD.rothrd.opctrtopcnt/config.comment_block_count),comments_recommended:Math.ceil(commentsD.rothrd.recommendcount/config.comment_block_count),comments_discussed:Math.ceil(commentsD.rothrd.opctrtopcnt/config.comment_block_count),comments_disagree:Math.ceil(commentsD.rothrd.disagreecount/config.comment_block_count),comments_agree:Math.ceil(commentsD.rothrd.agreecount/config.comment_block_count)};
var users=[];var i=0;if(userData){for(i=0;i<userData.length;i++){users.push(userData[i].sso)}}var commentsResult=[];for(var c=0;c<commentsData.length;c++){var cmt=commentsData[c];var user=userData?userData[users.indexOf(cmt.roaltdetails.fromaddress)]:null;var optext=cmt.optext;optext=(typeof optext==="object")&&optext.hasOwnProperty("content")?String(optext.content):optext;var comment={index:++tthis.commentCount,id:cmt.messageid,comment:is.string(optext)?$("<div/>").text(optext).html():"",level:cmt.level,childcount:cmt.CHILD?cmt.CHILD.length:0,parentuid:cmt.parentuid,parentusername:cmt.parentusername,time:cmt.rodate?util.getDate(cmt.rodate).getTime():"",abstime:cmt.rodate,opinion:(function(cmt){var opinions=[];
if(tthis.config.opinions){for(var o=0;o<tthis.config.opinions.length;o++){opinions.push({name:tthis.config.opinions[o].name,id:tthis.config.opinions[o].id,count:cmt[tthis.config.opinions[o].id]})}}return opinions.length>0?opinions:null}(cmt)),user:{id:user&&user._id?user._id:cmt.roaltdetails.fromname,username:user?user.D_N_U:null,name:cmt.roaltdetails.fromname||(user&&user.FL_N?user.FL_N:""),location:user&&user.CITY&&!is.object(user.CITY)&&!is.empty(user.CITY)?user.CITY:(!is.empty(cmt.roaltdetails.location)&&!is.object(cmt.roaltdetails.location)?cmt.roaltdetails.location:null),image:user&&user.thumb?user.thumb:cmt.roaltdetails.imageurl,email:user?user.sso:"",rate:cmt.roaltdetails.urs,followers:user?user.F_C:0,follower_text:(user?user.F_C:0)>1?("("+user.F_C+" followers)"):((user?user.F_C:"")>0?"("+user.F_C+" follower)":""),points:user&&user.reward&&user.reward.user&&user.reward.user.statusPoints?user.reward.user.statusPoints:null,pointslevel:user&&user.reward&&user.reward.user&&user.reward.user.levelName?user.reward.user.levelName:null,pointsNeeded:(function(user){var points_needed="";
var user_points=user&&user.reward&&user.reward.user&&user.reward.user.statusPoints?user.reward.user.statusPoints:null;if(user_points==null||user_points<250){points_needed=250-user_points}else{if(user_points>249&&user_points<5000){points_needed=5000-user_points}else{if(user_points>4999&&user_points<25000){points_needed=25000-user_points}else{if(user_points>24999&&user_points<250000){points_needed=250000-user_points}}}}return points_needed}(user)),badge:(function(user){var badges=[];if(user&&user.rewardpoint&&user.rewardpoint.userbadges&&user.rewardpoint.userbadges.activityBadge){var activityBadge=user.rewardpoint.userbadges.activityBadge;
if(!is.array(activityBadge)){activityBadge=[activityBadge]}for(var d=0;d<activityBadge.length;d++){var badge=activityBadge[d].currentBadge;badges.push({name:badge.bname,count:badge.level,image:badge.bimg,desc:badge.desc,levelDesc:util.decodeHTML(badge.levelDesc)})}}return badges.length>0?badges:null}(user))}};commentsResult.push(comment);logger.log("Parsed comment "+c)}tthis.comments=tthis.comments.concat(commentsResult);logger.log("rendering  "+commentsResult.length+" comments");callback(commentsResult,commentCount);
logger.log("rendered "+commentsResult.length+" comments");tthis.loaded();var curpgn=curpg||1;if(tthis.config.loadonscroll==false&&!commentsResult||!(curpgn<commentPageCount[tthis.config.commentType])){tthis.loadedAll()}else{if(tthis.config.loadonscroll==true&&!commentsResult||commentsResult.length==0){tthis.loadedAll()}}});return null};times_comments.prototype.parseComment=function(cmt,commentsResult,level){var ttthis=this;var user=cmt.user_detail||{FL_N:cmt.A_D_N||cmt.F_NAME,CITY:cmt.CITY};user.reward={user:cmt.user_reward};
user.rewardpoint={userbadges:cmt.user_reward_point_info};user.rate=cmt&&cmt.U_R?cmt.U_R:"";var tthis=this;level=level||1;var comment={index:++tthis.commentCount,id:cmt.A_U_I,comment:is.string(cmt.C_T)?$("<div/>").html(cmt.C_T).text():"",trimcom:(function(cmt){var t_c=is.string(cmt.C_T)?$("<div/>").html(cmt.C_T).text():"";return util.trimText(t_c,ttthis.config.maxCommentWrapLength)}(cmt)),authrid:(cmt.C_A_ID?cmt.C_A_ID:""),level:level,parentuid:cmt.O_ID,childcount:cmt.CHILD?cmt.CHILD.length:0,parentusername:cmt.O_D_N||cmt.F_NAME,time:(cmt.A_DT?util.getDate(parseInt(cmt.A_DT,10)).getTime():""),abstime:cmt.A_DT?util.getDate(parseInt(cmt.A_DT,10)).format("DD MMM, YYYY HH:mm A"):"",opinion:(function(cmt){var opinions=[];
opinions.push({name:"Agree",id:"AC_A_C",count:(cmt.AC_A_C)?cmt.AC_A_C:0});opinions.push({name:"Disagree",id:"AC_D_C",count:(cmt.AC_D_C)?cmt.AC_D_C:0});opinions.push({name:"Recommend",id:"AC_R_C",count:(cmt.AC_R_C)?cmt.AC_R_C:0});opinions.push({name:"Offensive",id:"AC_O_C",count:(cmt.AC_O_C)?cmt.AC_O_C:0});return opinions.length>0?opinions:null}(cmt)),user:{id:user&&user._id?user._id:null,username:user&&user.D_N_U?user.D_N_U:null,name:user&&user.FL_N?user.FL_N:"",location:user&&user.CITY&&!is.object(user.CITY)&&!is.empty(user.CITY)&&(user.CITY!="Unknown")?user.CITY:null,image:user&&user.thumb?user.thumb:"",email:user&&user.sso?user.sso:"",rate:user&&user.rate?user.rate:"",followers:user&&user.F_C?user.F_C:0,follower_text:(user?user.F_C:0)>1?("("+user.F_C+" followers)"):((user?user.F_C:"")>0?"("+user.F_C+" follower)":""),points:user&&user.reward&&user.reward.user&&user.reward.user.statusPoints?user.reward.user.statusPoints:null,pointslevel:user&&user.reward&&user.reward.user&&user.reward.user.levelName?user.reward.user.levelName:null,pointsNeeded:(function(user){var points_needed="";
var user_points=user&&user.reward&&user.reward.user&&user.reward.user.statusPoints?user.reward.user.statusPoints:null;if(user_points==null||user_points<250){points_needed=250-user_points}else{if(user_points>249&&user_points<5000){points_needed=5000-user_points}else{if(user_points>4999&&user_points<25000){points_needed=25000-user_points}else{if(user_points>24999&&user_points<250000){points_needed=250000-user_points}}}}return points_needed}(user)),badge:(function(user){var badges=[];if(user&&user.rewardpoint&&user.rewardpoint.userbadges&&user.rewardpoint.userbadges.activityBadge){var activityBadge=user.rewardpoint.userbadges.activityBadge;
if(!is.array(activityBadge)){activityBadge=[activityBadge]}for(var d=0;d<activityBadge.length;d++){var badge=activityBadge[d].currentBadge;badges.push({name:badge.bname,count:badge.level,image:badge.bimg,desc:badge.desc,levelDesc:util.decodeHTML(badge.levelDesc)})}}return badges.length>0?badges:null}(user))}};commentsResult.push(comment);if(cmt.CHILD){for(var cmtChild in cmt.CHILD){tthis.parseComment(cmt.CHILD[cmtChild],commentsResult,level+1)}}};times_comments.prototype._loadCommentMytimes=function(commentType,callback,curpg){var tthis=this;
var config=tthis.config;tthis.loading();logger.log("loading comments: "+config.msid);api.api(commentType,{msid:config.msid,pagenum:curpg||1},function(comments_data){logger.log("loaded comments: "+config.msid);var commentsData=comments_data;if(!commentsData||commentsData.length==0){tthis.loadedAll();callback([]);return null}tthis.flagData=commentsData[0];var commentCount={total:commentsData[0].totalcount,newest:commentsData[0].totalcount,oldest:commentsData[0].totalcount,recommended:commentsData[0].totalcount,discussed:commentsData[0].totalcount,disagree:commentsData[0].totalcount,agree:commentsData[0].totalcount};
var commentPageCount={comments:Math.ceil(commentCount.newest/config.comment_block_count),comments_oldest:Math.ceil(commentCount.oldest/config.comment_block_count),comments_recommended:Math.ceil(commentCount.recommended/config.comment_block_count),comments_discussed:Math.ceil(commentCount.discussed/config.comment_block_count),comments_disagree:Math.ceil(commentCount.disagree/config.comment_block_count),comments_agree:Math.ceil(commentCount.agree/config.comment_block_count)};var commentsResult=[],priorityComments=[];
if(commentsData&&commentsData[0]["priorityComment"]&&commentsData[0]["priorityComment"].length>0){var cmnts=commentsData[0]["priorityComment"];for(var c=0;c<cmnts.length;c++){var cmt=cmnts[c];var reason=null;if(cmt.DLT==1){reason="DLT fail"}else{if(is.empty(cmt.C_T)){reason="Blank fail"}}if(reason){logger.log("Not Parsed "+reason+" comment "+c)}else{tthis.parseComment(cmt,priorityComments);logger.log("Parsed comment "+c)}}}for(var c=1;c<commentsData.length;c++){var cmt=commentsData[c];var reason=null;
if(cmt.DLT==1){reason="DLT fail"}else{if(is.empty(cmt.C_T)){reason="Blank fail"}}if(reason){logger.log("Not Parsed "+reason+" comment "+c)}else{tthis.parseComment(cmt,commentsResult);logger.log("Parsed comment "+c)}}tthis.countPresent=commentsData[0].countPresent||false;tthis.comments=tthis.comments.concat(commentsResult);tthis.priorityComments=priorityComments;logger.log("rendering  "+commentsResult.length+" comments");callback(commentsResult,commentCount);logger.log("rendered "+commentsResult.length+" comments");
tthis.loaded();var curpgn=curpg||1;if(tthis.config.loadonscroll==false&&!commentsResult||!(curpgn<commentPageCount[tthis.config.commentType])){tthis.loadedAll()}else{if(tthis.config.loadonscroll==true&&!commentsResult||commentsResult.length==0){tthis.loadedAll()}}});return null};function replaceAll(find,replace,str){return str.replace(new RegExp(find,"g"),replace)}var domain="http://jcmsdev.indiatimes.com";var getUsers=function(data){var ssoids={};for(var i=0;i<data.length;i++){ssoids[(data[i].roaltdetails.fromaddress)]={}
}return ssoids};times_comments.prototype.postToSocial=function(message,sites,closeCallback){var tthis=this;var domainOnly=util.getDomainOnly();var user=login.getUser();window.newShare=true;window.newShareData={sites:sites,message:message,link:window.facebooklink||page.getMeta("og:url"),title:window.facebookktitle||page.getMeta("og:title"),domain:window.location.host,picture:window.fb_Img||page.getMeta("og:image"),desc:window.facebooksyn||page.getMeta("og:description"),facebook:user?user.facebook:null,twitter:user?user.twitter:null};
if(-1!=window.newShareData.sites.indexOf("facebook")){if(typeof FB=="undefined"){require(["tiljs/social/facebook","tiljs/event"],function(facebook,event){facebook.init({init:true,parse:true});event.subscribe("FB.onload",function(data){tthis.postToFB(window.newShareData)})})}else{tthis.postToFB(window.newShareData)}sites=sites.replace(/facebook,|facebook/g,"");window.newShareData.sites=sites}if(!sites.length){return true}var url=tthis.config.share_url+"?sites="+sites;var socialPost=ui.window(url,{width:600,height:230,name:"socialPost",closeCallback:closeCallback});
if(socialPost){try{socialPost.moveTo(250,240)}catch(e){logger.log("Handled IE Exception.");logger.error(e)}}else{logger.error("Popups are blocked. Please enable them.")}};times_comments.prototype.postToFB=function(data){FB.ui({method:"feed",message:data.message,name:data.title,link:data.link,picture:data.picture,caption:data.domain,description:data.desc})};times_comments.prototype.postToTwitter=function(message,closeCallback){var domainOnly=util.getDomainOnly();if(message.length>100){message=message.substring(0,99)+"..."
}window.log=window.log||function(){};window.popupblocked=0;cookie.remove("fbcheck","/",domainOnly);cookie.remove("twtcheck","/",domainOnly);cookie.set("twtcheck","1",1,"/",domainOnly);cookie.set("usercomt",message,1,"/",domainOnly);var url="/stgredirectpagetest.cms";var twitterPost=ui.window(url,{width:600,height:230,name:"twitterPost",closeCallback:closeCallback});if(twitterPost){twitterPost.moveTo(250,240)}else{window.popupblocked=1;if(is.desktop()){twitterPost=ui.iframe(url,{width:575,height:314,name:"twitterPost",closeCallback:closeCallback})
}else{alert("Popups are blocked. Please enable them.")}}};times_comments.prototype.postToFacebook=function(message,closeCallback){var domainOnly=util.getDomainOnly();var tthis=this;if(window.localStorage){localStorage.setItem("usercomt",message)}window.log=window.log||function(){};window.popupblocked=0;cookie.remove("fbcheck","/",domainOnly);cookie.remove("twtcheck","/",domainOnly);cookie.set("fbcheck","1",1,"/",domainOnly);cookie.set("usercomt",message,1,"/",domainOnly);var url="/stgredirectpagetest.cms";
var facebookPost=ui.window(url,{width:600,height:230,name:"facebookPost",closeCallback:closeCallback});if(facebookPost){facebookPost.moveTo(250,240)}else{window.popupblocked=1;if(is.desktop()){facebookPost=ui.iframe(url,{width:575,height:314,name:"facebookPost",closeCallback:closeCallback})}else{alert("Popups are blocked. Please enable them.")}}};times_comments.prototype.attachOpinionAction=function(){logger.log("Attaching Opinion Action");var tthis=this;var opinions=this.config.opinions;for(var o=0;
o<opinions.length;o++){var opinion=opinions[o];(function(opinion){$(tthis.config.wrapper).off("click","[data-action='comment-"+opinion.id+"']");$(tthis.config.wrapper).on("click","[data-action='comment-"+opinion.id+"']",function(){var ref=ui.getActionReferences(this,tthis.config.comment);var parent=ref.parent;var opinionid=parent.attr("data-id");(function(tthis,parent,opinion,ref){tthis["rate"+opinion.name](opinionid,function(errMsg){if(errMsg){tthis.error(errMsg,ref["comment-error-outer"])}else{tthis.error("",ref["comment-error-outer"]);
var count_ele=parent.find("[data-plugin='comment-"+opinion.id+"-count']");var currentCount=parseInt(count_ele.text(),10);$(count_ele).text(++currentCount)}},ref)}(tthis,parent,opinion,ref));event.publish("comment.opinion",opinion.id);return false})}(opinion))}$(tthis.config.wrapper).off("focus",'[data-plugin="comment-input"]');$(tthis.config.wrapper).on("focus",'[data-plugin="comment-input"]',function(){var ref=ui.getActionReferences(this,tthis.config.comment);if(ref["comment-form"]&&!ref["comment-form"].hasClass("full")){ref["comment-form"].addClass("full")
}else{if(ref["comment-reply"]&&!ref["comment-reply"].hasClass("full")){ref["comment-reply"].addClass("full")}}setcaptcha(ref)});$(tthis.config.wrapper).off("focus","[data-plugin='get-user-name']");$(tthis.config.wrapper).on("focus","[data-plugin='get-user-name']",function(){var ref=ui.getActionReferences(this,tthis.config.comment);if(ref["comment-form-login"]){ref["comment-form-login"].removeClass("noreg");setcaptcha(ref)}});$(tthis.config.wrapper).on("mouseover",".badges .more-btn",function(event){var elemTop=$(event.target).closest(".comment-box").position().top+$(event.target).closest(".comment-box").closest(".comment-box").height(),elemH=$(event.target).find(".popup_badge").height(),wH=$(window).height(),commentScrollPos=0;
$(event.target).find(".popup_badge").removeClass("popup_above");if(((elemTop-commentScrollPos)+elemH)>wH){$(event.target).find(".popup_badge").addClass("popup_above")}$(event.target).find(".popup_badge").show()});$(tthis.config.wrapper).on("mouseout",".badges .more-btn",function(event){$(event.target).find(".popup_badge").hide()});function setcaptcha(ref){var $set_user_captcha=ref["set-user-captcha"];if($set_user_captcha&&$set_user_captcha.text().length==0){$set_user_captcha.text(Math.floor((Math.random()*10))+"+"+Math.floor((Math.random()*10))+"=")
}}$(tthis.config.wrapper).off("click","[data-action='offensive_popup_submit']");$(tthis.config.wrapper).on("click","[data-action='offensive_popup_submit']",function(){var ref=ui.getActionReferences(this,tthis.config.comment);var opinionid=ref.parent.attr("data-id");var reason=null;reason=ref.offensive_popup.find("input:checked").val();if(!reason){tthis.error(tthis.config.messages.offensive_reason,ref["comment-offensive-error"])}else{if(reason=="Others"){var reasonVal=ref.offensive_popup_reason.val().trim();
if(!reasonVal||reasonVal==""){tthis.error(tthis.config.messages.offensive_reason_text,ref["comment-offensive-error"]);reason=null}else{if(reasonVal.length>200){tthis.error(tthis.config.messages.offensive_reason_text_limit,ref["comment-offensive-error"]);reason=null}else{reason="Others: "+reasonVal}}}}if(reason){tthis.rate(opinionid,CONSTANT.RATE_TYPE.OFFENSIVE,0,function(error,resp){if(error){tthis.error(error,ref["comment-offensive-error"])}else{if(!error&&ref.parent){ref.offensive_popup.addClass("submitted")
}}},ref,reason)}});$(tthis.config.wrapper).off("click","[data-action='offensive_popup_close']");$(tthis.config.wrapper).on("click","[data-action='offensive_popup_close']",function(){var ref=ui.getActionReferences(this,tthis.config.comment);if(ref.offensive_popup&&ref.offensive_popup.hasClass("submitted")){ref.parent.find("[data-action='comment-offensive-already']").show();ref.parent.find("[data-action='comment-offensive']").hide()}ref.offensive_popup.hide();return false})};times_comments.prototype.attachReplyAction=function(){logger.log("Attaching Reply Action");
var tthis=this;$(tthis.config.wrapper).off("click","[data-action='all_responses']");$(tthis.config.wrapper).on("click","[data-action='all_responses']",function(){var tc_level=$(this).data("level"),tc_next=$(this).next();while(tc_next.data("level")!=tc_level){tc_next.slideDown();tc_next=tc_next.next();if(!is.numberOnly(tc_next.data("level"))){break}}$(this).remove()});$(tthis.config.wrapper).off("click","[data-action='more-response-length']");$(tthis.config.wrapper).on("click","[data-action='more-response-length']",function(){$(this).parent().hide();
$(this).parent().next().show();event.publish("comment.readmore")});$(tthis.config.wrapper).off("click","[data-action='comment-reply']");$(tthis.config.wrapper).on("click","[data-action='comment-reply']",function(){var ref=ui.getActionReferences(this,tthis.config.comment);var parent=ref.parent;if(ref["comment-reply"]){ref["comment-reply"].show();if(is.defined(tthis.config.rating)&&tthis.config.rating){if(userInfo.userRating!=null&&userInfo.userRating!=undefined&&userInfo.userRating!=""){$(tthis.config.wrapper+" [data-plugin='comment-rating']").val($(tthis.config.wrapper+" [data-plugin='rating-list'] [data-plugin='rating-vaue'][val="+userInfo.userRating+"]").html())
}}}else{var commentForm=$(tthis.config.wrapper+" [data-plugin='comment-form']");var commentFormHTML=$("<div>"+commentForm.html()+"</div>");commentFormHTML.find("[data-clear='true']").remove();var tmpl=$.templates("<div class='"+commentForm.attr("class")+" reply' data-plugin='comment-reply'>"+commentFormHTML.html()+"</div>");parent.append(tmpl.render([{}]));if(is.defined(tthis.config.rating)&&tthis.config.rating){if(userInfo.userRating!=null&&userInfo.userRating!=undefined&&userInfo.userRating!=""){$(tthis.config.wrapper+" [data-plugin='comment-rating']").val($(tthis.config.wrapper+" [data-plugin='rating-list'] [data-plugin='rating-vaue'][val="+userInfo.userRating+"]").html())
}}}ref=ui.getActionReferences(this,tthis.config.comment);tthis.error("",ref["comment-error"]);$("[placeholder]").blur();return false});$(tthis.config.wrapper).off("click","[data-action='toggle_replies']");$(tthis.config.wrapper).on("click","[data-action='toggle_replies']",function(){var t=$(this);var tc=t.closest(".comment-box");var tc_level=tc.data("level");var tc_next=tc.next();var tstatus=t.attr("data-togglereplies");if(is.numberOnly(tc_next.data("level"))&&tstatus=="show"){event.publish("comment.togglereplies","Show");
t.attr("data-togglereplies","hide");var response_cnt=0;while(tc_next.data("level")!=tc_level){if(response_cnt==3){tc_next.before('<div class="show_all_responses comment-box level'+(tc_level+1)+'" data-level='+tc_level+' data-action="all_responses"> Show all responses </div>');break}else{tc_next.slideDown();tc_next=tc_next.next();if(!is.numberOnly(tc_next.data("level"))){break}}response_cnt++}}else{event.publish("comment.togglereplies","Hide");t.attr("data-togglereplies","show");$(".show_all_responses").remove();
while(tc_next.data("level")!=tc_level){tc_next.slideUp();tc_next=tc_next.next();if(!is.numberOnly(tc_next.data("level"))){break}}}});$(tthis.config.wrapper).off("click",".loadmore");$(tthis.config.wrapper).on("click",".loadmore",function(){$(this).remove();if(tthis.config.loadonscroll==false){tthis.loadComment(tthis.config.commentType,function(data){},true,++tthis.pageCount)}});$(tthis.config.wrapper).off("keyup","[data-plugin='comment-input']");$(tthis.config.wrapper).on("keyup","[data-plugin='comment-input']",function(e){if(e.keyCode===27){var ref=ui.getActionReferences(this,tthis.config.comment);
ref["comment-input"].val("");ref["comment-reply"].hide()}});ui.maxlength("[data-plugin='comment-input']",tthis.config.maxchar,function(remainingChar,messageLength){var ref=ui.getActionReferences(this,tthis.config.comment);var parent=ref.parent;var charsrem=ref["comment-input-remaining"];var charsInput=ref["comment-input-remaining-prime"];if(charsrem){charsrem.text(remainingChar>=0?remainingChar:0)}if(charsInput){charsInput.text(remainingChar>=0?(tthis.config.maxchar-remainingChar):tthis.config.maxchar)
}if(tthis.config.messages.maxlength&&messageLength>tthis.config.maxchar){tthis.error(tthis.config.messages.maxlength,ref["comment-error"])}else{tthis.error("",ref["comment-error"])}},tthis.config.wrapper);$(tthis.config.wrapper).off("click","[data-action='comment-close']");$(tthis.config.wrapper).on("click","[data-action='comment-close']",function(){var ref=ui.getActionReferences(this,tthis.config.comment);var reply=ref["comment-reply"];var input=ref["comment-input"];var charsrem=ref["comment-input-remaining"];
var charsInput=ref["comment-input-remaining-prime"];if(charsrem){charsrem.text(tthis.config.maxchar)}if(charsInput){charsInput.text(0)}ref["comment-post"].removeClass("active");input.val("");reply.hide();tthis.error("",ref["comment-error"]);return false});tthis.onLoaded(function(tthis){tthis.updateCachedRating();var user=login.getUser();if(tthis.followee){tthis.markFollowingAll()}else{if(user){mytimes.getFollowee(function(data){tthis.followee=data;tthis.markFollowingAll()})}}lazy.load();dynamic.uptime()
});$(tthis.config.wrapper).off("click","[data-plugin='comment-user-follow']");$(tthis.config.wrapper).on("click","[data-plugin='comment-user-follow']",function(){var currentEle=$(this);var currentUser=login.getUser();var ref=ui.getActionReferences(this,tthis.config.comment);var userId=ref.parent.attr("data-userid");var userName=ref.parent.attr("data-user");if(currentUser&&currentUser.getId()!=userId){(function(userId,userName){mytimes.followUser(userId,function(dataa){tthis.followee=tthis.followee||[];
var currFollowee={_id:userId,F_N:userName};tthis.followee.push(currFollowee);tthis.markFollowingId(currFollowee)})}(userId,userName))}else{logger.warn("Cannot follow self.")}});$(tthis.config.wrapper).off("click","[data-plugin='comment-post'],[data-plugin='comment-facebook-post'],[data-plugin='comment-twitter-post'],[data-plugin='comment-google-post'],[data-plugin='comment-email-post']");$(tthis.config.wrapper).on("click","[data-plugin='comment-post'],[data-plugin='comment-facebook-post'],[data-plugin='comment-twitter-post'],[data-plugin='comment-google-post'],[data-plugin='comment-email-post']",function(){event.publish("comment.post.start");
var ref=ui.getActionReferences(this,tthis.config.comment);var parent=ref.parent;var reply=ref["comment-reply"];var errorElement=ref["comment-error"];var reply_input=ref["comment-input"];var parentid=parent.attr("data-id");var parentlevel=parent.attr("data-level");var rootid=parent.attr("data-id");var rootlevel=parent.attr("data-level");var preventInfinite=10;var prevParent=parent;while(rootlevel>1&&--preventInfinite>0){prevParent=prevParent.prev();if(prevParent.attr("data-plugin")==="comment"){rootid=prevParent.attr("data-id");
rootlevel=prevParent.attr("data-level")}else{break}}tthis.error("",errorElement);var val=(reply_input.val()===reply_input.attr("placeholder"))?"":reply_input.val().trim();if(val){tthis.add(val,parentid,rootid,rootlevel,function(commentObj,errMsg){tthis.renderComment(commentObj,errMsg);event.publish("comment.post.end")},false,this)}else{event.publish("comment_error",tthis.config.messages.blank);if($(tthis.config.wrapper+" [data-plugin='comment-error']").length>1){$(this).parent().find("[data-plugin='comment-error']").text(tthis.config.messages.blank)
}else{$(tthis.config.wrapper+" [data-plugin='comment-error']").text(tthis.config.messages.blank)}}return false})};times_comments.prototype.markFollowingAll=function(){var tthis=this;var followees=tthis.followee;var comments=$(tthis.config.wrapper);var user=login.getUser();if(user){logger.info("Showing follow links");comments.find("[data-plugin='comment-user-follow_wrapper']").show();comments.find("[data-plugin='comment'][data-userid ='"+user.getId()+"'] [data-plugin='comment-user-follow_wrapper']").hide();
util.each(followees,function(i,followee){tthis.markFollowingId(followee)})}else{comments.find("[data-plugin='comment-user-follow_wrapper']").hide();logger.info("Follow links : Not logged in.")}};times_comments.prototype.markFollowingId=function(followee){var tthis=this;var user=login.getUser();var comments=$(tthis.config.wrapper);if(user){var foloweeEle=comments.find("[data-userid='"+followee._id+"'] .follow");if(foloweeEle&&foloweeEle.length>0){logger.info("Mark Following : "+user.getFullName()+"("+user.getId()+") >> "+followee.F_N+"("+followee._id+")");
tthis.markFollowing(foloweeEle)}else{logger.info("Mark Following : "+user.getFullName()+"("+user.getId()+") >> "+followee.F_N+"("+followee._id+")  - NA")}}else{logger.info("Follow link : Not logged in.")}};times_comments.prototype.markFollowing=function(currentEle){if(currentEle&&currentEle.length>0){currentEle.html("<span class='divider'></span><i class='icon-follow'></i>Following");currentEle.removeClass("follow");currentEle.addClass("following");currentEle.removeAttr("data-plugin");currentEle.attr("title",currentEle.attr("title").replace("Follow","Following"))
}};times_comments.prototype.onLoaded=function(callback){event.subscribe("comments.loaded",callback)};var savedComment=null;times_comments.prototype.saveComment=function(comment){savedComment=comment;cookie.set("comment"+window.msid,json.stringify(comment),1,document.location.pathname)};times_comments.prototype.getSavedComment=function(){var commentCookie=cookie.get("comment"+window.msid);if(is.defined(commentCookie)){return json.parse(commentCookie)}else{if(savedComment){return savedComment}else{return null
}}};times_comments.prototype.removeSavedComment=function(){savedComment=null;return cookie.remove("comment"+window.msid,document.location.pathname)};times_comments.prototype.loadSavedComment=function(){var tthis=this;var user=login.getUser();var savedComment=tthis.getSavedComment();if(savedComment){if(user){if(!tthis.config.rating||savedComment.urs!=""){savedComment.urs=tthis.config.rating?$.trim(savedComment.urs):"";logger.log("Has saved comment and user is logged in.");logger.log(savedComment);
tthis.attachUserToComment(savedComment,user);tthis.removeSavedComment();tthis.post(savedComment,function(savedComment,errMsg){tthis.renderComment(savedComment,errMsg)})}}else{logger.log("Saved comment but user not logged in")}}else{logger.log("No Saved comment.")}};times_comments.prototype.verifyEmailComment=function(){var url_params=util.getParam();var tthis=this;tthis.verify(function(commentObj,errMsg){if(is.object(commentObj)){tthis.renderComment(commentObj,errMsg,true);$(tthis.config.wrapper+" [data-plugin='comment-verified-msg']").show();
tthis.removeSavedComment()}})};times_comments.prototype.saveRatingValidation=function(opinionid,typeid,rateid,val,ref){logger.log("Save Rating: "+this.config.commentType+":"+opinionid);var user=login.getUser();var userId=user?user.getId():0;var rating=["rateV",opinionid,typeid,rateid];localstoragec.set(rating.join(":"),val||"1",1,"/")};times_comments.prototype.getSavedRatingValidation=function(opinionid,typeid,rateid,ref){var user=login.getUser();var userId=user?user.getId():0;var rating=["rateV",opinionid,typeid,rateid];
var commentCookie=localstoragec.csget(rating.join(":"));if(is.defined(commentCookie)){return commentCookie}else{return null}};times_comments.prototype.updateCachedRating=function(){var tthis=this;var cookies=cookie.getAll();var comments=$(tthis.config.wrapper+" #"+this.config.commentType);util.each(cookies,function(key,value){if(key.indexOf("rateV")===0){logger.log("Updating Rating from cookie: "+key);var keyArr=key.split(":");var rating={opinionid:parseInt(keyArr[1],10),typeid:parseInt(keyArr[2],10),rateid:parseInt(keyArr[3],10),commentType:tthis.config.commentType};
var eleType="";switch(rating.typeid){case CONSTANT.RATE_TYPE.AGREE:eleType="comment-agree-count";break;case CONSTANT.RATE_TYPE.DISAGREE:eleType="comment-disagree-count";break}if(eleType!=""){var commentRateCount=comments.find("[data-id='"+rating.opinionid+"']  [data-plugin='"+eleType+"']");var val=parseInt(commentRateCount.text(),10);var cookieVal=parseInt(cookie.get(key),10);if(cookieVal>val){commentRateCount.text(cookieVal);logger.log("Updated Rating from cookie: "+key+" : "+val+" updated to "+cookieVal)
}else{logger.log(key+" Already Updated")}}}})};times_comments.prototype.validateRating=function(opinionid,typeid,rateid,ref,callback){logger.log("Validate Rating: "+opinionid);var config=this.config;var user=login.getUser();var savedRating=this.getSavedRatingValidation(opinionid,typeid,rateid,ref);if(ref){if(user&&ref.parent&&ref.parent.attr("data-userid")==user.getId()){switch(typeid){case CONSTANT.RATE_TYPE.AGREE:callback(config.messages.self_agree);break;case CONSTANT.RATE_TYPE.DISAGREE:callback(config.messages.self_disagree);
break;case CONSTANT.RATE_TYPE.RECOMMEND:callback(config.messages.self_recommend);break;case CONSTANT.RATE_TYPE.OFFENSIVE:callback(config.messages.self_offensive);break}}else{if(savedRating&&savedRating>0){switch(typeid){case CONSTANT.RATE_TYPE.AGREE:callback(config.messages.already_agree);break;case CONSTANT.RATE_TYPE.DISAGREE:callback(config.messages.already_disagree);break;case CONSTANT.RATE_TYPE.RECOMMEND:callback(config.messages.already_recommended);break;case CONSTANT.RATE_TYPE.OFFENSIVE:callback(config.messages.already_offensive);
break}}else{if(this.getSavedRatingValidation(opinionid,CONSTANT.RATE_TYPE.AGREE,rateid,ref)&&typeid==CONSTANT.RATE_TYPE.DISAGREE){callback(config.messages.cant_agree_disagree)}else{if(this.getSavedRatingValidation(opinionid,CONSTANT.RATE_TYPE.DISAGREE,rateid,ref)&&typeid==CONSTANT.RATE_TYPE.AGREE){callback(config.messages.cant_agree_disagree)}else{if(this.getSavedRatingValidation(opinionid,CONSTANT.RATE_TYPE.AGREE,rateid,ref)&&typeid==CONSTANT.RATE_TYPE.OFFENSIVE){callback(config.messages.cant_agree_offensive)
}else{if(this.getSavedRatingValidation(opinionid,CONSTANT.RATE_TYPE.OFFENSIVE,rateid,ref)&&typeid==CONSTANT.RATE_TYPE.AGREE){callback(config.messages.cant_agree_offensive)}else{if(this.getSavedRatingValidation(opinionid,CONSTANT.RATE_TYPE.DISAGREE,rateid,ref)&&typeid==CONSTANT.RATE_TYPE.RECOMMEND){callback(config.messages.cant_disagree_recommend)}else{if(this.getSavedRatingValidation(opinionid,CONSTANT.RATE_TYPE.RECOMMEND,rateid,ref)&&typeid==CONSTANT.RATE_TYPE.DISAGREE){callback(config.messages.cant_disagree_recommend)
}else{if(this.getSavedRatingValidation(opinionid,CONSTANT.RATE_TYPE.OFFENSIVE,rateid,ref)&&typeid==CONSTANT.RATE_TYPE.RECOMMEND){callback(config.messages.cant_recommend_offensive)}else{if(this.getSavedRatingValidation(opinionid,CONSTANT.RATE_TYPE.RECOMMEND,rateid,ref)&&typeid==CONSTANT.RATE_TYPE.OFFENSIVE){callback(config.messages.cant_recommend_offensive)}else{callback()}}}}}}}}}}}else{logger.error("Cannot validate rating. 'ref' is undefined.")}};times_comments.prototype.validateComment=function(commentObj,callback,ref){event.publish("comment.post.validating");
var comment=commentObj.comment;var config=this.config;logger.info("Validating Comment: "+comment);commentObj.urs=(commentObj.urs==="")?undefined:commentObj.urs;if(is.empty(comment)){callback(config.messages.blank)}else{if(is.url(comment)){callback(config.messages.has_url)}else{if(comment.length<config.validation.minlength){callback(config.messages.minlength)}else{if(is.defined(this.config.rating)&&this.config.rating&&(!is.defined(commentObj.urs))){callback(config.messages.ratemendate)}else{var msgObj=this.commentObjToMsgObj(commentObj);
msgObj.message=msgObj.message.toLowerCase();api.validateComment(msgObj,function(response){if(response==="duplicatecontent"){event.publish("comment.post.validation.failed",response);callback(config.messages.duplicate)}else{if(response==="abusivecontent"){event.publish("comment.post.validation.failed",response);callback(config.messages.abusive)}else{event.publish("comment.post.validated");callback()}}})}}}}};times_comments.prototype.add=function(msg,parentId,rootId,level,callback,cnsl,currentEle){logger.info("Adding Comment: "+msg);
var tthis=this;$(tthis.config.wrapper+" [data-plugin='comment-verified-msg']").hide();var config=this.getConfig();var user=login.getUser();var ref=ui.getActionReferences(currentEle,tthis.config.comment);var commentObj={index:-1,id:-1,comment:msg.trim(),level:level||1,parentId:parentId||0,rootId:rootId||0,parentuid:ref.parent?ref.parent.attr("data-id"):null,parentusername:ref.parent?ref.parent.attr("data-user"):null,type:currentEle?$(currentEle).attr("data-plugin"):"comment-post",time:new Date().getTime(),configid:"41083278",url:window.location.href.split("?")[0].split("#")[0],rotype:typeof tthis.config.rotype=="undefined"?0:tthis.config.rotype,urs:typeof userInfo==="object"?userInfo.userRating:""};
var facebookCheckbox=ref["comment-facebook"];var twitterCheckbox=ref["comment-twitter"];commentObj.social=[];if(facebookCheckbox&&facebookCheckbox.is(":checked")){commentObj.social.push("facebook")}if(twitterCheckbox&&twitterCheckbox.is(":checked")){commentObj.social.push("twitter")}if(!user){var cmtUser=(commentObj.type=="comment-post"?this.getCommentUser(ref):null);if(is.object(cmtUser)){user=cmtUser}else{if(cmtUser){return}}}if(user){tthis.attachUserToComment(commentObj,user);if(cnsl===true){if(callback){callback(commentObj)
}}else{tthis.post(commentObj,callback)}}else{switch(commentObj.type){case"comment-facebook-post":tthis.commentOnFacebook(commentObj,ref);break;case"comment-google-post":tthis.commentOnGoogle(commentObj,ref);break;case"comment-twitter-post":tthis.commentOnTwitter(commentObj,ref);break;case"comment-email-post":tthis.commentUsingEmail(commentObj,ref);break;default:tthis.commentWithoutLogin(commentObj,ref);break}}};times_comments.prototype.getCommentUser=function(ref){var config=this.config;var $get_user_name=ref["get-user-name"];
var $get_user_email=ref["get-user-email"];var $get_user_location=ref["get-user-location"];var $set_user_captcha=ref["set-user-captcha"];var $get_user_captcha=ref["get-user-captcha"];if($get_user_name&&$get_user_email&&$get_user_name.length>0&&$get_user_email.length>0){var user={};user.name=$get_user_name.val().trim();user.email=$get_user_email.val().trim();if($get_user_location&&$get_user_location.length>0){user.location=$get_user_location.val().trim()}if(user.name.length==0||user.name==$get_user_name.attr("placeholder")){this.error(config.messages.name_required,ref["comment-error"]);
return true}if(user.name.length>30){this.error(config.messages.name_toolong,ref["comment-error"]);return true}if(!is.alphaOnly(user.name)){this.error(config.messages.name_not_string,ref["comment-error"]);return true}if(user.email.trim().length==0||user.email==$get_user_email.attr("placeholder")){this.error(config.messages.email_required,ref["comment-error"]);return true}if(!is.email(user.email.trim())){this.error(config.messages.email_invalid,ref["comment-error"]);return true}if($get_user_location&&$get_user_location.length>0){if(user.location.length==0||user.location==$get_user_location.attr("placeholder")){this.error(config.messages.location_required,ref["comment-error"]);
return true}if(user.location.length>30){this.error(config.messages.location_toolong,ref["comment-error"]);return true}if(!is.alphaOnly(user.location)){this.error(config.messages.location_not_string,ref["comment-error"]);return true}}if($get_user_captcha&&$get_user_captcha.val().trim().length==0){this.error(config.messages.captcha_required,ref["comment-error"]);return true}if($get_user_captcha&&$get_user_captcha.val().trim().length>4){this.error(config.messages.captcha_toolong,ref["comment-error"]);
return true}if($get_user_captcha&&!is.numberOnly($get_user_captcha.val().trim())){this.error(config.messages.captcha_number_only,ref["comment-error"]);return true}if($set_user_captcha&&$get_user_captcha&&!eval($set_user_captcha.text()+"="+$get_user_captcha.val())){this.error(config.messages.captcha_invalid,ref["comment-error"]);return true}return userClass.getNewUser(user,{id:"id",username:"username",thumb:"thumb",email:"email",name:"name",fullName:"name",CITY:"location"})}};times_comments.prototype.commentOnFacebook=function(commentObj,ref){var tthis=this;
var domainOnly=util.getDomainOnly();tthis.saveComment(commentObj);cookie.set("clickkepfbtart","1",1,"/",domainOnly);cookie.set("clickkepfbtart"+window.msid,window.msid,1,"/",domainOnly);login.loginWithFacebook(function(){tthis.loadSavedComment()})};times_comments.prototype.commentOnGoogle=function(commentObj,ref){var tthis=this;tthis.saveComment(commentObj);login.loginWithGoogle(function(){tthis.loadSavedComment()})};times_comments.prototype.commentOnTwitter=function(commentObj,ref){var tthis=this;
var domainOnly=util.getDomainOnly();tthis.saveComment(commentObj);cookie.set("clickkeptwtart","1",1,"/",domainOnly);cookie.set("clickkeptwtart"+window.msid,window.msid,1,"/",domainOnly);login.loginWithTwitter(function(){tthis.loadSavedComment()})};times_comments.prototype.commentUsingEmail=function(commentObj,ref){var tthis=this;var domainOnly=util.getDomainOnly();tthis.saveComment(commentObj);cookie.set("clickkepssoart","1",1,"/",domainOnly);cookie.set("clickkepssoart"+window.msid,window.msid,1,"/",domainOnly);
login.login(function(){tthis.loadSavedComment()})};times_comments.prototype.commentWithoutLogin=function(commentObj,ref){var tthis=this;var domainOnly=util.getDomainOnly();tthis.saveComment(commentObj);cookie.set("clickkepssoart","1",1,"/",domainOnly);cookie.set("clickkepssoart"+window.msid,window.msid,1,"/",domainOnly);login.login(function(){if(!(tthis.config.rating)){tthis.loadSavedComment()}})};times_comments.prototype.verify=function(callback,ref){var tthis=this;var url=tthis.config.verify_comment_url;
var msgObj={msid:window.msid,cmtid:null,r:null};var url_params=util.getParam();if(window.messageid&&window.param_r){msgObj.cmtid=window.messageid;msgObj.r=window.param_r}else{msgObj.cmtid=url_params.messageid;msgObj.r=url_params.r}if(msgObj.msid&&msgObj.cmtid&&msgObj.r){logger.info("Verifying Comment.");ajax.get(url,msgObj,function(response){if(response.cmtverified.commentbyid&&response.cmtverified.commentbyid.roaltdetails){var cmt=response.cmtverified.commentbyid;cmt.roaltdetails=cmt.roaltdetails.roaltdetails;
var commentObj={index:-1,id:-1,comment:is.string(cmt.message)?$("<div/>").text(cmt.message).html():"",level:1,parentuid:cmt.parentuid,parentusername:cmt.parentusername,abstime:msgObj.r?util.getDate(msgObj.r).getTime():"",time:msgObj.r,type:"comment-post",user:{name:cmt.roaltdetails.fromname,location:cmt.roaltdetails.location}};if(callback){callback(commentObj)}}else{if(callback){callback(null,{})}}})}if(url_params.register==="1"){logger.info("Display register window.");if(!login.getUser()){login.login()
}}};times_comments.prototype.post=function(commentObj,callback,ref){var tthis=this;if(!is.empty(commentObj.social)){if(is.defined(tthis.config.rating)&&tthis.config.rating){if(is.defined(tthis.config.moviename)&&tthis.config.moviename){var socialtext="Movie: "+tthis.config.moviename+", My Rating "+(commentObj.urs/2)+"/5. "+commentObj.comment;tthis.postToSocial(socialtext,commentObj.social.join(","))}else{if(is.defined(tthis.config.techprdtname)&&tthis.config.techprdtname){var socialtext=tthis.config.techprdtname+" : My Rating "+(commentObj.urs/2)+"/5, "+commentObj.comment;
tthis.postToSocial(socialtext,commentObj.social.join(","))}}}else{tthis.postToSocial(commentObj.comment,commentObj.social.join(","))}}tthis.validateComment(commentObj,function(error){if(!is.empty(error)){if(callback){callback(commentObj,error)}return}event.publish("comment.post.posting");logger.info("Posting Comment:"+commentObj.comment);var msgObj=tthis.commentObjToMsgObj(commentObj);msgObj.pcode=page.getChannel();if(tthis.config.sendCommentLiveEmail===false){msgObj.verifyuser=1;api.postCommentWithoutVerification(msgObj,function(response){event.publish("comment.post.posted");
if(callback){callback(commentObj)}})}else{if(tthis.config.enableparam&&msgObj.rotype!=0){msgObj.url=msgObj.url+"?"+window.location.search.replace("?","").split("&")[0]+"&";msgObj.configid="46516605"}else{if(msgObj.rotype!=0){msgObj.url=msgObj.url+"?"}}api.postComment(msgObj,function(response){event.publish("comment.post.posted");if(callback){callback(commentObj)}})}},ref)};times_comments.prototype.commentObjToMsgObj=function(commentObj){var config=this.config;var msgObj={fromname:commentObj.user?commentObj.user.name:null,fromaddress:commentObj.user?commentObj.user.email:null,userid:commentObj.user?(commentObj.user.id?commentObj.user.uid:"qrst"):"qrst",location:commentObj.user?commentObj.user.location:null,imageurl:commentObj.user?commentObj.user.image:null,loggedstatus:commentObj.user&&commentObj.user.id?1:0,message:commentObj.comment,roaltdetails:1,ArticleID:config.msid,msid:config.msid,parentid:commentObj.parentId,rootid:commentObj.rootId,url:commentObj.url,configid:commentObj.configid,urs:commentObj.urs?commentObj.urs:null,rotype:commentObj.rotype};
if(!commentObj.user.id){msgObj.verifyuser=1}return msgObj};times_comments.prototype.error=function(errMsg,wrapper){if(is.visible(wrapper)){wrapper.text(errMsg)}else{if(!is.empty(errMsg)){alert(errMsg)}}event.publish("comment_error",errMsg)};times_comments.prototype.rateAgree=times_comments.prototype.rateUpVote=function(opinionid,callback,ref){logger.log("Agree Comment: "+opinionid);this.rate(opinionid,CONSTANT.RATE_TYPE.AGREE,0,callback,ref)};times_comments.prototype.rateDisagree=times_comments.prototype.rateDownVote=function(opinionid,callback,ref){logger.log("Disagree Comment: "+opinionid);
this.rate(opinionid,CONSTANT.RATE_TYPE.DISAGREE,0,callback,ref)};times_comments.prototype.rateRecommend=function(opinionid,callback,ref){logger.log("Recommend Comment: "+opinionid);this.rate(opinionid,CONSTANT.RATE_TYPE.RECOMMEND,0,callback,ref)};times_comments.prototype.flag=times_comments.prototype.rateOffensive=function(opinionid,callback,ref,reason){var tthis=this;logger.log("Flag/Offensive Comment: "+opinionid);$(ref.offensive_popup).off("click");$(ref.offensive_popup).on("click",function(){var ref=ui.getActionReferences(this,tthis.config.comment);
var valReason=ref.offensive_popup.find("input:checked").val();if(valReason&&valReason.length>0&&valReason=="Others"){ref.offensive_popup_reason.show()}else{ref.offensive_popup_reason.hide()}tthis.error("",ref["comment-offensive-error"])});event.publish("comment.flag.show",ref.offensive_popup);var elemTop=$(ref.offensive_popup).closest(".comment-box").position().top+$(ref.offensive_popup).closest(".comment-box").closest(".comment-box").height(),elemH=$(ref.offensive_popup).height(),wH=$(window).height(),commentScrollPos=0;
$(ref.offensive_popup).removeClass("popup_above");if(((elemTop-commentScrollPos)+elemH)>wH){$(ref.offensive_popup).addClass("popup_above")}ref.offensive_popup.show();return};times_comments.prototype.showRateOffensiveBox=function(opinionid,callback,ref){};times_comments.prototype.rate=function(opinionid,typeid,rateid,callback,ref,reason){logger.log("Rate Comment: "+opinionid+":"+typeid);var tthis=this;var rating={opinionid:opinionid,typeid:typeid,rateid:rateid||0};if(reason){rating.ofreason=reason
}var user=login.getUser();if(user){logger.log("Rate Comment user is logged in");this.validateRating(opinionid,typeid,rateid,ref,function(error){if(!is.empty(error)){if(callback){callback(error)}return}var val=parseInt(ref["comment-agree-count"].text(),10);tthis.saveRatingValidation(opinionid,typeid,rateid,val+1,ref);api.rateComment(rating,function(resp){if(callback){callback(null,resp)}},user)})}else{logger.log("Rate Comment user is NOT logged in, login prompted.");(function(rating,callback,ref){if(tthis.config.loginRequiredForRating===true){login.login(function(){logger.log("Rate Comment user logged in, continue rating.");
tthis.rate(rating.opinionid,rating.typeid,rating.rateid,callback,ref,rating.reason)},true)}else{logger.log("Rate Comment user NOT logged in, continue rating.");tthis.validateRating(rating.opinionid,rating.typeid,rating.rateid,ref,function(error){if(!is.empty(error)){if(callback){callback(error)}return}var val=parseInt(ref["comment-agree-count"].text(),10);tthis.saveRatingValidation(rating.opinionid,rating.typeid,rating.rateid,val+1,ref);api.rateComment(rating,function(resp){if(callback){callback(null,resp)
}})})}}(rating,callback,ref))}};times_comments.prototype.renderComment=function(commentObj,errMsg,verified){var tthis=this;if(commentObj){var ref=ui.getActionReferences(tthis.config.wrapper+" [data-id='"+commentObj.parentId+"']");var parent=ref.parent;var input=ref["comment-input"];var facebookCheckbox=ref["comment-facebook"];var twitterCheckbox=ref["comment-twitter"];if(errMsg){event.publish("comment.post.error",errMsg);this.error(errMsg,ref["comment-error"])}else{event.publish("comment.post.rendering");
commentObj.comment=$("<div/>").text(commentObj.comment).html();commentObj.user.rate=commentObj.urs;if($(tthis.config.wrapper+" .comment-verification-msg").length){$(tthis.config.wrapper+" .comment-verification-msg").remove()}if(this.isReply(commentObj)){var reply=ref["comment-reply"];if(!is.number(commentObj.level)){commentObj.level=parseInt(commentObj.level,10)}++commentObj.level;if((commentObj&&commentObj.user&&commentObj.user.id)||!ref["set-user-captcha"]){parent.after(this.renderEach(-1,commentObj,true));
reply.hide()}else{parent.after("<div class='comment-box highlight comment-verification-msg'>"+$(tthis.config.wrapper+" [data-plugin='comment-verification-msg']").html()+"</div>");reply.hide()}}else{if((commentObj&&commentObj.user&&commentObj.user.id)||verified==true||!ref["set-user-captcha"]){$(tthis.config.wrapper+" "+this.config.main).prepend(this.renderEach(-1,commentObj,true))}else{$(tthis.config.wrapper+" "+this.config.main).prepend("<div class='comment-box highlight comment-verification-msg'>"+$(tthis.config.wrapper+" [data-plugin='comment-verification-msg']").html()+"</div>")
}}if(input){input.val("");input.keyup();input.focus();if(facebookCheckbox){facebookCheckbox.prop("checked",false)}if(twitterCheckbox){twitterCheckbox.prop("checked",false)}var $get_user_captcha=ref["get-user-captcha"];var $set_user_captcha=ref["set-user-captcha"];if($get_user_captcha){$get_user_captcha.val("")}if($set_user_captcha){$set_user_captcha.text(Math.floor((Math.random()*10))+"+"+Math.floor((Math.random()*10))+"=")}}this.error("",ref["comment-error"])}lazy.load()}else{this.error(errMsg)}};
times_comments.prototype.renderUsingTemplate=function(index,dataOne,tmpl,prepend){return $("#"+tmpl).render(dataOne,{formatNumber:function(val){return util.formatNumber(val)},timeToDate:function(time){return new Date(time)},parseDate:function(time){if(jsonDate!=null){var date=new Date(time);var newDate=$.fullCalendar.formatDate(date,"MMM dd, yyyy");return newDate}}})};times_comments.prototype.isReply=function(cmt){return cmt.parentuid&&cmt.parentusername};times_comments.prototype.loadingDiv=function(text){var tthis=this;
if(text==="Loading..."){$(tthis.config.wrapper+" [data-plugin='comment-loading']").show()}else{$(tthis.config.wrapper+" [data-plugin='comment-loading']").hide()}};return times_comments});define("comments",["tiljs/apps/times/comments","tiljs/apps/times/usermanagement","tiljs/logger","tiljs/event","jquery","tiljs/util","module","tiljs/cookie","tiljs/ui","jsrender"],function(q,n,m,y,t,r,w,x,o,p){var v=q;var u={validation:{minlength:1},messages:{name_required:"Please enter your name.",name_toolong:"Name cannot be longer than 30 chars.",email_required:"Please enter your email address.",email_invalid:"Please enter a valid email address.",minlength:"Whoops! Your review is too short. Please write a review which is at least 140 characters long so that it is helpful for others as well :)",maxlength:"You have entered more than 3000 characters.",blank:"You can't post this review as it is blank.",popup_blocked:"Popup is blocked.",has_url:"You can't post this review as it contains URL.",duplicate:"You can't post this review as it is identical to the previous one.",abusive:"You can't post this review as it contains inappropriate content.",self_agree:"You can't Agree with your own review",self_disagree:"You can't Disagree with your own review",self_recommend:"You can't Recommend your own review",self_offensive:"You can't mark your own review as Offensive",already_agree:"You have already Agreed with this review",already_disagree:"You have already Disagreed with this review",already_recommended:"You have already Recommended this review",already_offensive:"You have already marked this review Offensive",cant_agree_disagree:"You can't Agree and Disagree with the same review",cant_agree_offensive:"You can't Agree and mark the same review Offensive",cant_disagree_recommend:"You can't Disagree and Recommend the same review",cant_recommend_offensive:"You can't Recommend and mark the same review Offensive",permission_facebook:"You can't post to facebook. Post permission is required."}};
v.config=r.extend(true,{},q.config,u,w.config());return v});define("homepage",["tiljs/cookie","tiljs/load"],function(e,d){var f={};f.init=function(){};return f});define("crwdcnctrl",["tiljs/cookie","tiljs/event"],function(f,i){var h={};var g=function(a){var b=new Date(),d=new Date(a),c=b.getFullYear()-d.getFullYear();var e=b.getMonth()-d.getMonth();if(e<0||(e===0&&b.getDate()<d.getDate())){c--}return c};var j=function(){var b=f.get("MSCSAuthDetail");var a={};a.act=(typeof b!="undefined")?"TOI":"";
if(typeof b!="undefined"){a.dob=(b.match("DOB=(.*) ")!=null)?b.match("DOB=(.*) ")[1]:"";a.gender=(b.match("Gender=(.*)~Country")!=null)?b.match("Gender=(.*)~Country")[1]:""}a.age=(a.dob!="")?g(a.dob):"";return a};h.init=function(){var a=j();if(a.gender!=""||a.age!=""){if(typeof _cc2801!="undefined"){_cc2801.add("act",a.act);_cc2801.add("dem","toi.web:gender="+a.gender);_cc2801.add("dem","toi.web:age="+a.age);if(typeof _cc2801.bcp!="undefined"){_cc2801.bcp()}}}};h.init();i.subscribe(["user.login"],function(a){if(typeof h.init=="function"){h.init()
}})});define("tiljs/social/twitter",["../social/social","../ui","../logger","../event","../util","jquery","module"],function(x,n,m,y,p,q,w){var o=new x("twitter","twitter");var t={parse:false,js:"//platform.twitter.com/widgets.js",js_id:"twitter-wjs",share_url:"https://twitter.com/share",via:null,format:"{{:title}}",sharePageTitle:true};var v=p.extend(true,{},t,w.config());o.setJS(v.js,v.js_id);o.addPlugin({id:"button",js:true,init:function(c,e){var f=q(c);var d=p.data(c);var a={count:"vertical",url:location.href};
var b=p.extend(true,{},a,d);b.url=d.url||d.href||f.attr("href")||b.href;var g=q("<a class='twitter-share-button'></a>");q.each(b,function(i,h){g.attr("data-"+i,h)});f.empty();f.append(g);o.parse(c)}});o.addPlugin({id:"frame",js:true,init:function(d,f){var g=q(d);var e=p.data(d);var a={twtid:"",theme:"light"};var c=p.extend(true,{},a,e);var b="twt-"+c.twtid;if(window.twttr){twttr.widgets.createTweet(c.twtid,document.getElementById(b),{theme:c.theme})}}});o.addPlugin({id:"share",alias:["tweet"],events:{click:function(b){var a=p.data(this);
o.tweet(a.url||q(this).attr("href"),p.format(a.format||v.format,a),a.via||v.via,this)}},init:function(b,a){}});o.tweet=o.share=function(e,b,a,c){b=(typeof b=="string")?b.trim():b;var d={url:o.getAbsoluteUrl(e),text:b||(v.sharePageTitle===true?document.title.split("|")[0]:"")};if(a){d.via=a}o._share(v.share_url,d,{name:"twitter_tweet_dialog",width:500,height:400},c)};o.addPlugin({id:"follow",events:{click:function(a){o.follow(q(this).attr("data-url")||q(this).attr("href"))}},init:function(b,a){}});
o.follow=function(d,a){var c=o.getAbsoluteUrl(d);var b=window.open(d,"_blank");b.focus()};o.addPlugin({id:"login",init:function(b,a){}});var r=null;o.login=function(a,b){};o.addPlugin({id:"logout",init:function(b,a){}});o.parse=function(a){if(typeof twttr!=="undefined"){twttr.widgets.load(a)}else{m.warn("'twttr' is required in parse")}};o.logout=function(a){};o.beforeinit=function(){};o.beforeloadjs=function(){};o.afterloadjs=function(){if(typeof twttr!=="undefined"){m.log("twttr js loaded");var a=["click","tweet","retweet","follow","favorite"];
p.each(a,function(c,b){if(a.hasOwnProperty(b)){twttr.events.bind(b,function(d){return function(e){y.publish("twttr."+d,{intent_event:e})}}(b))}})}else{m.warn("'twttr' is required in afterloadjs")}};var u=null;o.getUser=function(a){};o.onlogin=function(a){};o.onlogout=function(a){};q(document).ready(function(){o.init(v)});return o});define("tiljs/social/pinterest",["../social/social","../ui","../logger","../event","../util","../load","jquery","module"],function(v,n,l,w,p,m,q,u){var o=new v("pinterest","pinterest");
var r={parse:false,js:"//assets.pinterest.com/js/pinit.js",js_id:"pinterest-js",share_url:"//www.pinterest.com/pin/create/button/"};var t=p.extend(true,{},r,u.config());o.setJS(t.js,t.js_id);o.addPlugin({id:"button",init:function(e,g){var h=q(e);var f=p.data(e);var a={"pin-do":"buttonPin","pin-config":"above"};var c=p.extend(true,{},a,f);c.href=f.url||f.href||h.attr("href")||c.href;var d=q("<a></a>");var b={url:o.getAbsoluteUrl(c.href),media:o.getAbsoluteUrl(c.image),description:c.summary};d.attr("href","http://www.pinterest.com/pin/create/button/?"+q.param(b));
q.each(c,function(j,i){d.attr("data-"+j,i)});h.empty();h.append(d);o.parse(e)}});o.addPlugin({id:"share",alias:["pin"],events:{click:function(a){var b=p.data(this);o.share(b.url||q(this).attr("href"),b.title,b.summary,b.image,this)}},init:function(a,b){}});o.pin=o.share=function(a,c,b,d,e){o._share(t.share_url,{url:o.getAbsoluteUrl(a),description:c,summary:b,media:o.getAbsoluteUrl(d)},{name:"pinterest_pin_dialog",width:700,height:400},e)};o.addPlugin({id:"follow",events:{click:function(a){o.follow(q(this).attr("data-url")||q(this).attr("href"))
}},init:function(a,b){}});o.follow=function(a,b){var d=o.getAbsoluteUrl(a);var c=window.open(a,"_blank");c.focus()};o.parse=function(a){var b=q("#"+t.js_id);b.remove();m.js(t.js,null,t.js_id)};q(document).ready(function(){o.init(t)});return o});define("tiljs/social/linkedin",["../social/social","../ui","../logger","../event","../util","jquery","module"],function(t,m,k,u,n,o,r){var l=new t("linkedin","linkedin");var p={parse:false,js:"//platform.linkedin.com/in.js",js_id:"linkedin-js",share_url:"http://www.linkedin.com/shareArticle"};
var q=n.extend(true,{},p,r.config());l.setJS(q.js,q.js_id);l.addPlugin({id:"button",js:true,init:function(f,a){var b=o(f);var g=n.data(f);var c={url:location.href,counter:"top"};var d=n.extend(true,{},c,g);d.url=g.url||g.href||b.attr("href")||d.href;var e=o("<script type='IN/Share'><\/script>");o.each(d,function(i,h){e.attr("data-"+i,h)});b.empty();b.append(e);l.parse(f)}});l.addPlugin({id:"share",events:{click:function(a){var b=n.data(this);l.share(b.url||o(this).attr("href"),b.title,b.summary,b.image,this)
}},init:function(a,b){}});l.share=function(b,d,c,e,a){l._share(q.share_url,{url:l.getAbsoluteUrl(b),title:d,summary:c},{name:"linkedin_share_dialog",width:500,height:570},a)};l.parse=function(a){if(typeof IN!=="undefined"){IN.parse(a)}else{k.warn("'IN' is required in parse")}};o(document).ready(function(){l.init(q)});return l});define("tiljs/social/googleplus",["../social/social","../ui","../logger","module","../event","../util","jquery"],function(t,l,k,r,u,m,o){var p={parse:false,js:"https://apis.google.com/js/plusone.js?onload=attachgoogleevent",js_id:"googleplus-js",share_url:"https://plus.google.com/share"};
var q=m.extend(true,{},p,r.config());var n=new t("googleplus","googleplus");n.setJS(q.js,q.js_id);n.addPlugin({id:"button",js:true,init:function(f,a){var b=o(f);var g=m.data(f);var c={href:location.href,size:"tall",annotation:"bubble",width:null};var d=m.extend(true,{},c,g);d.href=g.url||g.href||b.attr("href")||d.href;var e=o("<div class='g-plusone'></div>");o.each(d,function(i,h){e.attr("data-"+i,h)});b.empty();b.append(e);n.parse(b[0])}});n.addPlugin({id:"share",events:{click:function(a){var b=m.data(this);
n.share(b.url||o(this).attr("href"),b.title,b.summary,b.image,this)}},config:{shareUrl:""},init:function(a,b){}});n.share=function(b,d,c,e,a){n._share(q.share_url,{url:n.getAbsoluteUrl(b)},{name:"googleplus_share_dialog",width:500,height:400,scrollbars:1},a)};n.addPlugin({id:"follow",events:{click:function(a){n.follow(o(this).attr("data-url")||o(this).attr("href"))}},init:function(a,b){}});n.follow=function(b,c){var a=n.getAbsoluteUrl(b);var d=window.open(b,"_blank");d.focus()};n.parse=function(a){if(typeof gapi!=="undefined"){gapi.plusone.go()
}else{k.warn("'gapi' is required in parse")}};o(document).ready(function(){n.init(q)});return n});define("tiljs/plugin/pre_event",["../event","module","../util","../is"],function(l,n,i,m){var j={};var k={};var h=i.extend(true,{},k,n.config());j.init=function(){if(window.__times){j.process(window.__times)}else{window.__times=[]}window.__times.push=function(a){j.processOne(a);return Array.prototype.push.apply(this,arguments)}};j.process=function(a){i.each(a,function(b,c){j.processOne(c)})};j.processOne=function(e){try{if(m.funct(e)){e()
}else{if(m.array(e)){var d=e[0],a=e[1],b=e.splice(2);require(d)[a].apply(this,b)}else{l.publish("logger.warn","Invali params in __times")}}}catch(c){l.publish("logger.error",c)}};j.init();return j});var TimesApps=window.TimesApps||{};TimesApps.GA=(function(){var c,d;d={_getGACategory:function(){category="WEB-";if(typeof toiprops==="object"&&toiprops._SCN_pg){category+=(toiprops._Tmpl_pg=="articlelist")?"CL":toiprops._Tmpl_pg;category+=(toiprops.seoLocation&&toiprops._Tmpl_pg&&toiprops._Tmpl_pg.indexOf("show")===-1)?"/"+toiprops.seoLocation:"";
category+=(category.match(/CL$/))?document.location.pathname:""}else{category+=document.location.pathname}return category},_send:function(a,b){window.ga&&window.ga("send",{hitType:"event",eventCategory:d._getGACategory(),eventAction:a,eventLabel:b})}};c={send:function(a,b){return d._send(a,b)},getGACategory:function(){return d._getGACategory()}};return c}());TimesApps.getGACategory=function(){return TimesApps.GA.getGACategory()};define("pgtrack",[],function(){var b={};b.evtCap=function(a){try{if(window.event&&window.event.srcElement){var f=3,g=window.event.srcElement;
while(f>0&&g!=document.querySelector("body")){if(g.getAttribute("pg")!=null){b.track(b.addUrl(g));break}f--;g=g.parentNode}}else{if(a&&a.stopPropagation&&!window.opera){if(a.target.getAttribute("pg")!=null){b.track(b.addUrl(a.target))}}}}catch(h){}};b.addUrl=function(a){var d=a.getAttribute("pg");if(d&&d.indexOf("geturl")>-1){if(a.nodeName=="IMG"||a.nodeName=="SPAN"){a=a.parentElement}d=d.replace("geturl",a.getAttribute("href"))}if(d&&d.indexOf("getmsid")>-1){if(a.nodeName=="IMG"||a.nodeName=="SPAN"){a=a.parentElement
}d=d.replace("getmsid",a.getAttribute("href").match(/\d+(?=\D*$)/)[0])}return d};b.track=function(l){if(l!=null){var a=l.split("#");var i=null;if(l!=null){var a=l.split("#"),h,j;var k=l.indexOf("~"),h;if(k>-1){h=l.substr(k+1);l=l.substr(0,k);a=l.split("#")}else{h=a[0]}if(a[1]){j=a[1]}var i=null;i=ga("send","event",TimesApps.getGACategory(),h,j)}}};$(document).click(b.evtCap);return b});define("breakingnews",["jquery","tiljs/ajax","tiljs/load"],function(g,h,e){var f={};f.reloadtime=2000;f.breakingnews=function(){var a="https://toibnews.timesofindia.indiatimes.com/TOIBNews/breakingnews.html";
if(document.location.host=="toidev.indiatimes.com"||document.location.host=="jcmsdev.indiatimes.com"){a="/home1_articlecount_test.cms"}if(window.homeObj&&window.homeObj.breakingNewsPause==0){h.get(a,function(k){k=k.replace(/[\r\n]/g,"");if(!g.trim(k)){myMethod();f.reloadtime=180000;return true}var l=k.split(/[|]/g);g(".breaking-news .wrapper").html("");g(".breaking-news .wrapper").html("<ul id='js-news'/>");var b=0;var c=0,d=0;g.each(l,function(n,i){i='<li class="news-item">'+i+"</li>";g("#js-news").append(i);
var j=g("#js-news li").eq(n).text().length;d+=j;if(j.length>90){c+=(j.length-90);b++}});myMethod(l.length,d,b,c)})}else{setTimeout(function(){f.breakingnews()},f.reloadtime)}myMethod=function(d,c,k,l){if(d&&c){g(".breaking-news").show();if(g("#adsdivLyr").height()>0){g("#adsdivLyr").css("margin-top","10px")}if(g("#js-news").ticker()){g("#js-news").show()}if(d<2){g(".ticker-controls").hide()}if(!c){return true}f.reloadtime=d>1?d:2;c=d>1?c:c*2;var b=l*155;f.reloadtime=(d*6000)+f.reloadtime+b+(d*2500);
f.reloadtime=f.reloadtime*5}else{g(".breaking-news").hide()}setTimeout(function(){f.breakingnews()},f.reloadtime)}};setTimeout(function(){if(g("#js-news").length>0){f.breakingnews()}},8000);return f});define("global",[],function(){var d={};var c={};c.global=d;c.set=function(b,a){d[b]=a};c.get=function(a){return d[a]};return c});define("navsearchbox",["jquery"],function(c){if(c("#pageType").val()&&c("#pageType").val().indexOf("video")!=-1){return}var d={};d.toTitleCase=function(a){return a.replace(/\w\S*/g,function(b){return b.charAt(0).toUpperCase()+b.substr(1).toLowerCase()
})};d.trimToWords=function(b,a){return b.split(" ").splice(0,a).join(" ").substring(0,120)};d.validateForm=function(){if(c("#query").val()==""){alert("Please enter text to search");return false}else{var b=document.frmsearch1.query.value;var i=-1;i=document.frmsearch1.search1.value;var a=null;if(b==""){alert("Please enter text to search");document.frmsearch1.query.focus();return false}switch(i){case"0":var j=d.trimToWords(d.toTitleCase(b),10);a="https://timesofindia.indiatimes.com/topic/"+j.replace(/\s+/g,"-");
break;case"1":a="http://search.indiatimes.com/websearch.cms";document.frmsearch1.type.value=1;break;case"2":a="http://search.indiatimes.com/websearch.cms";document.frmsearch1.type.value=0;break;case"3":var j=d.toTitleCase(b);a="https://timesofindia.indiatimes.com/topic/"+j.replace(/\s+/g,"-")+"/videos";break;case"4":var j=d.toTitleCase(b);a="http://photogallery.indiatimes.com/resultsearch.cms?source=toisearch&q="+j.replace(/\s+/g,"-");document.frmsearch1.target="_blank";break;default:break}ga("send","event",TimesApps.getGACategory(),"NavBar-Search","Search_Initiate | "+document.frmsearch1.query.value);
window.location.href=a;return false}};c("[data-plugin='navsearchboxvalidate']").on("submit",d.validateForm);(function(){window.navsearch={};var b,j,k,i,l;window.navsearch.handleAutoSearchResult=function(q){c("#nav_autosuggest_result").html("");if(q&&c.type(q)=="array"){var h=q[1].length;for(var g=0;g<h;g++){var e=q[1][g][0].replace(/\b[a-z]/g,function(m){return m.toUpperCase()});var p="",f="https://timesofindia.indiatimes.com/topic/"+e.replace(/\s+/g,"-");p='<li><a href="'+f+'" target="_blank" pg="NavBar-Search#Search_Initiate | '+e+'">'+e+"</li>";
c("#nav_autosuggest_result").append(p)}j=c("#nav_autosuggest_result li")}};var a=null;c("[data-plugin='navsearchboxvalidate'] #query").on("keyup","",function(h){b=h.keyCode;var n=c(this).val().trim(),g=c("#nav_autosuggest_result");if(n&&!(b==40||b==38||b==27&&c("#nav_autosuggest_result").is(":visible"))){var e="https://suggestqueries.google.com/complete/search?client=youtube&jsonp=navsearch.handleAutoSearchResult&q="+n;if(a){a.abort()}a=c.ajax({type:"GET",dataType:"jsonp",url:e,success:function(m){}})
}else{if(n){if(b==27){!(c("#main-nav").length)&&c("#nav_autosuggest_result").closest(".search-form").removeClass("hover")}else{if(b==40){!(c("#main-nav").length)&&c("#nav_autosuggest_result").closest(".search-form").addClass("hover");if(!j.hasClass("selected")){j.first().addClass("selected");c("#query").val(j.first().find("a").text())}else{k=j.filter(".selected");var f;if(!k.length||k.is(":last-child")){f=j.eq(0)}else{f=k.next()}k.removeClass("selected");f.addClass("selected");c("#query").val(f.find("a").text())
}}else{if(b==38){!(c("#main-nav").length)&&c("#nav_autosuggest_result").closest(".search-form").addClass("hover");if(!j.hasClass("selected")){j.first().addClass("selected");c("#query").val(j.first().find("a").text())}else{k=j.filter(".selected");var f;if(!k.length||k.is(":first-child")){f=j.last()}else{f=k.prev()}k.removeClass("selected");f.addClass("selected");c("#query").val(f.find("a").text())}}}}}else{c("#nav_autosuggest_result").html("")}}})})();return d});define("navigation",["jquery","tiljs/ajax","global","tiljs/plugin/lazy","tiljs/is","tiljs/cookie","navsearchbox"],function(B,u,H,C,x,G,A){var r={func:{},getelem:{},ajax:{}};
H.set("nav",r);(function(){var b=G.get("geolocation");var a=(window.getCityJSON&&getCityJSON[b]&&getCityJSON[b]["lang"])?getCityJSON[b]["lang"]:"hindi";if(B("#nav-tv.category").length){u.get("/tvlistingdrop.cms?languagename="+a+"&type=default",function(c){B("#rnav45449811, #rnav41505232").remove();B("body").append(c)})}})();jQuery(document).ready(function(b){var a=G.get("cnt");function c(d){if(d=="UK"){var e="";if(b("#nav-amazon").length>0){e="/amazonuk.cms"}else{e="/amazon_drop.cms?geoid=5"}b.get(e,function(f){b("#nav-amazon").replaceWith(f);
b("#amzn_domain").show();b("li[drop='amazon']").html(f)})}else{b("#amzn_domain").show()}}});function F(b){var a=B(b).closest("li").find(".list7 li:first").attr("id");B("#rnav"+a).show()}function I(b){if(B(b).parent().attr("class").match(/current/)||B(b).parent().attr("class").match(/category/)){return true}r.id=B(b).parent().attr("id");r.extfile="";r.extfile=B(b).attr("data-external");r.name=r.id.substring(4);B(b).parent().find("li:first").addClass("active");F(b);if(r.id=="nav-home"&&B("#rnav-2128932452")){B(".rnavclass").hide();
B("#rnav-2128932452").show();if(!r.ajax[r.id]&&B(b).hasClass("lnavdata")){B(".level-one .loader").show()}}if(!r.ajax[r.id]&&B(b).hasClass("lnavdata")){var a=function(g){var c=g;if(typeof s!=="undefined"&&s==1){c=c+"&s="+s}if(c=="entertainment-tv"||c=="tv"){var d=G.get("geolocation");var e=(window.getCityJSON&&getCityJSON[d]&&getCityJSON[d]["lang"])?getCityJSON[d]["lang"]:"hindi";u.get("/tvlistingdrop.cms?languagename="+e,function(h){B("#rhsnav"+g).append(h)})}if(c.match(/movie-reviews/g)){u.get("/nav_moviereview.cms?mvlang="+c,function(h){B("#rhsnav"+g).html(h)
})}r.ajax["nav-"+g]=1;var f=(r.extfile)?r.extfile:"/homeajax.cms?nav="+c;B.ajax({url:f}).done(function(h){B("#rhsnav"+g).append(h);var i=B("#rhsnav"+g).siblings(".left-column").find(".list7 li:first").attr("id");i=i&&i.indexOf("lnav")>-1?i.replace("lnav",""):i;B("#rnav"+i).show();B(".level-one .loader").hide();r.ajax["nav-"+g]=1;B("#rnavtravel").html();B("#rnavtravel").html(B("#rnav22806450").html());B("#rnav22806450").hide();if(r.id=="nav-home"&&B("#rnav-2128932452")){B(".rnavclass").hide();B("#rnav-2128932452").show()
}C.load()}).fail(function(){r.ajax["nav-"+g]=0})};a(r.name)}if(!r.getelem[r.id]&&B("#rnav"+r.name).length){var a=function(c){$span=B("#rnav"+c).clone();B("#rnav"+c).remove();B("#nav-"+c+" #rhsnav"+c).append($span);B("#rnav"+c).show()};a(r.name);r.getelem[r.id]=1}if(!r.timeoutId){r.timeoutId=window.setTimeout(function(){r.timeoutId=null;B(".level-one .hover").removeClass("hover");B("#rnav"+r.name).show();B("#"+r.id).addClass("hover");B("#rnav22806450").hide();C.load()},300)}}function y(){if(r.timeoutId){window.clearTimeout(r.timeoutId);
r.timeoutId=null}else{B(".dropdown, .all-sections").mouseleave(function(){B(".level-one .hover").removeClass("hover");B(".list7 li.active").removeClass("active");B(".rnavclass").hide()})}}B("#header, #trending, #content, .article-content-wrapper, .breaking-news").hover(function(){B(".level-one .hover").removeClass("hover");B(".search-form.hover").removeClass("hover");B(".rnavclass").hide()});B(".search-form").hover(function(){B(".level-one li").removeClass("hover")});B("#navigation").on("mouseenter",".navquery",function(){I(this)
}).on("mouseleave",".navquery",function(){y(this)});B(".navquery").on("click",function(a){if(x.touch()){var b=window.curNav;window.curNav=B(this).attr("pg");if(typeof b==="undefined"||b!==window.curNav){I(this);return false}}return true});B(document).on("click"),function(){if(x.touch()&&window.curNav!==null){window.curNav=null;y(this)}};function D(c){var a=B(c).attr("id");a=a.replace(/lnav/g,"");if(r.ajax[B(c).parents(".hover").attr("id")]!=1||B("#rnav"+a).length==0){r.activeTab=c;B(c).parents(".two-column-layout").find(".loader").show();
B(".rnavclass").hide();return false}B(c).parents(".two-column-layout").find(".loader").hide();B(".rnavclass").hide();B(".level-one .active").removeClass("active");B(c).addClass("active");var b=B(c).parents("ul.level-one li");if(b.length==0){b=B(c).parents(".two-column-layout")}b.find("#rnav"+a).show();B("#rnav22806450").hide();C.load()}B(".lnavclass").mouseover(function(){D(this)});B(".lnavclass a").click(function(){if(x.touch()){var a=window.curNav2;window.curNav2=B(this).attr("pg");if(typeof a==="undefined"||a!==window.curNav2){D(this);
return false}}return true});B(".latestwidget").click(function(){r.id=B(this).attr("id");url="";loop=0;if(r.id=="latest"&&!r[r.id]){url="/mostread_blockibeat.cms?tabname=mostread"}else{if(r.id=="mostcommented"&&!r[r.id]){url="/mostcommented_block.cms?tabname=mostcomm"}else{if(r.id=="mostshared"&&!r[r.id]){url="/mostshared_blocknew.cms?tabname=mostshared&top=5&tabname=mostshared";loop++}}}if(url!=""){t(url,loop)}B(".latestwidget").removeClass("active");B(this).addClass("active");B(".tabcontent").hide();
B("."+r.id).show()});B(document).ready(function(){if(B(".mostshared ol li").length<=3){B("#mostshared").trigger("click")}});function t(a,b){b++;if(b>1){a=a+"&version=1"}u.get(a,function(c){if(B(c).find("ul li").length<=3&&b<2){t(a,b)}else{B("."+r.id+" ol").html(c);r[r.id]=1;B("span.number").show()}})}B(".shopWidget").click(function(){r.id=B(this).attr("id");B(".shopWidget").removeClass("active");B(this).addClass("active");B(".tabcontent").hide();B("."+r.id).show();C.load()});setTimeout(function(){B("span.number").show()
},500);var w=0,v="upwards";if(typeof(disabledStickyNav)==="undefined"){r.stickyTop=B("#navigation").offset()?B("#navigation").offset().top:0;B(window).scroll(function(){r.windowTop=B(window).scrollTop();if(r.windowTop>r.stickyTop){B("#navigation").addClass("sticky")}else{B("#navigation").removeClass("sticky")}var a=B(this).scrollTop();if(a>w){v="downwards";B("body").removeClass("scroll-up").addClass("scroll-down")}else{v="upwards";B("body").addClass("scroll-up").removeClass("scroll-down")}w=a})}function E(){var a=null;
return function(){if(B(window).width()<=999){if(!B("#navigation ul.level-one").hasClass("ipadflow")){B("#navigation ul.level-one").addClass("ipadflow");if(B("#navigation ul.level-one li.nav-ipad .drpdwn-nav-ipad li").length<1){var b=B('#navigation .level-one>li:visible:gt(8):not(".nav-home"):not(".nav-amazon"):not(".nav-ipad")').clone();a=B('#navigation .level-one>li:visible:gt(8):not(".nav-home"):not(".nav-amazon"):not(".nav-ipad")');B("#navigation ul.level-one li.nav-ipad").append('<ul class="drpdwn-nav-ipad"></ul>');
b.find("div.dropdown").remove();B("#navigation ul.level-one li.nav-ipad .drpdwn-nav-ipad").append(b);B("#navigation ul.level-one li.nav-ipad .drpdwn-nav-ipad").css("background",B("#navigation").css("background-color"));B("#navigation ul.level-one").addClass("nooverflow")}a.hide()}}else{if(a!=null){a.show();B("#navigation ul.level-one").removeClass("ipadflow")}}}}var z=E();B(window).resize(function(){z()});B(document).ready(function(){if(!B("#pageType").val()||(B("#pageType").val()&&B("#pageType").val().indexOf("video")==-1)){B(".search-form").click(function(){B(".hover").removeClass("hover");
B(this).addClass("hover");B("#nav_autosuggest_result").html("");B("#query").removeAttr("disabled");B("#query").focus()})}z()});return{}});define("compatibility_toi",[],function(){return{}});define("ajax",["tiljs/ajax"],function(b){return b});define("event",["tiljs/event"],function(b){return b});define("localstorage",["tiljs/localstorage"],function(b){return b});define("preload",[],function(){});define("util",["tiljs/util"],function(b){return b});define("is",["tiljs/is"],function(b){return b});define("ui",["tiljs/ui"],function(b){return b
});define("cookie",["tiljs/cookie"],function(b){return b});define("event",["tiljs/event"],function(b){return b});define("plugin/lazy",["tiljs/plugin/lazy"],function(b){return b});define("load",["tiljs/load"],function(b){return b});define("toicommonjs/rodate",["rodate"],function(b){return b});define("logger",["tiljs/logger"],function(b){return b});define("page",["tiljs/page"],function(b){return b});define("user",["tiljs/user"],function(b){return b});define("times/comments",["comments"],function(b){return b
});define("authorcomments",["tiljs/apps/times/authorcomments"],function(b){return b});define("tiljs/apps/times/authorcomments",["jquery","event","plugin/lazy"],function(g,h,e){var f={};f.run=function(){h.subscribe("comments.loaded",function(a){var l=g(a.config.main);if(!g("#"+g(l).attr("id")+' [id="authComment"]').length){var i=a.flagData?a.flagData.authorsComment:null;if(i){var c=[];for(var d=0;d<i.length;d++){a.parseComment(i[d],c)}var b;b="<div id='authComment' style='border:1px solid #ccc;margin-bottom:10px;'><div class='authorTxt'>Author's Comment</div>";
for(var d=0;d<c.length;d++){b=b+a.renderEach(d,c[d])}b=b+"</div>";l.prepend(b);e.load();g("#authComment .authorTxt:not(:first-child)").remove()}}})};return f});define("nlwidget",[],function(){var b={};b.run=function(){if($('[data-id="newsletterWidgetDisplay"]').length){$.ajax({url:"/newnlwidget.cms?ver=5",cache:true,dataType:"html",success:function(a){$('[data-id="newsletterWidgetDisplay"]').html(a);var d=document.createElement("script");d.setAttribute("type","text/javascript");d.setAttribute("src","/newsletterwidget_js/version-29,minify-1.cms");
document.getElementsByTagName("head")[0].appendChild(d)},error:function(a,e,f){if(window.console&&console.log){console.log(f)}}})}};return b});define("toinotification",["tiljs/cookie"],function(j){var g={},k=5,i=(location.host==="timesofindia.indiatimes.com")?"https://timesofindianotifications.indiatimes.com/toinotification/gcm.htm":"https://testnotification.indiatimes.com/sites/toi/testgcm.htm",l=["toierrorfound.cms"];g.isChrome=function(){return/Chrome/i.test(navigator.userAgent)&&!/OPR/i.test(navigator.userAgent)
};g.isMozilla=function(){return/firefox/i.test(navigator.userAgent)};g.isSafari=function(){return(/^((?!chrome|android).)*safari/i.test(navigator.userAgent))};g.init=function(){TimesApps.checkGdprAndCall(function(){if(typeof pn_js!="undefined"&&pn_js){pn_js.init()}return false},function(){window.addEventListener("load",function(){if("serviceWorker" in navigator){try{navigator.serviceWorker.getRegistrations().then(function(b){for(var c in b){b.hasOwnProperty("registration")&&c.unregister()}})}catch(a){}}})
})};g.isBlocked=function(){for(idx=0;idx<l.length;idx++){if(window.location.href.indexOf(l[idx])!=-1){return true}}return false};g.valid=function(){if((g.isChrome()||g.isMozilla()||g.isSafari())&&!j.get("_tointfcproceed")&&!j.get("_tointfcskip")&&!j.get("_tointfcblock")&&!j.get("_tointfcallow")){return true}return false};if(g.isChrome()){var h=window.RequestFileSystem||window.webkitRequestFileSystem;if(!!h){h(window.TEMPORARY,100,function(a){if(g.valid()&&!g.isBlocked()&&("serviceWorker" in navigator)){g.init()
}},function(a){})}}else{if(g.isMozilla()&&g.valid()&&!g.isBlocked()&&("serviceWorker" in navigator)){g.init()}else{if(g.isSafari()&&g.valid()&&!g.isBlocked()&&("safari" in window)&&("pushNotification" in window.safari)&&localStorage.length){g.init()}}}});define("tpwidget",["event","tiljs/cookie"],function(f,e){var d={};d.init=function(){var a=function(){d.subscribeLoggedInStatus();d.bindEvents()};TimesApps.checkGdprAndCall(a)},d.data={widgettypes:["widget-head","widget-two"],"widget-head":"tpwidget-one","widget-two":"tpwidget-two",widgetsArray:[],isUserLoggedIn:false,isInitialised:false,userInfo:[],uemail:"",url:escape(document.location.href),pcode:"TOI",scode:"News",oid:"",uid:"",aname:"",txnId:"",firsttime:true},d.handlePostLoginActivity=function(a,b){var c="?uid="+d.data.uid;
c+="&pcode="+d.data.pcode;c+="&scode="+d.data.scode;c+="&aname="+a;c+="&pfm=WEB";c+="&txnId="+b;d.sendActivityRequest(c)},d.sendActivityRequest=function(a){$.get("https://tpapi.timespoints.com/v1/activity/logact"+a,function(b,c){if(b.status=='"FAILURE"'){console.log(b.message)}else{console.log("TPActivity Post Login Activity URL -https://tpapi.timespoints.com/v1/activity/logact"+a)}})},d.bindEvents=function(){$(document).on("VOD_EVENTS",function(b,a,c){var h=a.id?a.id:Math.round((new Date()).getTime());
if(typeof c!="undefined"&&c.toUpperCase()=="VIDEOVIEW"){d.fireActivity("watch_video",h)}});$(document).on("article_read",function(b,a,c){d.fireActivity("read",a.msid)});$(document).on("view_photo",function(b,a,c){d.fireActivity("view_photo",a.msid)});$(document).on("social.onBeforeShare",function(a){if(!d.data.isUserLoggedIn){TPWidget.addPreLoginActivity("sh_tw")}})},d.fireActivity=function(b,a){if(!d.data.isUserLoggedIn){console.log("TPActivity Activity- "+b+", Transcation ID-"+a);TPWidget.addPreLoginActivity(b)
}else{d.handlePostLoginActivity(b,a)}},d.initialisewidget=function(a){if(typeof TPWidget!="undefined"&&typeof TPWidget.init=="function"){var b=[];$.each(d.data.widgettypes,function(h,c){if($("#"+c).length){b.push({ele:c,widgetType:d.data[c]})}});if(a!=null&&typeof(a)!="undefined"){TPWidget.init({widgets:b,userLoginInfo:{host:d.data.pcode,channel:d.data.scode,URL:escape(document.location.href),userId:d.data.uid,oid:"",email:d.data.email}})}else{TPWidget.init({widgets:b})}}f.publish("tpinitated")},d.PostLoginActions=function(){TPWidget.PostLoginActions({host:"TOI",channel:"News",URL:escape(document.location.href),userId:d.data.uid,oid:"",email:d.data.email})
},d.subscribeLoggedInStatus=function(){f.subscribe("user.status",function(a){d.data.isUserLoggedIn=typeof a!=="undefined"&&a!==null?true:false;if(!d.data.isInitialised){d.updateUserDetails();d.initialisewidget(a);d.data.isInitialised=true;if(toiprops&&toiprops._Tmpl_pg&&toiprops._Tmpl_pg.toLowerCase()=="default"){d.fireActivity("visit",Math.round((new Date()).getTime()));d.fireActivity("register",Math.round((new Date()).getTime()))}}d.data.firsttime=false});f.subscribe("user.login",function(a){if(a){d.data.isUserLoggedIn=true;
d.updateUserDetails(a.getEmail());d.PostLoginActions();typeof ga=="function"&&ga("send","event","TPRedeem","login_success",window.location.href)}});f.subscribe("user.logout",function(a){d.data.isUserLoggedIn=false;if(!d.data.firsttime){if(typeof TPWidget!="undefined"&&typeof TPWidget.logoutAction=="function"){TPWidget.logoutAction()}}d.data.isUserLoggedIn=false})},d.updateUserDetails=function(a){d.data.email=a?a:e&&e.get("MSCSAuthDetails")&&e.get("MSCSAuthDetails").split("=")[1];d.data.uid=e&&e.get("ssoid")
};return d});document.domain="indiatimes.com";var TimesApps=window.TimesApps||{};TimesApps.VideoCore=(function(){var e,f,d;e={iframeTemplateName:"vod_player.cms",iframeHtml:'<iframe allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true"></iframe>'};f={_generateIframeSrc:function(c){var a="/"+e.iframeTemplateName+"?";var b=[];for(key in c){if(!c.hasOwnProperty(key)){return}b.push(key+"="+c[key])}a+=b.join("&");return a},_createVideoIframe:function(c){var a=f._generateIframeSrc(c);
var b=document.createElement("div");$(b).html(e.iframeHtml);$(b).find("iframe").attr("src",a).attr("data-plugin","vodIframe");if(c.classNames){$(b).find("iframe").addClass(c.classNames)}if(c.domId){$(b).find("iframe").attr("id",c.domId)}return b.innerHTML}};d={generateIframeSrc:function(a){return f._generateIframeSrc(msid,a)},createVideoIframe:function(a){return f._createVideoIframe(a)}};return d}(window.jQuery));TimesApps.VideoGalleryApp=(function(){var h,j,k,i,l,g;i={videoBoxMap:{},videoCount:0};
g={PLAYING:"PLAYING",PAUSED:"PAUSED",AUTOPLAY_LOCALSTORAGE_KEY:"autoplay_userInitiated"};l=function(){var a=i;$(document).on("videodash.invokeVideo",function(c,b){j._playNext.call(null,[c,b,a])});$(document).on("videodash.userAction LIVE_TV_EVENTS",function(c,b,d){j._playCurrentAndPauseOthers.call(null,[c,b,d])});$(document).on("MINI_TV_EVENTS VOD_EVENTS",function(c,b,d){require(["tiljs/event"],function(e){e.publish("VOD_EVENTS",[c,b,d])});j._playCurrentAndPauseOthers.call(null,[c,b,d]);if(d&&d.toUpperCase()=="VIDEOIFRAMEREMOVED"){TimesApps.playingSubsequentVideo=false
}});$(document).on("GAANA_PLAYER_LOADED VOD_LOADED",function(b,c,e,d){i.pageName=i.pageName?i.pageName:($("body").data("page-name")||"");if(e=="VOD_LOADED"&&c.source=="MG_0"){return}j._processSystemInitiatedEvents.call(null,[b,c,e,d])});$(document).on("PLAYER_LOADED",function(b,c,e,d){j._processSystemInitiatedEvents.call(null,[b,c,e,d])});$(document).on("GAANA_PLAYER_EVENTS",function(c,b,d){j._playCurrentAndPauseOthers.call(null,[c,b,d])});$(document).on("videodash.videoEvents LIVE_TV_EVENTS MINI_TV_LOADED",function(b,c,e,d){j._processSystemInitiatedEvents.call(null,[b,c,e,d])
});require(["event"],function(b){b.subscribe("MINI_TV_EVENTS",function(c){var d={};var e=c[0];var f=c[1];j._playCurrentAndPauseOthers.call(null,[d,e,f])})});$(document).on("videodash.switchOffAutoPlay",function(b,c){j._toggleAutoPlay.call(null,[b,c])});$(".jMediaGalleryWidget").on("MG_EVENTS",function(b,c,e,d){j._processSystemInitiatedEvents.call(null,[b,c,e,d])})};h={_createVideoObjForOtherTypePlayer:function(a,b,d,c,e){return new TimesApps.OtherVideoBox(a,b,d,c,e)}};j={_init:function(){l()},_playCurrentAndPauseOthers:function(b){var t=b[0];
var a=b[1];var f=typeof b[2]=="string"&&b[2].toUpperCase();var c=a.source.toUpperCase();if(i.videoBoxMap[c]){var e=i.videoBoxMap[c];e.setStatus(g.PLAYING);if(TimesApps.isDevMode){console.log("VOD_STATUS_playing__"+c+"__videoMap-",i.videoBoxMap)}j._pauseVideosNotInFocus.call(null,[t,a,f])}if(t.type=="VOD_EVENTS"&&f=="VIDEOREADY"){var c=a.source.toUpperCase();if(i.videoBoxMap[c]){var q=i.videoBoxMap[c];if(q.markPlaying){q.markPlaying(a.id)}if(q.findNext){var u=q.findNext(q.domEle.find(".playing"));
var r=q.domEle.find("iframe")[0].contentWindow;var d=u.attr("data-msid")||"";if(r.TimesApps&&r.TimesApps.Vod_Player&&r.TimesApps.Vod_Player.addNextVideoToList){r.TimesApps.Vod_Player.addNextVideoToList(d)}}}}},_processSystemInitiatedEvents:function(o){var c=o[0];var d=o[1];var f=typeof o[2]=="string"&&o[2].toUpperCase();var a=d.source.toUpperCase();if(f=="VIDEOREADY"){j._pauseVideosNotInFocus.call(null,[c,d,f]);if(j._checkIfVideoShouldPause(a)){j._pauseVideo(a)}}else{if(f=="LIVE_TV_LOADED"||f=="MG_LOADED"||f=="MINI_TV_LOADED"||f=="GAANA_PLAYER_LOADED"||f=="VOD_LOADED"||f=="PLAYER_LOADED"){var p=d.domSelector;
var e=o[3];if(f=="LIVE_TV_LOADED"||f=="MINI_TV_LOADED"||f=="GAANA_PLAYER_LOADED"||f=="VOD_LOADED"||f=="PLAYER_LOADED"){j._turnOffAutoPlayForAll()}if(f=="MINI_TV_LOADED"){TimesApps.overlayModule&&TimesApps.overlayModule.close()}var b=(d.userInitiated==true)?false:true;j._registerOtherTypePlayers(a,p,e,b,d.msid)}}},_checkIfVideoShouldPause:function(a){var b=i.videoBoxMap[a];if(b.getStatus()==g.PAUSED){return true}return false},_pauseVideo:function(a){var b=i.videoBoxMap[a];if(b&&typeof b.pauseVideo=="function"){b.pauseVideo()
}},_pauseVideosNotInFocus:function(b){var t=b[0];var a=b[1];var q=typeof b[2]=="string"&&b[2].toUpperCase();var c=a.source.toUpperCase();if(q=="PLAYING"||q=="VIDEOREADY"||q=="START"){if(i.videoBoxMap[c]){var f=i.videoBoxMap[c]}var e=Object.keys(i.videoBoxMap);for(var d=0;d<e.length;d++){var c=e[d].toUpperCase();var r=i.videoBoxMap[c];if(c!=f.getId()){r.setStatus(g.PAUSED);j._pauseVideo(c)}}}},_playNext:function(f){var e=f[0];var c=f[1];var b=f[2];var a=c.source.toUpperCase();if(b.videoBoxMap[a]){var d=b.videoBoxMap[a];
if(d&&typeof d.playNext=="function"){d.playNext()}}},_toggleAutoPlay:function(c){var a=c[0];var b=c[1];localStorage.setItem(g.AUTOPLAY_LOCALSTORAGE_KEY,b.stxt)},_addNewVideo:function(c,d){var a=c.id;var b=new TimesApps.VideoBox(c,d);i.videoBoxMap[a]=b;i.videoCount++},_addOtherTypeVideo:function(b,a,d,c,f){var e=h._createVideoObjForOtherTypePlayer(b,a,d,c,f);i.videoBoxMap[b]=e;i.videoCount++},_turnOffAutoPlayForAll:function(){var a=Object.keys(i.videoBoxMap);for(var d=0;d<a.length;d++){var b=a[d].toUpperCase();
var c=i.videoBoxMap[b];if(typeof c.setAutoPlay=="function"){c.setAutoPlay(false)}}},_registerOtherTypePlayers:function(b,a,d,c,e){b=b.toUpperCase();j._addOtherTypeVideo(b,a,d,c,e)}};k={init:function(){return j._init()},addNewVideo:function(a,b){return j._addNewVideo(a,b)},getVideoCount:function(){return i.videoCount},getVideoList:function(){return i.videoBoxMap},pauseVideo:function(a){return j._pauseVideo(a)}};j._init();return k}());TimesApps.OtherVideoBox=function(i,j,l,k,g){this.id=i;this.domEle=$(j).eq(0);
this.status="PLAYING";this.pauseVideoCallBack=l;this.msid=g;this.config={autoplay:k||false};var h=this;this.domEle.on("click",function(a){h.setStatus("PLAYING")})};TimesApps.OtherVideoBox.prototype.getStatus=function(){return this.status};TimesApps.OtherVideoBox.prototype.setStatus=function(b){this.status=b};TimesApps.OtherVideoBox.prototype.getId=function(){return this.id};TimesApps.OtherVideoBox.prototype.pauseVideo=function(){if(typeof this.pauseVideoCallBack=="function"){this.pauseVideoCallBack()
}else{if(typeof this.domEle.prop("contentDocument")=="undefined"){return}var b=this.domEle.prop("contentDocument").embeds.myMovie;if(typeof b=="undefined"){return}this.setStatus("PAUSED");b.pauseVideo()}};TimesApps.overlayModule=(function(l){var n,h,m,k,i,j;i={defaultHtml:'<div id="vcw" class="jOverlay video-overlay-wrapper"><div class="inner"><div class="buttonContainer"><span class="jToggleOverlay expand"></span><button type="button" class="closebtn"></button></div><div class="video-content"></div></div></div>'};
k={html:"",videosection:"toi",source:"toi",pg:"toi",isFullscreen:false,allowDock:false};m={isOverlayOpen:false};j=function(){l("#vcw .closebtn").off("click").on("click",n._close);l("#vcw .jToggleOverlay").off("click").on("click",n._toggleOverlayAndDock)};n={_init:function(){l(document).on("keyup",function(a){if(a.keyCode==27){n._close()}})},_create:function(a){m=l.extend({},k,a);n._render(m.html);j()},_render:function(c){if(!l("#vcw").length){var b=(l(".sidebar").length?l(".sidebar"):l(".sidebar2")).eq(0);
var a=b.closest(".wrapper").length?b.closest(".wrapper"):l(".wrapper");a.eq(0).append(i.defaultHtml)}if(m.isFullscreen){l(".jOverlay").addClass("fullscreen");l("body").addClass("overflowHidden")}else{l(".jOverlay").removeClass("fullscreen")}l("#vcw .video-content").html(c);l("#vcw").fadeIn(500);m.isOverlayOpen=true;if(!m.allowDock){l(".jToggleOverlay").addClass("hidden")}},_close:function(){l("body").removeClass("overflowHidden");l("#vcw").fadeOut(500,function(){l("#vcw").remove()});m.isOverlayOpen=false;
require(["tiljs/event"],function(a){a.publish("overlayClosed",{id:m.id})})},_isOverlayOpen:function(){return m.isOverlayOpen},_getSidebarDimenions:function(){var d={leftOffset:0,width:0};var c=(l(".sidebar").length?l(".sidebar"):l(".sidebar2")).eq(0);if(!c.length){return d}d.width=c.width()+"px";var b=0;var a=c.closest(".wrapper").length?c.closest(".wrapper"):l(".wrapper");if(a.length){b=a.offset().left+parseInt(a.css("padding-left"));b=Math.abs(b)}d.leftOffset=(c.offset().left-b)+"px";return d},_positionDock:function(){var b=l(".jOverlay");
var a=n._getSidebarDimenions();b.css({"margin-left":a.leftOffset,width:a.width}).addClass("belowHeader");l("#gaanaplayer").addClass("shifttoleft")},_toggleOverlayAndDock:function(a){if(!m.allowDock){return}var b=l(".jOverlay");b.toggleClass("video-overlay-wrapper fullscreen dockedVideo fixed animateDock dockedVideoSize").removeClass("belowHeader").css({"margin-left":"",width:""});l("body").toggleClass("overflowHidden");if(m.isOverlayOpen){m.isOverlayOpen=false;n._positionDock();require(["tiljs/event"],function(c){c.publish("overlayClosed",{id:m.id});
c.publish("onOverlayDock",{id:m.id})})}else{m.isOverlayOpen=true;require(["tiljs/event"],function(c){c.publish("overlayOpen",{id:m.id})})}}};h={init:function(){n._init()},create:function(a){n._create(a)},close:function(){n._close()},isOverlayOpen:function(){return n._isOverlayOpen()},getSidebarPosition:function(){return n._getSidebarDimenions()}};return h}(jQuery));TimesApps.overlayModule.init();TimesApps.VideoListPlayer=(function(){var i,j,g,f,h;f={iframeHtml:'<iframe allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true" id="videosrc"></iframe>'};
g={videoList:$(".jVideoList")};h={currentVideo:undefined,pageUrl:undefined,playerType:"",isOverlayOpen:false,isDocked:false,vidSource:""};bindEvents=function(){if($("#container.articleshow").length){$("body").on("click",".jVideoList [data-plugin='vidPlay']",i._handleClick);$("body").on("click",".jVideoList [data-plugin='vidOverlay']",i._handleClick)}else{$(".jVideoList").on("click","[data-plugin='vidPlay']",i._handleClick);$(".jVideoList").on("click","[data-plugin='vidOverlay']",i._handleClick)}$(document).on("VOD_EVENTS",i._handlePlayerEvents);
require(["tiljs/event"],function(a){a.subscribe("overlayClosed",i._onOverlayClose);a.subscribe("overlayOpen",i._onOverlayOpen);a.subscribe("onOverlayDock",i._onOverlayDock)});require(["tiljs/event"],function(a){a.subscribe("onVideoOverlayOpen",i._updatePageUrl);a.subscribe("onVideoOverlayOpen",i._triggerAnalyticsForDockOverlayEvents);a.subscribe("onVideoOverlayUpdate",i._triggerAnalyticsForDockOverlayEvents);a.subscribe("onVideoDock",i._triggerAnalyticsForDockOverlayEvents);a.subscribe("onVideoOverlayUpdate",i._updatePageUrl);
a.subscribe("onVideoOverlayUpdate",i._triggerAnalytics);a.subscribe("onVideoOverlayUpdate",i._markPlaying)})};i={_triggerAnalyticsForDockOverlayEvents:function(c){if(!c.vidSource){return}var b=window.ga;var a;if(TimesApps.dockVideo.getStatus("isDocked")||h.isDocked){a="Video-Dock_Player"}else{if(TimesApps.dockVideo.getStatus("isOverlayOpen")||c.isOverlay){a="Video-Overlay_Player"}}if(!(b&&a)){return}var d=toiprops.seoLocation||"";d+="-"+c.vidSource||"";var e="Parent-"+(h.pageUrl||"");e+="-Child-";
if(c.vidUrl){e+=c.vidUrl}else{e+=c.msid}b("send",{hitType:"event",eventCategory:a,eventAction:d,eventLabel:e})},_savePageUrl:function(){h.pageUrl=window.location.pathname},_triggerAnalytics:function(b){var a=b.title;var c=b.url;if(typeof ga!="undefined"){ga("send",{hitType:"pageview",page:c,title:a,location:location.protocol+"//"+location.hostname+c})}if(typeof(fireComscore)=="function"){fireComscore()}if(typeof(pSUPERFLY)!="undefined"&&typeof(pSUPERFLY.virtualPage)=="function"){pSUPERFLY.virtualPage(c,a)
}},_updatePageUrl:function(a){if(!h.isOverlayOpen){return}if(!(a&&a.url)){return}history.pushState(null,null,a.url)},_updateTitle:function(){},_getVideoSrc:function(c,a){var d=$(c);h.currentVideo=c;var e=d.data("msid");var o=i._getNextVideo(c);var n=o.data("msid")||"";var p=d.closest("[data-secid]").data("secid");if(!p){p=d.closest(".video-category").find("[data-secid]").data("secid")||""}h.vidSource=d.closest("[data-ga-source]").data("ga-source")||"";var b="/vod_player.cms?msid=";b+=e;b+="&videosection="+(d.closest("[data-slike-sec]").data("slike-sec")||"");
b+="&source="+h.vidSource;b+="&nextid="+n;b+="&audio=80";b+="&secId="+p;b+="&autoplay=1";b+="&type=vidOverlay";b+="&utm_source=DesktopHome&utm_medium=LatestNews&utm_campaign=VideoPlug&pg=toihp";b+="&version=11";if(a&&a!="false"){b+="&userInitiated=1"}else{b+="&userInitiated=0"}return b},_loadVideoInOverlay:function(w,a){var b=$(w);var d=$(b).data("msid");var x=i._getVideoSrc(w,a);var u=document.createElement("div");$(u).html(f.iframeHtml);$(u).find("iframe").attr("src",x);var c=b.find(".w_tle a").text();
var e=$("<p>").addClass("jTitle title").text(c);$(u).append(e);var t=false;var r=require("tiljs/is").desktop();if(r&&i._getPlayerType()=="VIDOVERLAY"){t=true}TimesApps.overlayModule.create({id:d,html:u.innerHTML,isFullscreen:true,allowDock:t});h.isOverlayOpen=true;var c=b.find("a").attr("title");var v=b.find("a").attr("href");i._savePageUrl();var y={title:c,url:v,vidSource:h.vidSource,vidUrl:v,msid:d,isOverlay:true};require("tiljs/event").publish("onVideoOverlayOpen",y)},_fetchPlaylist:function(d,a,b,n,c,p){var e="/wdt_videolist.cms?v=1954&msid="+n+"&config.perpage=10&tmpl=videoshow&img=200&tag=videopllist&pg=AS_RHS_Overlay~Videos!TopVideo&classname=vidOverlay";
var o=p?p:e;$.ajax({url:o,contentType:"text/html",dataType:"html",type:"GET"}).done(function(z){if(!(z&&z.length)){return}var m=$("<div>").addClass("slideshowbox");m.append("<div>").addClass("jPlaylist playlist").attr("data-plugin","videos_section_slider").html(z);if(!m.find("ul li").length){return}if(!m.find("ul [data-msid='"+b+"']").length){var l=m.find("ul li").eq(0).clone();var x=l.data("msid");var C=new RegExp(x,"g");var A=l.find("img").attr("data-src").replace(C,b);var B=a.find(".w_tle a").eq(0).text();
l.attr("data-msid",b).find("img").attr("data-src",A);l.find(".w_tle a").eq(0).text(B);m.find("ul").prepend(l)}else{var k=m.find("ul [data-msid='"+b+"']");var y=k.clone();k.remove();m.find("ul").prepend(y)}m.find("[data-msid='"+b+"']").addClass("active");if(typeof c=="function"){c(m)}})},_addPlaylist:function(c){var e=$(".video-content");var d=function(l){if(i._getPlayerType()=="VIDOVERLAY"){e.find(".jPlaylist").remove();e.append(l)}else{if(i._getPlayerType()=="VIDPLAY"){e.find(".jPlaylist").remove();
e.append(l)}}var k=e.find(".jPlaylist");k.off().on("click","[data-plugin='vidOverlay']",i._changeVideo);videos_section_slider.init(k);setTimeout(function(){require("tiljs/plugin/lazy").load()},1000)};var a=$(c.target).closest("[data-plugin='vidOverlay']");var b=a.data("msid");var m=a.closest(".video-category").find("[data-secid]").data("secid")||"";var n=a.closest("[data-source-url]").data("source-url")||"";if(!m){m=a.closest("[data-secid]").data("secid")||""}i._fetchPlaylist(c,a,b,m,d,n)},_changeVideo:function(c){c.preventDefault();
var d=this;h.currentVideo=d;var a=i._getVideoSrc(d,true);$(".jOverlay").find("iframe").attr("src",a);var b=$(d).find("a").attr("title");var e=$(d).find("a").attr("href");require("tiljs/event").publish("onVideoOverlayOpen",{title:b,url:e})},_onOverlayClose:function(a){i._updatePageUrl({url:h.pageUrl});h.isOverlayOpen=false},_onOverlayOpen:function(b){var c=$(h.currentVideo);var a=$(c).find("a").attr("title");var d=$(c).find("a").attr("href");h.isOverlayOpen=true;h.isDocked=false;var e={title:a,url:d,isOverlay:true,vidSource:h.vidSource};
require("tiljs/event").publish("onVideoOverlayOpen",e)},_onOverlayDock:function(){var a=$(h.currentVideo);var b=$(a).data("msid");var c=$(a).find("a").attr("href");h.isOverlayOpen=false;h.isDocked=true;var d={vidSource:h.vidSource,vidUrl:c,msid:b,isDocked:true};require("tiljs/event").publish("onVideoDock",d)},_handleClick:function(a){a.preventDefault();var b=$(".jOverlay");b.find(".jToggleOverlay").trigger("click");TimesApps.dockVideo&&TimesApps.dockVideo.close();var d=this;var c=$(this).data("plugin")||"";
h.playerType=c.toUpperCase();i._loadVideoInOverlay(d,true);if(i._getPlayerType()=="VIDOVERLAY"||i._getPlayerType()=="VIDPLAY"){i._addPlaylist(a)}},_handlePlayerEvents:function(c,b,d){c.preventDefault();var a=b.source||"";a=a.toUpperCase();switch(d.toUpperCase()){case"ONNEXTVIDEOPLAY":if(i._getPlayerType()=="VIDPLAY"){i._playNext(b.userInitiated)}break;case"VIDEOREADY":if(i._getPlayerType()=="VIDOVERLAY"){i._updateUi(b)}break;case"PLAYING":if(a=="ABOVEARTICLE"&&!TimesApps.dockVideo.getStatus("isOverlayOpen")){TimesApps.dockVideo.setStatus("overlayClosedByUser",false)
}}},_getNextVideo:function(a){var a=$(a);var b=a.next();if(b.length==0){b=a.siblings().eq(0)}return b},_playNext:function(a){if(!h.currentVideo){return}var b=$(h.currentVideo);h.currentVideo=b;var c=i._getNextVideo(b);i._updatePageUrl({url:$(c).find("a").attr("href")});i._loadVideoInOverlay(c,a)},_updateUi:function(l){var b=$(".jOverlay").find(".jPlaylist");var c=$("ul [data-msid='"+l.id+"']").eq(0);h.currentVideo=c;var a=c.find(".w_tle a").eq(0).text()||"";var d=$(".jOverlay");d.find(".jTitle").text(a);
var e=c.find("a").attr("href")||"";require("tiljs/event").publish("onVideoOverlayUpdate",{url:e,obj:l,playlistDom:b,title:a})},_markPlaying:function(c){if(!(c&&c.playlistDom&&c.obj)){return}var a=c.playlistDom;var b=c.obj;var d;if(b&&b.id){d=b.id}else{if(c.currentVideo){d=c.currentVideo.attr("msid")}}a.find("li").removeClass("active");a.find("ul [data-msid='"+d+"']").addClass("active")},_getPlayerType:function(){return(h.playerType||"").toUpperCase()},_init:function(){if(!(g.videoList.find("[data-plugin='vidPlay']").length||g.videoList.find("[data-plugin='vidOverlay']").length)){return
}bindEvents();i._savePageUrl()}};j={init:function(){return i._init()},savePageUrl:function(){i._savePageUrl()},getVideoSrc:function(b,a){return i._getVideoSrc(b,a)},fetchPlaylist:function(d,a,b,e,c,l){return i._fetchPlaylist(d,a,b,e,c,l)}};i._init();return j})();TimesApps.dockVideo=(function(j){var l,g,h,k,i;k={isDocked:false,isDragged:false,isOverlayOpen:false,overlayClosedByUser:false,msid:undefined,vidContainer:undefined,vidSource:undefined};data={vidUrl:""};i=function(){require(["tiljs/event"],function(a){a.subscribe("VOD_EVENTS",function(d){if(!d instanceof Array){return
}var b=d[1]||{};var c=(b.source||"").toUpperCase();var e=(d[2]&&typeof d[2]=="string")?d[2].toUpperCase():"";if(c.indexOf("ABOVEARTICLE")>-1&&e=="VIDEOREADY"){if(!k.vidContainer){k.vidSource=c;k.vidContainer=j(".articlevideo[data-msid='"+b.id+"']").find(".vidContainer");k.vidScrollContainer=k.vidContainer.closest(".articlevideo");require("tiljs/event").subscribe("window.scroll",l._handleVideoPosition)}else{if(k.vidSource!=c){l._close(true);k.vidSource=c;k.vidContainer=j(".articlevideo[data-msid='"+b.id+"']").find(".vidContainer");
k.vidScrollContainer=k.vidContainer.closest(".articlevideo")}else{if(!l._getStatus("isOverlayOpen")){k.overlayClosedByUser=false;k.vidContainer=j(".articlevideo[data-msid='"+b.id+"']").find(".vidContainer")}}}if(l._getStatus("isOverlayOpen")){l._updateOverlay(b)}else{if(k.isDocked){l._updateDock(b)}}k.vidContainer.off().on("click",".jToggleOverlay",l._expandCollapseOverlay);k.vidContainer.on("click",".jClose",l._close)}else{if(c.indexOf("ABOVEARTICLE")>-1&&e=="PLAYING"){k.overlayClosedByUser=false
}}j(document).on("keyup",function(f){if(f.keyCode==27){l._close()}})})})};l={_makePlayerDraggable:function(){},_handleVideoPosition:function(){if(k.isOverlayOpen){return}var c=k.vidScrollContainer;var d=j("#skew").val()||50;var a=require("tiljs/ui").inView(j("#header .sub-header"),true,100);var b=require("tiljs/ui").inView(c,true,-280);if(b&&k.isDocked){l._closeDock();k.isDragged=false}else{if(!b&&!k.isDragged&&!k.isDocked&&!a){l._dockPlayer()}}},_dockPlayer:function(e){var p=k.vidContainer;if(!k.isDocked&&!k.overlayClosedByUser){if(!p.find(".buttonContainer").length){var q='<div class="buttonContainer jDockButton"><span class="jToggleOverlay expand"></span>';
q+='<span class="jClose close"></span></div>';p.prepend(q)}else{p.find(".buttonContainer").removeClass("hidden")}k.isDocked=true;k.msid=p.find("iframe").data("videomsid");var c=p.closest("#container.articleshow #content").find(".title_section .heading1").text();var b=TimesApps.overlayModule.getSidebarPosition();if(!p.find(".jTitle").length){var f=j("<p>").addClass("jTitle title").text(c);p.addClass("dockedVideo fixed animateDock dockedVideoSize belowHeader").css({"margin-left":b.leftOffset,width:b.width}).append(f)
}else{p.addClass("dockedVideo fixed animateDock dockedVideoSize belowHeader").css({"margin-left":b.leftOffset,width:b.width}).find(".jTitle").text(c).removeClass("hidden")}j("#gaanaplayer").addClass("shifttoleft");TimesApps.overlayModule.close();p.one("animationend webkitTransitionEnd transitionend webkitAnimationEnd oAnimationEnd MSAnimationEnd",function(m){m.stopPropagation();m.stopImmediatePropagation();p.addClass("animationEnd")});p.removeClass("animationEnd");var d=j(".articlevideo").attr("data-msid")||window.msid;
var a="/photo/"+d+".cms";j(".vidbox").css("background-image","url("+a+")");var r={vidSource:k.vidSource,vidUrl:data.vidUrl,msid:k.msid,isDocked:true};require("tiljs/event").publish("onVideoDock",r)}},_expandToOverlay:function(){k.isOverlayOpen=true;k.isDocked=false;var a=j(".vidContainer");a.addClass("expand-overlay").removeClass("dockedVideo fixed animateDock dockedVideoSize belowHeader").css({"margin-left":"",width:""}).off("mousedown");if(a.parent().find(".expand-overlay-box").length){j("<div>").addClass("expand-overlay-box").insertBefore(a)
}j("body").addClass("overflowHidden");TimesApps.VideoListPlayer.savePageUrl();var b={vidSource:k.vidSource,vidUrl:data.vidUrl,msid:k.msid,isOverlay:true};require("tiljs/event").publish("onVideoOverlayOpen",b)},_collapseToDock:function(){k.isOverlayOpen=false;k.isDocked=true;var b=j(".vidContainer");j("body").removeClass("overflowHidden");var a=TimesApps.overlayModule.getSidebarPosition();b.removeClass("expand-overlay").addClass("dockedVideo fixed animateDock dockedVideoSize belowHeader").css({"margin-left":a.leftOffset,width:a.width}).off("mousedown");
var c={vidSource:k.vidSource,vidUrl:data.vidUrl,msid:k.msid,isDocked:true};require("tiljs/event").publish("onVideoDock",c)},_expandCollapseOverlay:function(c){if(k.isDocked){k.isDocked=false;l._expandToOverlay();var d=function(f){var n=j(".vidContainer");n.find(".jPlaylist").remove();n.append(f);n.find(".jPlaylist").off().on("click","[data-plugin='vidOverlay']",l._changeVideoInOverlay);videos_section_slider.init(j(".jPlaylist"));setTimeout(require("tiljs/plugin/lazy").load(),1000)};var a=k.vidScrollContainer;
var b=k.vidScrollContainer.find("iframe").contents().find("#msid").val()||"";var e=k.vidScrollContainer.find("iframe").contents().find("#sectionId").val()||"";TimesApps.VideoListPlayer.fetchPlaylist(c,a,b,e,d)}else{l._collapseToDock()}},_changeVideoInOverlay:function(c){c.preventDefault();var d=j(this);var a=TimesApps.VideoListPlayer.getVideoSrc(d,true);k.vidContainer.find("iframe").attr("src",a);var b=d.find("a").attr("title");var e=d.find("a").attr("href");k.vidContainer.find(".jPlaylist li").removeClass("active");
d.addClass("active");k.vidContainer.find(".jTitle").text(b);data.vidUrl=e;var f={url:e,obj:undefined,playlistDom:k.vidContainer,title:b,vidSource:k.vidSource,vidUrl:data.vidUrl,isOverlay:true};require("tiljs/event").publish("onVideoOverlayUpdate",f)},_removePlaylist:function(){j(".jPlaylist").remove()},_closeDock:function(){j(".vidbox").css("background-image","").css("background-color","black");j(".vidContainer").removeClass("dockedVideo animateDock dockedVideoSize fixed belowHeader").css({"margin-left":"",width:""}).find(".jTitle").addClass("hidden");
k.isDocked=false;l._removeButtons()},_closeOverlay:function(){k.isOverlayOpen=false;l._removePlaylist();j(".vidContainer").removeClass("expand-overlay").find(".jTitle").addClass("hidden");j("expand-overlay-box").addClass("hidden");l._removeButtons();j("body").removeClass("overflowHidden");require(["tiljs/event"],function(a){a.publish("overlayClosed",{})})},_close:function(a){if(!k.vidScrollContainer){return}if(a===true){k.overlayClosedByUser=false}else{k.overlayClosedByUser=true}if(k.isDocked){l._closeDock()
}else{l._closeOverlay()}var b=k.vidScrollContainer.find("iframe");if(b&&b[0]&&b[0].contentWindow&&b[0].contentWindow.TimesApps.VideoPlayer2.getPlayer("VOD")&&b[0].contentWindow.TimesApps.VideoPlayer2.getPlayer("VOD").pause){b[0].contentWindow.TimesApps.VideoPlayer2.getPlayer("VOD").pause()}},_removeButtons:function(){j(".vidContainer").find(".buttonContainer").addClass("hidden")},_getStatus:function(a){return k[a]},_setStatus:function(b,a){k[b]=a},_isVideoDocked:function(){var a={status:false,id:undefined};
if(k.isDocked){a={status:true,id:k.msid}}return a},_updateTitle:function(b){var a=b.title||"";k.vidContainer.find(".jTitle").text(a)},_updateOverlay:function(b){l._updateTitle(b);var a=k.vidContainer.find(".jPlaylist");var d=k.vidContainer.find(".jPlaylist ul [data-msid="+b.id+"]");if(!(d&&d.length)){return}var e=d.eq(0).find("a").attr("href")||"";var c={url:e,obj:b,playlistDom:a,title:title,isOverlay:true};require("tiljs/event").publish("onVideoOverlayUpdate",c)},_updateDock:function(a){l._updateTitle(a)
},_init:function(){i()}};g={getStatus:function(a){return l._getStatus(a)},setStatus:function(b,a){l._setStatus(b,a)},isVideoDocked:function(){return l._isVideoDocked()},close:function(a){return l._close()}};l._init();return g}(jQuery));define("gaanaplayer",["jquery","tiljs/logger","tiljs/is"],function(h,j,i){var f={};var g=false;f.api={init:function(){TimesApps.checkGdprAndCall&&TimesApps.checkGdprAndCall(f.fn._init,null)}};f.utils={checkIfIE:function(){var a=window.navigator.userAgent;var b=a.indexOf("MSIE ");
if(b>0||!!navigator.userAgent.match(/Trident.*rv\:11\./)){return true}else{return false}}};f.fn={_bindEvents:function(){h("#gaanaplayer .box_head").on("click",function(a){a.preventDefault();a.stopImmediatePropagation();if(h(this).closest("#gaanaplayer").hasClass("active")){f.fn._analyticsFire("Gaana widget","Minimize",window.location.href);f.fn._removeCloseBtn();h("#gaanaplayer").removeClass("active")}else{f.fn._analyticsFire("Gaana widget","Open",window.location.href);h("#gaanaplayer").addClass("active");
f.fn._addCloseBtn();f.fn._setIframeLink()}});h(document).on("videodash.userAction videodash.videoEvents LIVE_TV_EVENTS MINI_TV_EVENTS",function(b,a,c){f.fn._handleVideodashEvents(b,a,c)});h(window).on("beforeunload",function(b){g=true;if(document.getElementById("gaanatvplayer")&&document.getElementById("gaanatvplayer").contentWindow){var a=document.getElementById("gaanatvplayer");a.contentWindow.postMessage("close_browser","*")}});h(window).unload(function(){if(!g){var a=document.getElementById("gaanatvplayer");
a.contentWindow.postMessage("close_browser","*")}});h(".gaanaplayer_box .box_head").on("click",".close_gaanaplayer",function(b){b.preventDefault();var a=document.getElementById("gaanatvplayer");a.contentWindow.postMessage("close_gaanawidget","*");f.fn._analyticsFire("Gaana widget","Close",window.location.href);f.fn._closeGaanaplayer()});window.addEventListener("message",f.fn._messageHandler,false)},_createUI:function(){var a=h('<div class="gaanaplayer_box" id ="gaanaplayer_box"></div>');var c=h('<div class="box_head"><span class="gaanaplayer_title"><img src="/photo/58243404.cms" alt="gaana icon" /> of the Day</span></div>');
var b=h('<iframe frameborder="0" width="100%" height="310px" id="gaanatvplayer" class="jLivePlayer"></iframe>');a.append(c).append(b);h("#gaanaplayer").append(a)},_analyticsFire:function(b,a,c){if(window.ga){ga("send","event",b,a,c,{nonInteraction:1})}else{setTimeout(function(){ga("send","event",b,a,c,{nonInteraction:1})},5000)}return true},_init:function(){h("#gaanatvplayer").attr("src","");if(typeof i.IE=="function"&&i.IE()){h("#gaanaplayer").hide()}else{if(h("#minitv #streaming_box")&&h("#minitv #streaming_box").is(":visible")){h("#gaanaplayer").addClass("shifttoleft")
}f.fn._createUI();h("#gaanaplayer").show();f.fn._bindEvents()}},_addCloseBtn:function(){var a=h('<a class="close_gaanaplayer"></a>');h(".gaanaplayer_box .box_head").append(a)},_removeCloseBtn:function(){h(".gaanaplayer_box .box_head .close_gaanaplayer").remove()},_messageHandler:function(a){var b="https://gaana.com";if(a.origin==b){var c=a.data.status.replace(/\s/g,"").toLowerCase();if(c=="play"){f.fn._analyticsFire("Gaana widget","Play",a.data.title);f.fn._gaanaplayed()}else{if(c=="pause"){f.fn._analyticsFire("Gaana widget","Pause",a.data.title);
f.fn._gaanapaused()}else{if(c=="languagedropdownopen"){f.fn._analyticsFire("Gaana widget","Drop down open",window.location.href)}else{if(c=="languagechange"){f.fn._analyticsFire("Gaana widget","Language",a.data.value)}else{if(c=="loading"){f.fn._analyticsFire("Gaana widget","Loading",a.data.title);f.fn._gaanaplayed()}else{if(c=="seekbackward"){f.fn._analyticsFire("Gaana widget","Seek backward",a.data.title)}else{if(c=="seekforward"){f.fn._analyticsFire("Gaana widget","Seek forward",a.data.title)}}}}}}}}},_pauseGaanaplayer:function(){document.getElementById("gaanatvplayer").contentWindow&&document.getElementById("gaanatvplayer").contentWindow.postMessage("pause","*")
},_closeGaanaplayer:function(){h("#gaanaplayer").remove()},_pauseAndMinimizePlayer:function(){f.fn._pauseGaanaplayer();h("#gaanaplayer").removeClass("active");f.fn._removeCloseBtn()},_gaanaplayed:function(){h(document).trigger("GAANA_PLAYER_EVENTS",[{source:"GAANA_PLAYER"},"playing"])},_gaanapaused:function(){h(document).trigger("GAANA_PLAYER_EVENTS",[{source:"GAANA_PLAYER"},"paused"])},_triggerPlayerLoaded:function(){h(document).trigger("GAANA_PLAYER_LOADED",[{source:"GAANA_PLAYER"},"GAANA_PLAYER_LOADED",f.fn._pauseAndMinimizePlayer])
},_playGaanaplayer:function(){document.getElementById("gaanatvplayer").contentWindow&&document.getElementById("gaanatvplayer").contentWindow.postMessage("play","*")},_setIframeLink:function(){if(!h("#gaanatvplayer").attr("isloadedfirsttime")){f.fn._triggerPlayerLoaded();var a=f.data.iframeurl;h("#gaanatvplayer").attr("src",a).attr("isloadedfirsttime","true");h("#gaanatvplayer").on("load",function(){document.getElementById("gaanatvplayer").contentWindow&&document.getElementById("gaanatvplayer").contentWindow.postMessage("open_gaanawidget","*")
})}},_handleVideodashEvents:function(a,b,d,c){if(d.toUpperCase()=="START"){f.fn._pauseGaanaplayer()}}};f.data={iframeurl:h("#gaanatvplayer").attr("data_src")||"https://gaana.com/gaanawidget-v7"};return f.api});define("onetapsignin",["tiljs/cookie","tiljs/ui","tiljs/login","tiljs/event"],function(m,j,i,l){var n={clientId:"103703403489-b4t4lt8mr05brqpcdrmsu0di54cmjv4f.apps.googleusercontent.com",scriptURL:"https://smartlock.google.com/client",jssoAPIru:"bchjqhklhblchbhjglh1wbfbv",jssoAPIGetURL:"https://jsso.indiatimes.com/sso/services/gponetaplogin/verify",nextShowTimeInDays:15,nextShowCookieName:"oneTapNextShow",sessionDuration:10000,doNotInitiateOneTapByDefault:typeof __initializeOneTapForTOI!=="undefined"&&__initializeOneTapForTOI===false,module_name:"onetapsignin",yoloTimeout:5000};
var k={didPromiseReturn:false,didOneTapPopUpShow:false};var h={};h.jssoCallback=function(){var a=function(b){if(b){l.publish("user.login",b);h.attachPostLoginHTML(b)}ga("send","event","Login","One_Tap","Success_google")};i.isLoggedIn(a)};h.initiateAPI=function(g){var a=m.get("ssoid")||m.get("ssoId");var d,e=new Date();if(a){return}if(typeof g==="undefined"){g=function(){}}if(typeof window.googleyolo!=="object"){g();return}var c=function(){$("iframe").each(function(u,t){var r=$(t).attr("src");if(r&&r.indexOf("smartlock")>0){console.log("view");
ga("send","event","Login","One_Tap","View");clearInterval(window.iframeTimer)}})};window.iframeTimer=setInterval(c,2000);if(window.googleyolo){googleyolo=window.googleyolo;if(!n.doNotInitiateOneTapByDefault){try{if(typeof window.localStorage!=="undefined"){window.localStorage.setItem("onetap_session",e.getTime()+(12*60*60*1000))}}catch(b){}}}googleyolo.setTimeouts(n.yoloTimeout);var f=googleyolo.hint({supportedAuthMethods:["https://accounts.google.com"],supportedIdTokenProviders:[{uri:"https://accounts.google.com",clientId:n.clientId}]});
h.checkIfOneTapPromiseReceived();f.then(function(x){if(x.idToken){n.credential=x;var u=x.idToken;var v="toi";var y=n.jssoAPIru;var w=$.ajax({url:n.jssoAPIGetURL,method:"GET",data:{token:u,channel:v,ru:y},dataType:"jsonp",success:h.jssoCallback})}k.didPromiseReturn=true;k.didOneTapPopUpShow=true},function(p){k.didPromiseReturn=true;switch(p.type){case"userCanceled":ga("send","event","Login","One_Tap","Close");m.set(n.nextShowCookieName,"123",n.nextShowTimeInDays);k.didOneTapPopUpShow=true;break;case"noCredentialsAvailable":g();
ga("send","event","Login","One_Tap","ErrorNoCredentialsAvailable");break;case"requestFailed":g();ga("send","event","Login","One_Tap","ErrorTimesout");break;default:g();ga("send","event","Login","One_Tap",p.type)}})};h.checkIfOneTapPromiseReceived=function(){setTimeout(function(){var b=true,a=k[n.module_name];if(k.didPromiseReturn&&!k.didOneTapPopUpShow){b=false}a&&a.onShowCallback(b)},n.yoloTimeout)};h.setGoogleYoloLoadObj=function(a){window.googleyoloObj=a;if(!n.doNotInitiateOneTapByDefault){h.initiateAPI()
}};h.attachPostLoginHTML=function(b){var a='<div class="ontap-background id_postLogin hide"><div class="tap-message"><span class="success"></span><span class="text">Successfully signed in as '+b.getEmail()+'</span><span class="close id_onetapclose"></span></div></div>';var c=$(".top-area .row");if(c.length===1){c.append(a)}else{$("body").append(a)}$(".id_postLogin").slideToggle();$(".id_onetapclose").on("click",function(){$(".id_postLogin").slideToggle()});setTimeout(function(){var d=$(".id_postLogin");
if(d.is(":visible")){d.slideToggle()}},10000)};h.bindFunction=function(){window.onGoogleYoloLoad=h.setGoogleYoloLoadObj};h.loadjs=function(){(function(b,e,a){var c,d=b.getElementsByTagName(e)[0];if(b.getElementById(a)){return}c=b.createElement(e);c.id=a;c.src="https://smartlock.google.com/client";d.parentNode.insertBefore(c,d)}(document,"script","onetap-jssdk"))};h.loadAssets=function(){setTimeout(h.loadjs,n.sessionDuration)};h.registerWithPopupManager=function(){k[n.module_name]=TimesApps.PopUpManager.registerPopup(n.module_name,h.loadAssets)
};h.bindEvents=function(){if(window.TimesApps&&TimesApps.PopUpManager){h.registerWithPopupManager()}else{require(["tiljs/event"],function(a){a.subscribe("popUpManagerLoaded",h.registerWithPopupManager)})}};h.init=function(){h.bindEvents();var a=function(){var g=m.get(n.nextShowCookieName);var b=false;var p=m.get("ssoid")||m.get("ssoId");var f=new Date();var e;if(!p){h.bindFunction();if(n.doNotInitiateOneTapByDefault){return}try{if(typeof window.localStorage!=="undefined"){e=window.localStorage.getItem("onetap_session");
if(e&&e>f){b=true}}}catch(c){}var d=k[n.module_name];if(!g&&!b){d&&d.onReadyCallback(1)}else{d&&d.onReadyCallback(3)}}};TimesApps.checkGdprAndCall(a)};return h});define("tiljs/apps/times/usermanagement",["../../util","module","../../page","../../ajax","../times/api","../../is","../../cookie","../../ui","../../logger","../../event","../../load","../../localstorage","../../user"],function(ay,aE,aF,ai,aD,an,aj,ad,ak,S,X,ag,al){window.newLogin=true;var av={autoinit:false,multiuser:false,login:"",logout:"",check_user_status:"",mapping:null,renderer:true};
var ae=ay.extend(true,{},av,aE.config());var ao={fpNoEmailOrMobile:"Email/Mobile No. cannot be left blank.",fpInvalidEmail:"Enter a valid Email/Mobile No.",fpInvalidEmailOnly:"Enter a valid email.",fpInvalidMobileOnly:"Enter a valid mobile no.",accountUnregistered:"This account is not registered with us.",emptyPassword:"Password cannot be left blank.",emptyName:"Enter your full name.",wrongName:"Enter your name without special character or numbers.",wrongPassword:"Invalid Credentials",wrongMobile:"Invalid Mobile number.",wrongEmail:"Invalid Email Id.",expiredOTP:"The OTP you entered has expired.",limitExceeded:"Maximum number of unsuccessful attempts exceeded. Please try again later.",wrongOtp:"Enter valid OTP sent to your mobile no.",wrongOtpEmail:"Enter valid OTP sent to your email.",matchLastThree:"Password cannot match your last three passwords.",passwordMismatch:"Your passwords do not match.",captchaUnselected:"Select the checkbox to proceed.",tncNotSelected:"Accept Terms & Conditions to proceed.",userAlreadyRegistered:"This user is already registered with us.",serverError:"An error occurred while processing your request. Please try again later.",connectionError:"There was an error processing your request. Please check your internet connection and try again.",email_failure:"Username or password is incorrect. Please try again.",facebook_failure:"Username or password is incorrect. Please try again.",facebook_failure_user_denied:"Kindly authenticate facebook request. Please try again.",facebook_failure_no_email:"Could not login using this facebook account. Please try again with another account.",twitter_failure:"Kindly authenticate twitter request.",twitter_link_username_failure:"Username or password is incorrect. Please try again.",twitter_link_email_failure:"Email or password is incorrect. Please try again.",twitter_failure_unknown:"Kindly authenticate twitter request.",twitter_failure_user_denied:"Username or password is incorrect. Please try again.",twitter_failure_server_error:"Server did not respond. Please try again.",twitter_failure_already_exist:"It seems you have already registered with the Indiatimes network using this Email ID. Try linking your Twitter account with your existing Indiatimes account or use an alternate Email ID.",twitter_failure_invalid_email:"It seems you have entered and invalid Email ID. Try linking your Twitter account with your existing Indiatimes account or use an alternate Email ID.",unknown_error:"Unknown error has occurred. Please try again."};
var ab={oauthUrl:"https://jsso.indiatimes.com/sso/identity/login/socialLogin?channel={$channel}&oauthsiteid={$siteid}"};var aB={loginPopup:$("#login-popup"),closeBtn:$("#login-popup .close-btn")};var aq="",ax,W="",aH="",af="",at="Login_Screen",ac=false;var ah={};var aC="SINGLE_USER";var aA=function(){if(localStorage.getItem("_ssodata")!=null){__sso(JSON.parse(localStorage.getItem("_ssodata")));localStorage.removeItem("_ssodata")}};var e=function(b,a){V=ad.window(b,{width:850,height:780,scrollbars:0},function(c){if(c&&c.code==="200"){aG.isLoggedIn()
}else{if(a){a(null,c)}}});V.moveTo(315,250)};var aG={};var au=null;var U=null;var az=function(a){aw({error:{code:a,message:ae.messages[a]}})};var aw=function(a){U=a};var Y=function(){return;if(V){V.close();V=null}U=null};var ar=function(a){if(an.iframe(V)){V.src=a}else{V.document.location.href=a}};var Z=function(a,b){if(a==="facebook"){$("#sso-fblogin-error").html(ao[b]).show()}else{$("#sso-gplus-error").html(ao[b]).show()}};var am=function(b,c,a){ar(b);if(c){az(c)}else{if(a){aw(a)}}};var V=null;
var aa;if(ae.autoinit===true){aG.init()}try{document.domain=aF.getDomain()}catch(T){ak.info("Domain cannot be set:"+aF.getDomain())}if(navigator.userAgent.match("CriOS")){localStorage.removeItem("_ssodata");aa=aa||setInterval(function(){aA()},1000)}window.getLoginCallback=function(){return au};window.getLoginData=function(){return U};window.getDomain=function(){return aF.getDomain()};window.__sso=function(i,d){var c=aB.loginPopup;ak.log("__sso called");ak.log(i);ak.log(V);if(i&&V){ak.log(d);var g=U?U.data:null;
var b=i.closeWindow,h=i.status==="logout",f=i.status==="signinsuccess"||i.status==="ssosigninsuccess",a=(i.site==="facebook"||i.site==="googleplus")&&i.status==="MappingUpdated";i.site=i.site||"";if(b||h||f||a){ak.log("Close pressed, closing window / popup");V.close();$("#sso-fblogin-error, #sso-gplus-error").html("").hide();if(c.is(":visible")){aG.closeBtnHandler()}if(i.site&&(f||a)){aG.fireGAEvent(i.site==="googleplus"?"Login_Success_Google":"Login_Success_FB")}}else{if(i.status=="ssosigninfailure"&&i.ssoerror=="E119"){Z(i.site,"email_failure")
}else{if(i.status=="ssosigninfailure"&&i.ssoerror=="E104"){Z(i.site,"email_failure")}else{if(i.err=="E104"&&i.facebooktoken){Z(i.site,"facebook_failure_no_email")}else{if(i.status=="signinfailure"&&i.error=="F101"){Z(i.site,i.site+"_failure")}else{if(i.status=="signinfailure"&&i.error=="user_denied"&&i.site=="facebook"){Z(i.site,"facebook_failure_user_denied")}else{ak.warn("Login case not handled");Z(i.site,"unknown_error")}}}}}}}ak.log("Checking user status in __sso");aG.isLoggedIn(au)};aG.closeWindow=window.closeLoginWindow=function(){if(V){V.close()
}};aG.fireGAEvent=function(a){a+=("-"+window.location.pathname);ga("send","event","WEB_Login",aG.getScreenName(),a)};aG.showCaptcha=function(){return(navigator.userAgent.indexOf("Opera")===-1)};aG.registerFormSubmitted=function(a){ac=!!a};aG.setLoginWindowDimension=window.setLoginWindowDimension=function(a,b){if(V){V.resizeTo(a,b);if(V.reposition){V.reposition()}V.focus()}};aG.login=function(a,b,c){TimesApps.checkGdprAndCall(function(){aG.showLoginScreen(a);aB.loginPopup.addClass("active")},aG.logout)
};aG.loginWithTwitter=function(a){au=function(b){S.publish("user.login",b);if(a){a(b)}aG.closeBtnHandler()};Y();TimesApps.checkGdprAndCall(function(){var b=ab.oauthUrl.replace("{$channel}",aF.getChannel().toLowerCase()).replace("{$siteid}","twitter");e(b,a)},aG.logout)};aG.loginWithFacebook=function(a){au=function(b){S.publish("user.login",b);if(a){a(b)}aG.closeBtnHandler()};Y();aG.initiateFbLogin(a)};aG.initiateFbLogin=function(a){TimesApps.checkGdprAndCall(function(){aG.setScreenName("Login_Screen");
aG.fireGAEvent("Click_FB");var b=ab.oauthUrl.replace("{$channel}",aF.getChannel().toLowerCase()).replace("{$siteid}","facebook");e(b,a)},aG.logout)};aG.loginWithGoogle=function(a){au=function(b){S.publish("user.login",b);if(a){a(b)}aG.closeBtnHandler()};Y();aG.initiateGplusLogin(a)};aG.initiateGplusLogin=function(a){TimesApps.checkGdprAndCall(function(){aG.setScreenName("Login_Screen");aG.fireGAEvent("Click_Google");var b=ab.oauthUrl.replace("{$channel}",aF.getChannel().toLowerCase()).replace("{$siteid}","googleplus");
e(b,a)},aG.logout)};aG.showLoginScreen=function(a){au=function(c){S.publish("user.login",c);if(window.ga){ga("send","event","Login","Mast Head",document.location.href,{nonInteraction:1})}if(a){a(c)}};var b="";b+='<div id="toi-login"><div class="signin-section"><figure class="user-icon"><img src="/photo/63379366.cms" src="user-icon" /></figure><div id="socialConnectImgDiv"><button type="button" id="sso-fb-login" class="fb">Sign in with Facebook</button><span id="sso-fblogin-error" class="errorMsg"></span><button type="button" id="sso-gplus-login" class="gplus">Sign in with Google</button><span id="sso-gplus-error" class="errorMsg"></span></div><h4 class="heading small"><span>or go the traditional way</span></h4><form class="form" autocomplete="off"><ul><li class="input-field email"><p><input autocomplete="off" type="text" name="emailId" placeholder="Sign In/Sign Up with Email or Mobile No." maxlength="100" /></p><div class="errorMsg"></div><a href="javascript:void(0)" id="changeEmailIdDiv" class="secondary-link" style="display: none">Change Email Or Mobile No.</a></li><li class="input-field password" id="sso-pwdDiv"><p><input autocomplete="off" type="password" name="password" placeholder="Password" maxlength="14" /><span class="view-password"></span></p><div class="errorMsg"></div><a id="sso-generate-otp" href="javascript:void(0)" class="secondary-link">Generate OTP to Login</a></li><li id="sso-login-otp-msg" class="text-field"><p></p></li><li class="input-field password" id="sso-otpLoginDiv"><p><input type="password" name="otplogin" maxlength="6" placeholder="Enter the verification code"/></p><div class="errorMsg"></div><div class="successMsg"></div><span class="regenerate-otp">Didn\'t receive OTP?</span><a id="sso-regenerate-otp" href="javascript:void(0)" class="secondary-link">Re-Generate OTP</a></li><li id="sso-signInButtonDiv" class="submit"><input type="submit" class="submit-btn disabled" value="Continue" disabled="disabled" /></li></ul><a href="javascript:void(0)" id="sso-forgot-pass" class="forget-password">Forgot Password?</a></form></div><div class="powered-by"><img src="https://static.toiimg.com/photo/65257504.cms" /></div><div class="teams-logo"><span>One Network. One Account</span><a href="http://timesofindia.indiatimes.com/" target="_blank" class="toi"/><a href="http://economictimes.indiatimes.com/" target="_blank" class="et"/><a href="http://navbharattimes.indiatimes.com/" class="nbt" target="_blank"/><a href="http://maharashtratimes.indiatimes.com/" class="sm" target="_blank"/><a href="http://www.speakingtree.in/" class="st" target="_blank"/><a href="http://gaana.com/" class="gaana" target="_blank"/><a href="http://itimes.com/" class="itimes" target="_blank"/><a href="http://www.timespoints.com" class="tp" target="_blank"/></div></div>';
$("#user-sign-in").html(b)};aG.showRegisterScreen=function(a){var c=$('#toi-login input[name="emailId"]').val();var b=aG.getLoginType();var d="";d+='<div id="toi-register"><div class="signup-section"><h4 class="heading"><span>Complete Your Profile</span></h4><form class="form" action="#" autocomplete="off"><input type="hidden" id="register-inputVal" value="'+c+'"/><ul><li class="input-field '+(b!=="email"?"mobile-no":"email")+'"><p>'+(b!=="email"?'<span class="country-code">+91 - </span>':"")+'<input autocomplete="off" type="text" name="'+(b==="email"?"emailId":"mobile")+'" maxlength="100" disabled="disabled" value="'+c+'" /></p><a href="javascript:void(0)" id="changeRegisterEmailId" class="secondary-link">Change Email Or Mobile No.</a></li><li class="input-field user-name"><p><input autocomplete="off" type="text" name="fullname" placeholder="Full Name" maxlength="30" /></p><div class="errorMsg"></div></li><li class="input-field password"><p><input autocomplete="off" type="password" name="registerPwd" placeholder="Password" maxlength="14" /><span class="view-password"></span></p><div class="password-conditions"><p>Password must have:</p><ul><li id="charCnt" class="error">6-14 characters</li><li id="lwCnt" class="error">1 Lower case character (a-z)</li><li id="numCnt" class="error">1 Numeric character (0-9)</li><li id="spclCharCnt" class="error">1 special character (Such as #, $, %, &, !)</li></ul></div></li><li class="input-field password"><p><input autocomplete="off" type="password" name="registerCnfrmPwd" placeholder="Confirm Password" maxlength="14" /><span class="view-password"></span></p><div class="errorMsg"></div></li><li class="input-field '+(b==="email"?"mobile-no":"email")+'"><p>'+(b==="email"?'<span class="country-code">+91 - </span>':"")+'<input autocomplete="off" type="text" name="'+(b==="email"?"mobile":"emailId")+'" maxlength="'+(b==="email"?"10":"100")+'" placeholder="'+(b==="email"?"Mobile Number":"Email")+' (Optional)" /></p><div class="errorMsg"></div></li>';
if(aG.showCaptcha()){d+='<li class="recaptcha-wrapper"><div id="recaptcha-container"></div><div class="errorMsg"></div></li>'}d+='<li class="checkbox"><p><input type="checkbox" id="agree" name="agree" checked="checked"><label for="agree">I am at least 16 years old and agree with the<a href="https://www.indiatimes.com/termsandcondition/" target="_blank" rel="noopener noreferrer"> Terms & Conditions </a>and<a href="https://www.indiatimes.com/privacypolicy/" target="_blank" rel="noopener noreferrer"> Privacy Policy</a> of Times of India</label></p><div class="errorMsg"></div></li><li class="checkbox"><p><input type="checkbox" id="promotions" name="promotions" checked="checked"><label for="promotions">Send me offers and promotions</label></p><div class="errorMsg"></div></li><li class="checkbox"><p><input type="checkbox" id="sharedDataAllowed" name="sharedDataAllowed" checked="checked"><label for="sharedDataAllowed">Please show me personalized content and advertisements as per the <a href="https://www.indiatimes.com/privacypolicy/" target="_blank" rel="noopener noreferrer"> Privacy Policy</a></label></p><div class="errorMsg"></div></li><li class="submit"><input type="submit" id="sso-registerBtn" class="submit-btn" value="Update" /></li></ul></form></div></div>';
$("#user-sign-in").html(d);aG.setRecaptchaCode("");if(typeof grecaptcha==="object"&&aG.showCaptcha()){aH=grecaptcha.render("recaptcha-container",{sitekey:"6LcXeh0TAAAAAO1DsEX1iEF8n8-E_hQB67bIpxIw",theme:"light",callback:aG.recaptchaResponse,"error-callback":aG.recaptchaErrorCallback,"expired-callback":aG.recaptchaExpiredCallback})}};aG.showForgotPasswordScreen=function(a){var c=$('#toi-login input[name="emailId"]').val();var b=aG.getLoginType();var d="";d+='<div id="toi-forgot-password"><div class="signin-section"><h4 class="heading"><span>Forgot Password</span></h4><p id="forgot-password-sent">We have sent a 6 digit verification code '+(b!=="email"?"on <strong>+91-":"to <strong>")+c+'</strong></p><form class="form" autocomplete="off"><input type="hidden" id="fp-inputVal" value="'+c+'"/><ul><li class="input-field password"><p><input type="password" name="otpfp" maxlength="6" placeholder="Enter the verification code"/></p><div class="errorMsg"></div><div class="successMsg"></div><span class="regenerate-otp">Didn\'t receive OTP?</span><a id="sso-fp-regenerate-otp" href="javascript:void(0)" class="secondary-link">Re-Generate OTP</a></li><li class="input-field password"><p><input autocomplete="off" type="password" name="registerPwd" placeholder="Enter new password" maxlength="14" /><span class="view-password"></span></p><span class="subtext">Should not match last 3 passwords.</span><div class="errorMsg"></div><div class="password-conditions"><p>Password must have:</p><ul><li id="charCnt" class="error">6-14 characters</li><li id="lwCnt" class="error">1 Lower case character (a-z)</li><li id="numCnt" class="error">1 Numeric character (0-9)</li><li id="spclCharCnt" class="error">1 special character (Such as #, $, %, &, !)</li></ul></div></li><li class="submit"><input type="submit" id="sso-fp-btn" class="submit-btn disabled" value="Verify & Login" disabled="disabled" /></li></ul></form></div></div>';
$("#user-sign-in").html(d)};aG.showSignUpOtpScreen=function(h,j,i,a){var g=i&&i.length>0?i.split("#"):[];var k=g[0]||$("#register-inputVal").val();var c="";var b="";var f=aG.getLoginType();if(f==="email"&&j&&j.length){b="mobile"}else{if(g&&g.length>0){b="email"}else{if(f==="email"){b="email"}else{b="mobile"}}}aG.setPageName(b);if(j&&j.length){f="mobile";c=k;k=j}var d="";d+='<div id="toi-verifyotp-password"><div class="signin-section"><h4 class="heading"><span>Complete Your Profile</span></h4>';if(g.length>0){d+='<p class="mn-verified">Mobile number verified: <strong>+91-'+g[1]+'</strong><i class="tick"></i><p>Verify your email id</p>'
}else{d+="<p>We have sent a 6 digit verification code on your "+(f!=="email"?"Mobile Number":"Email Id")+"</p>"}d+='<form class="form" autocomplete="off"><input type="hidden" id="verify-inputVal" value="'+k+'"/><input type="hidden" id="verify-email" value="'+c+'"/><input type="hidden" id="verify-ssoid" value="'+h+'"/><input type="hidden" id="verify-logintype" value="'+f+'"/><ul><li class="input-field '+(f!=="email"?"mobile-no":"email")+'"><p>'+(f!=="email"?'<span class="country-code">+91 - </span>':"")+'<input autocomplete="off" type="text" name="verify-emailid" maxlength="100" disabled="disabled" value="'+k+'" /></p><a href="javascript:void(0)" id="changeRegisterEmailId" class="secondary-link">Change Email/Mobile No.</a></li><li class="input-field password"><p><input type="password" name="otpverify" maxlength="6" placeholder="Enter the verification code"/></p><div class="errorMsg"></div><div class="successMsg"></div><span class="regenerate-otp">Didn\'t receive OTP?</span><a id="sso-verify-regenerate-otp" href="javascript:void(0)" class="secondary-link">Re-Generate OTP</a></li><li class="submit"><input type="submit" id="'+(i?"sso-verify-email-btn":"sso-verify-btn")+'" class="submit-btn disabled" value="'+(i?"Verify":"Verify and Login")+'" disabled="disabled" /></li></ul></form><div class="mandatory-box"><p>*Email or mobile no. verification is mandatory to complete the registration process.</p></div></div></div>';
$("#user-sign-in").html(d)};aG.showSuccessMsgScreen=function(c,b){var a="";a+='<div id="toi-success-screen"><div class="signin-section"><h4 class="heading"><span>'+(c?"Forgot Password":"Complete Your Profile")+"</span></h4>";if(c){a+='<div class="fp-success"><i class=""></i><div class="fp-success-msg">Password changed successfully.</div></div>'}else{a+='<div class="register-success"><div class="verified"><div>'+(b.email?"Email Id":"Mobile Number")+" verified:</div><div><strong>"+(b.email||b.mobile)+'</strong><i class="tick"></i></div></div><div class="success-wrapper"><i class="success-user"></i><div class="fp-success-msg">Thank you for registering.</div></div></div>'
}a+="</div></div>";$("#user-sign-in").html(a);setTimeout(function(){var d=$("#login-popup");if(d.hasClass("active")){aG.closeBtnHandler()}},5000)};aG.recaptchaResponse=function(a){var b=$("li.recaptcha-wrapper");aG.handleError(b);aG.setRecaptchaCode(a)};aG.recaptchaErrorCallback=function(a){var b=$("li.recaptcha-wrapper");aG.handleError(b,ao.serverError)};aG.recaptchaExpiredCallback=function(a){};aG.setRecaptchaCode=function(a){W=a};aG.getRecaptchaCode=function(){return W};aG.logout=function(a){au=function(){S.publish("user.logout");
if(a){a()}};Y();var d="https://jsso.indiatimes.com/sso/identity/profile/logout/external?channel="+aF.getChannel().toLowerCase();var b=X.iframe(d);$(b).load(function(){$(b).remove();aG.removeUser();if(window.__sso){window.__sso()}});ag.remove("sso_user");var c=aF.getDomain();var f=[{name:"ssoid",path:"/",domain:c},{name:"Fbsecuritykey",path:"/",domain:c},{name:"fbookname",path:"/",domain:c},{name:"CommLogP",path:"/",domain:c},{name:"CommLogU",path:"/",domain:c},{name:"FaceBookEmail",path:"/",domain:c},{name:"Fbimage",path:"/",domain:c},{name:"fbooklocation",path:"/",domain:c},{name:"Fboauthid",path:"/",domain:c},{name:"fbname",path:"/",domain:c},{name:"fbLocation",path:"/",domain:c},{name:"fbimage",path:"/",domain:c},{name:"fbOAuthId",path:"/",domain:c},{name:"MSCSAuth",path:"/",domain:c},{name:"MSCSAuthDetail",path:"/",domain:c},{name:"MSCSAuthDetails",path:"/",domain:c},{name:"Twimage",path:"/",domain:c},{name:"TwitterUserName",path:"/",domain:c},{name:"Twoauthid",path:"/",domain:c},{name:"Twsecuritykey",path:"/",domain:c},{name:"ssosigninsuccess",path:"/",domain:c},{name:"prc",path:"/",domain:c},{name:"ssoid"},{name:"MSCSAuthDetail"},{name:"articleid"},{name:"txtmsg"},{name:"tflocation"},{name:"tfemail"},{name:"setfocus"},{name:"fbookname"},{name:"CommLogP"},{name:"CommLogU"},{name:"FaceBookEmail"},{name:"Fbimage"},{name:"fbooklocation"},{name:"Fboauthid"},{name:"Fbsecuritykey"},{name:"fbname"},{name:"fbLocation"},{name:"fbimage"},{name:"fbOAuthId"},{name:"MSCSAuth"},{name:"MSCSAuthDetails"},{name:"ssosigninsuccess"},{name:"Twimage"},{name:"TwitterUserName"},{name:"Twoauthid"},{name:"Twsecuritykey"},{name:"prc"}];
var g=0;for(;g<f.length;g++){if(f[g].path){aj.remove(f[g].name,f[g].path,f[g].domain)}else{aj.remove(f[g].name)}}};var ap={check_user_status:function(c,a){var b=aj.get("ssoid")||aj.get("ssoId");var f=aj.get("MSCSAuthDetails");if(!b&&f){b=f.split("=")[1]}if(b&&b.length>0){var d=aG.getUser();if(d){if(a){a(d)}}else{if(f){aD.getUsersInfo({ssoids:b},function(g){if(a){a(g[0]||g)}})}else{ai.getJSONP("https://jsso.indiatimes.com/sso/crossdomain/getTicket?version=v1",function(h){if(h.ticketId!=null&&h.ticketId!=undefined&&h.ticketId.length>0){var g="https://socialappsintegrator.indiatimes.com/socialsite/v1validateTicket?ticketId="+h.ticketId+"&channel="+aF.getChannel().toLowerCase();
ai.getJSONP(g,function(j){if(location.hostname.indexOf(".indiatimes.com")>-1){aD.getUsersInfo({ssoids:b},function(k){if(a){a(k[0]||k)}})}else{var i="http://"+location.hostname+"/v1validateTicket?ticketId="+h.ticketId+"&channel="+aF.getChannel().toLowerCase();ai.getJSONP(i,function(k){aD.getUsersInfo({ssoids:b},function(l){if(a){a(l[0]||l)}})})}})}else{if(a){a(null)}}})}}}else{if(a){a(null)}}},mapping:{uid:"uid",email:"EMAIL",id:"_id",name:"FL_N",username:"D_N_U",fullName:"FL_N",firstName:"F_N",lastName:"L_N",icon:"tiny",link:"profile",CITY:"CITY",thumb:"thumb",followersCount:"F_C",FE_C:"FE_C",I_U_A:"I_U_A",I_I_L:"I_I_L",badges:"badges",rewards:"rewards",whatsonid:"W_ID",ps:"SUB_U_J"}};
aG.renderPlugins=function(a){a=a||aG.getUser();$(function(){if(a){$("[data-plugin='user-isloggedin']").show();$("[data-plugin='user-notloggedin']").hide();$("[data-plugin='user-name']").text(a.getFirstName());$("[data-plugin='user-icon']").attr("src",a.getIcon());$("[data-plugin='user-thumb']").attr("src",a.getThumb());aD.getRewards({uid:a.getUid()},function(b){if(b&&b.output&&b.output.user&&b.output.user.levelName){$("[data-plugin='user-points']").text((b.output.user.statusPoints));$("[data-plugin='user-level']").text((b.output.user.levelName));
$("[data-plugin='user-points-wrapper']").show().addClass("points_"+b.output.user.levelName.toLowerCase())}else{$("[data-plugin='user-points-wrapper']").hide()}})}else{$("[data-plugin='user-icon']").attr("src",ae.default_user_icon);$("[data-plugin='user-thumb']").attr("src",ae.default_user_icon);$("[data-plugin='user-isloggedin']").hide();$("[data-plugin='user-notloggedin']").show()}$("body").toggleClass("loggedin",!!a);$("body").toggleClass("notloggedin",!a)})};aG.register=function(){ak.info("Register event called.")
};aG.isLoggedIn=function(a){ai.get(ae.check_user_status,{},function(b){var c=al.getNewUser(b,ae.mapping);if(c){c.loginType=aj.get("LoginType");c.facebook={name:aj.get("fbookname"),location:aj.get("fbooklocation"),image:aj.get("Fbimage"),email:aj.get("FaceBookEmail"),oauth:aj.get("Fboauthid")};c.twitter={name:aj.get("TwitterUserName"),image:aj.get("Twimage"),oauth:aj.get("Twoauthid")};aG.setUser(c)}else{aG.removeUser()}if(a){a(c)}})};aG.removeUser=function(a){if(ae.multiuser){if(a){delete ah[a]}else{throw new Error("'userId' is required to remove a user.")
}}else{delete ah[aC]}aG.statusChange(null)};aG.setUser=aG.addUser=function(a){if(typeof a!=="undefined"&&!al.isUser(a)){throw new Error("Object is not an instance of User, use 'user.getNewUser()' to get a User object.")}if(ae.multiuser){ah[a.id](a)}else{ah[aC]=a}aG.statusChange(a)};aG.getUser=function(a){if(ae.multiuser){return ay.extend(true,{},ah[a])}else{return ah[aC]}};aG.statusChange=function(a){ak.info("User Status:"+(a?a.toString():null));S.publish("user.status",a);aG.refreshIframes()};aG.refreshIframes=function(){$(window.parent.document).find("iframe[data-refreshstate]").each(function(b,a){$(a).attr("src",$(a).attr("src"))
})};aG.onStatusChange=function(a){S.subscribe("user.status",a)};aG.updateConfig=function(a){if(a){ae=ay.extend(true,{},ae,a)}};aG.forgotPasswordBtnHandler=function(i){i.preventDefault();var g=aG.setAndGetJssoCrosswalkObj(),h=aG.getLoginType(),b=$("#fp-inputVal").val(),f=$("#toi-forgot-password"),a=f.find('input[name="otpfp"]').val(),c=f.find('input[name="registerPwd"]').val(),d;d=(h==="email"?g.loginEmailForgotPassword:g.loginMobileForgotPassword);if(typeof d==="function"){aG.showLoader();d.call(g,b,a,c,c,aG.handleForgotPasswordVerifyCallback);
aG.fireGAEvent(aG.getPageName()+"_PW_Verify")}};aG.handleForgotPasswordVerifyCallback=function(d){aG.hideLoader();var c=$('#toi-forgot-password input[name="otpfp"]').closest("li");var b=$('#toi-forgot-password input[name="registerPwd"]').closest("li");var a=aG.getLoginType();if(d.code===200){aG.fireGAEvent("Login_Success_"+aG.getPageName());aG.showSuccessMsgScreen(true);aG.isLoggedIn(au)}else{aG.handleError(c);aG.handleError(b);$(".successMsg").hide();switch(d.code){case 414:aG.handleError(c,(a==="email"?ao.wrongOtpEmail:ao.wrongOtp));
break;case 415:aG.handleError(c,ao.expiredOTP);break;case 416:aG.handleError(c,ao.limitExceeded);break;case 418:aG.handleError(b,ao.matchLastThree);break;case 503:aG.handleError(b,ao.connectionError);break;default:aG.handleError(b,ao.serverError)}aG.fireGAEvent("API_Error_"+d.code)}};aG.forgotPasswordHandler=function(a){if($("#sso-forgot-pass").hasClass("disabled")){return}var c=$('#toi-login input[name="emailId"]');var g=aG.setAndGetJssoCrosswalkObj(),h=aG.getLoginType(),b=$('#toi-login input[name="emailId"]').val(),d=$("#toi-login li.email"),f;
if(b.length===0){aG.handleError(d,ao.fpNoEmailOrMobile);return}else{if(!h){aG.handleError(d,ao.fpInvalidEmail);return}}aG.handleError(d);b=(h==="email"?aG.getValidEmailId(b):aG.getValidMobileNumber(b));f=(h==="email"?g.getEmailForgotPasswordOtp:g.getMobileForgotPasswordOtp);if(typeof f==="function"){aG.showLoader();f.call(g,b,aG.handleForgotPasswordOTPCallback)}aG.setPageName(aG.getLoginType());aG.fireGAEvent(aG.getPageName()+"_Forgot_PW")};aG.handleError=function(b,a){if(a){b.find("p").addClass("error");
b.find(".errorMsg").html(a).show()}else{b.find("p").removeClass("error");b.find(".errorMsg").html("").hide()}};aG.handleForgotPasswordOTPCallback=function(b){aG.hideLoader();var c=$("#toi-login li.email");if(b&&b.code===200){aG.showForgotPasswordScreen();var a=aG.getLoginType();aG.setScreenName("Forgot_PW")}else{if([405,406,407,408].indexOf(b.code)!==-1){aG.handleError(c,ao.accountUnregistered)}else{if(b.code===503){aG.handleError(c,ao.connectionError)}else{if(b.code===416){aG.handleError(c,ao.limitExceeded);
$("#sso-regenerate-otp, #sso-generate-otp, #sso-forgot-pass").addClass("disabled")}else{aG.handleError(c,ao.serverError)}}}aG.fireGAEvent("API_Error_"+b.code)}};aG.fpInputKeyupHandler=function(a){var b=$(this);setTimeout(function(){var g=$("#toi-forgot-password");var d=g.find('input[name="otpfp"]').val();var f=g.find('input[name="registerPwd"]').val();var c=$("#sso-fp-btn");var h=true;if(!(!isNaN(d)&&d.length===6)||!aG.isPasswordValid(f)){h=false}c.prop("disabled",!h);if(h){c.removeClass("disabled")
}else{c.addClass("disabled")}if(b.attr("name")==="registerPwd"){aG.passwordErrors.call(b,a)}},0)};aG.changeEmailIdHandler=function(a){$("#sso-pwdDiv, #changeEmailIdDiv, #sso-otpLoginDiv, #sso-login-otp-msg").hide();$('#toi-login input[name="emailId"]').prop("disabled",false).val("");$('#sso-signInButtonDiv input[type="submit"]').prop("disabled",true).addClass("disabled");$(".errorMsg, .successMsg").hide();$(".error").removeClass("error");$("#sso-signInButtonDiv > input").val("Continue");$('#sso-pwdDiv input[name="password"]').val("");
$('#sso-otpLoginDiv input[type="password"]').val("");$("#sso-regenerate-otp, #sso-fp-regenerate-otp, #sso-verify-regenerate-otp, #sso-generate-otp, #sso-forgot-pass").removeClass("disabled");aG.fireGAEvent(aG.getPageName()+"_Change");aG.setScreenName("Login_Screen")};aG.changeRegisterEmailIdHandler=function(a){aG.showLoginScreen();aG.fireGAEvent(aG.getPageName()+"_Change")};aG.handleEmailIdKeyUp=function(a){var b=$(this);setTimeout(function(i){var h=b.val(),c=h.indexOf("@"),g=!isNaN(h)&&h.length>=10,d=false,f=$("#toi-login li.email"),j=$('#sso-signInButtonDiv > input[type="submit"]');
if(c&&aG.getValidEmailId(h).length>0){aG.setLoginType("email");d=true}else{if(g&&aG.getValidMobileNumber(h).length>0){aG.setLoginType("mobile");d=true}else{aG.setLoginType("")}}j.prop("disabled",!d);aG.handleError(f);if(d){j.removeClass("disabled")}else{j.addClass("disabled")}},0)};aG.checkUserExists=function(c){aG.hideLoader();var d=$("#toi-login li.email");var f=$('#toi-login input[name="emailId"]');var b="";var a=aG.getLoginType();aG.handleError(d);if(c&&c.code===200&&c.data){if(c.data.statusCode===212||c.data.statusCode===213){$("#sso-pwdDiv, #changeEmailIdDiv").show();
$("#sso-signInButtonDiv > input").val("Sign In")}else{if(c.data.statusCode===205||c.data.statusCode===206||c.data.statusCode===214||c.data.statusCode===215){aG.registerUser();aG.setScreenName("Register_New_User")}else{f.prop("disabled",false);b=c.data.statusCode===216?ao.fpInvalidEmailOnly:ao.fpInvalidEmail;aG.handleError(d,b)}}}else{f.prop("disabled",false);if(c.code===410){aG.handleError(d,(a==="email"?ao.fpInvalidEmailOnly:ao.fpInvalidMobileOnly))}else{if(c.code===503){aG.handleError(d,ao.connectionError)
}else{aG.handleError(d,ao.serverError)}}aG.fireGAEvent("API_Error_"+c.code)}};aG.registerUser=function(){aG.showRegisterScreen()};aG.registerButtonHandler=function(k){k.preventDefault();aG.registerFormSubmitted(true);var z=$("#toi-register");var F=z.find('input[name="emailId"]');var d=z.find('input[name="fullname"]');var A=z.find('input[name="registerPwd"]');var l=z.find('input[name="registerCnfrmPwd"]');var D=z.find('input[name="mobile"]');var I=aG.getRecaptchaCode();var c=z.find('input[name="agree"]');
var v=c.is(":checked");var g=z.find('input[name="promotions"]').is(":checked");var j=z.find('input[name="sharedDataAllowed"]').is(":checked")?"1":"0";var q=F.val();var m=d.val();var f=A.val().trim();var G=l.val().trim();var b=D.val()||"";var H={};var r=true;var B=aG.getLoginType();var t=aG.setAndGetJssoCrosswalkObj(),x;var o=d.closest("li");var a=A.closest("li");var h=l.closest("li");var E=D.closest("li");var u=F.closest("li");var w=c.closest("li");var y=$("#recaptcha-container").closest("li");var C=aG.checkAndSetFullNameError(d,o);
var i=aG.checkAndSetConfirmPasswordError(l,h);var n=true;var p=aG.checkAndSetAgreeTnCError(c,w);if(B==="email"){n=aG.checkAndSetEmailOrMobileToRegisterError(D,E,"mobile")}else{n=aG.checkAndSetEmailOrMobileToRegisterError(F,u,"email")}if(!C||!i||!n||!p){r=false}if(!aG.isPasswordValid(f)){r=false}if(aG.showCaptcha()){if(!I){r=false;aG.handleError(y,ao.captchaUnselected)}else{aG.handleError(y)}}$(".password-conditions").show();if(r){H=aG.getFirstAndLastName(m);x=aG.showCaptcha()?t.registerUserRecaptcha:t.registerUser;
if(typeof x==="function"){aG.showLoader();if(aG.showCaptcha()){x.call(t,H.firstName,H.lastName,"","",q,b,f,g,I,"1",j,aG.registerUserCallback)}else{x.call(t,H.firstName,H.lastName,"","",q,b,f,g,"1",j,aG.registerUserCallback)}}}aG.fireGAEvent(aG.getPageName()+"_Verify")};aG.registerFormErrorHandler=function(a){if(!ac){return}var d=$(a.target);var b=d.attr("name");var c=d.closest("li");if(b==="fullname"){aG.checkAndSetFullNameError(d,c)}else{if(b==="registerCnfrmPwd"){aG.checkAndSetConfirmPasswordError(d,c)
}else{if(b==="emailId"){aG.checkAndSetEmailOrMobileToRegisterError(d,c,"email")}else{if(b==="mobile"){aG.checkAndSetEmailOrMobileToRegisterError(d,c,"mobile")}else{if(b==="agree"){aG.checkAndSetAgreeTnCError(d,c)}}}}}};aG.checkAndSetFullNameError=function(b,c){var a=/^[a-zA-Z\s]*$/;var f=b.val();var d=true;if(!(f&&f.length>0&&a.test(f))){d=false;if(f.length===0){aG.handleError(c,ao.emptyName)}else{aG.handleError(c,ao.wrongName)}}else{aG.handleError(c)}return d};aG.checkAndSetConfirmPasswordError=function(a,b){var c=$('#toi-register input[name="registerPwd"]').val().trim();
var d=a.val().trim();var f=true;if(c!==d){f=false;aG.handleError(b,ao.passwordMismatch)}else{aG.handleError(b)}return f};aG.checkAndSetEmailOrMobileToRegisterError=function(b,c,a){var d=b.val();var f=true;if(d.length===0){aG.handleError(c)}else{d=a==="email"?aG.getValidEmailId(d):aG.getValidMobileNumber(d,true);if(d.length===0){f=false;aG.handleError(c,(a==="email"?ao.wrongEmail:ao.wrongMobile))}else{aG.handleError(c)}}return f};aG.checkAndSetAgreeTnCError=function(a,b){var d=a.is(":checked");var c=true;
if(!d){c=false;aG.handleError(b,ao.tncNotSelected)}else{aG.handleError(b)}return c};aG.verifyButtonHandler=function(a){a.preventDefault();var c=$("#toi-verifyotp-password");var j=$("#verify-inputVal").val();var f=$("#verify-ssoid").val();var k=c.find('input[name="otpverify"]').val();var b=aG.getLoginType();var d=$("#verify-logintype").val();var h=$("#verify-email").val()||"";var g=aG.setAndGetJssoCrosswalkObj();var i=(d==="email"?g.verifyEmailSignUp:g.verifyMobileSignUp);if(typeof i==="function"){aG.showLoader();
i.call(g,j,f,k,aG.handleSignUpVerifyCallback((b!==d&&h?h:""),f));aG.fireGAEvent(aG.getPageName()+"_Verify")}};aG.verifyEmailButtonHandler=function(a){a.preventDefault();aG.verifyButtonHandler(a)};aG.enableVerifyButton=function(a){var b=$(this);setTimeout(function(){var d=b.val();var c=$("#sso-verify-btn");if(!c.is(":visible")){c=$("#sso-verify-email-btn")}if(!isNaN(d)&&d.length===6){c.prop("disabled",false).removeClass("disabled")}else{c.prop("disabled",true).addClass("disabled")}},0)};aG.handleSignUpVerifyCallback=function(b,a,c){return function(d){aG.hideLoader();
var i=$('#toi-verifyotp-password input[name="otpverify"]').closest("li");var h=$("#verify-logintype").val();var j="";var g=$("#verify-inputVal");var f={};if(d&&d.code===200){aG.fireGAEvent("Login_Success_"+aG.getPageName());if(!b||!a){if(h==="email"){f.email=g.val()}else{f.mobile=g.val()}aG.showSuccessMsgScreen(false,f)}else{j=g.val();aG.showSignUpOtpScreen(a,"",b+"#"+j)}aG.isLoggedIn(au)}else{$(".successMsg").hide();switch(d.code){case 414:aG.handleError(i,(h==="email"?ao.wrongOtpEmail:ao.wrongOtp));
break;case 415:aG.handleError(i,ao.expiredOTP);break;case 416:aG.handleError(i,ao.limitExceeded);break;case 503:aG.handleError(i,ao.connectionError);break;default:aG.handleError(i,(ao.serverError))}aG.fireGAEvent("API_Error_"+d.code)}}};aG.registerUserCallback=function(b){aG.hideLoader();var c=$("#sharedDataAllowed").closest("li");var a=$('#toi-register input[name="mobile"]').val();if(b&&b.code===200){aG.showSignUpOtpScreen(b.data.ssoid,a);aG.setScreenName("Complete_Profile")}else{if(b.code===429){aG.handleError(c,ao.userAlreadyRegistered)
}else{if(b.code===416){aG.handleError(c,ao.limitExceeded)}else{if(b.code===503){aG.handleError(c,ao.connectionError)}else{aG.handleError(c,ao.serverError)}}}if(typeof grecaptcha==="object"&&aG.showCaptcha()){grecaptcha.reset(aH)}aG.setRecaptchaCode("");aG.fireGAEvent("API_Error_"+b.code)}};aG.getFirstAndLastName=function(b){var c=[];var a={firstName:"",lastName:""};if(b&&b.length>0){b=b.replace(/  +/g," ");c=b.split(" ");a.firstName=c[0]||"";if(c.length>1){c.splice(0,1);a.lastName=c.join(" ")}}return a
};aG.loginWithOTP=function(a,c){if($("#sso-generate-otp").hasClass("disabled")){return}var d=$('#toi-login input[name="emailId"]');var g=aG.setAndGetJssoCrosswalkObj(),h=aG.getLoginType(),b=$('#toi-login input[name="emailId"]').val(),f;b=(h==="email"?aG.getValidEmailId(b):aG.getValidMobileNumber(b));f=(h==="email"?g.getEmailLoginOtp:g.getMobileLoginOtp);if(typeof f==="function"){aG.showLoader();f.call(g,b,aG.handleLoginOTPCallback(c));if(c){aG.fireGAEvent(aG.getPageName()+"_Re_OTP")}else{aG.fireGAEvent(aG.getPageName()+"_OTP_Submit")
}}};aG.regenerateLoginOTP=function(){if($("#sso-regenerate-otp").hasClass("disabled")){return}aG.loginWithOTP({},true)};aG.fpRegenerateOTP=function(){if($(this).hasClass("disabled")){return}var a=aG.setAndGetJssoCrosswalkObj(),b=aG.getLoginType(),c=$("#fp-inputVal").val(),d;d=(b==="email"?a.getEmailForgotPasswordOtp:a.getMobileForgotPasswordOtp);if(typeof d==="function"){aG.showLoader();d.call(a,c,aG.handleForgotPasswordRegenerateOTPCallback);aG.fireGAEvent(aG.getPageName()+"_Re_OTP")}};aG.handleForgotPasswordRegenerateOTPCallback=function(a){aG.hideLoader();
var b=$('input[name="otpfp"]').parent().parent();aG.handleError(b);if(a&&a.code===200){$('#toi-forgot-password input[name="otpfp"]').val("");$(".successMsg").text("OTP has been successfully sent.").show()}else{$(".successMsg").hide();switch(a.code){case 416:aG.handleError(b,ao.limitExceeded);$("#sso-fp-regenerate-otp").addClass("disabled");$("#forgot-password-sent").hide();break;case 503:aG.handleError(b,ao.connectionError);break;default:aG.handleError(b,ao.serverError)}aG.fireGAEvent("API_Error_"+a.code)
}};aG.verifyPageRegenerateOTP=function(){if($("#sso-verify-regenerate-otp").hasClass("disabled")){return}var a=aG.setAndGetJssoCrosswalkObj(),b=$("#verify-logintype").val(),c=$("#verify-inputVal").val(),d=$("#verify-ssoid").val(),f;f=(b==="email"?a.resendEmailSignUpOtp:a.resendMobileSignUpOtp);if(typeof f==="function"){aG.showLoader();f.call(a,c,d,aG.handleSignUpVerifyRegenerateOTPCallback);aG.fireGAEvent(aG.getPageName()+"_Re_OTP")}};aG.handleSignUpVerifyRegenerateOTPCallback=function(a){aG.hideLoader();
var b=$("#toi-verifyotp-password li.password:visible");aG.handleError(b);if(a&&a.code===200){$('#toi-verifyotp-password input[name="otpverify"]').val("");$(".successMsg").text("OTP has been successfully sent.").show()}else{$(".successMsg").hide();switch(a.code){case 416:aG.handleError(b,ao.limitExceeded);$("#sso-verify-regenerate-otp").addClass("disabled");break;case 503:aG.handleError(b,ao.connectionError);break;default:aG.handleError(b,ao.serverError)}aG.fireGAEvent("API_Error_"+a.code)}};aG.handleLoginOTPCallback=function(a){return function(d){aG.hideLoader();
var f=$("#toi-login li.password:visible");aG.handleError(f);if(d&&d.code===200){var b=aG.getLoginType();var c=$('#toi-login input[name="emailId"]').val();c=(b==="email"?aG.getValidEmailId(c):aG.getValidMobileNumber(c));$("#sso-pwdDiv").hide();$("#sso-otpLoginDiv, #sso-login-otp-msg").show();$("#sso-login-otp-msg > p").text("We have sent a 6 digit verification code "+(b==="email"?"to ":"on +91-")+c);if(a){$('#toi-login input[name="otplogin"]').val("");$("#sso-otpLoginDiv .successMsg").text("OTP has been successfully sent.").show()
}}else{$("#sso-otpLoginDiv .successMsg").hide();switch(d.code){case 416:aG.handleError(f,ao.limitExceeded);$("#sso-regenerate-otp, #sso-generate-otp, #sso-forgot-pass").addClass("disabled");$("#sso-login-otp-msg > p").text("");break;case 503:aG.handleError(f,ao.connectionError);break;default:aG.handleError(f,ao.serverError)}aG.fireGAEvent("API_Error_"+d.code)}}};aG.fbLoginHandler=function(b){var a=function(){aG.closeBtnHandler()};aG.initiateFbLogin(a)};aG.gplusLoginHandler=function(){var a=function(){aG.closeBtnHandler()
};aG.initiateGplusLogin(a)};aG.handleLoginCallback=function(c){aG.hideLoader();var b=$("#sso-otpLoginDiv").is(":visible");var d=$("#toi-login li.password:visible");var a=aG.getLoginType();if(c&&c.code===200){aG.closeBtnHandler();aG.isLoggedIn(au);aG.fireGAEvent("Login_Success_"+aG.getPageName())}else{$(".successMsg").hide();switch(c.code){case 415:aG.handleError(d,(!b?ao.wrongPassword:ao.expiredOTP));break;case 416:aG.handleError(d,ao.limitExceeded);break;case 503:aG.handleError(d,ao.connectionError);
break;default:aG.handleError(d,(!b?ao.wrongPassword:(a==="email"?ao.wrongOtpEmail:ao.wrongOtp)))}aG.fireGAEvent("API_Error_"+c.code)}};aG.handleEmailIdClick=function(b){b.preventDefault();var c=$('#sso-pwdDiv input[name="password"]');var d=$('#sso-otpLoginDiv input[type="password"]');var a=$('#toi-login input[name="emailId"]');var k="";var f=$("#toi-login li.password:visible .errorMsg");a.prop("disabled",true);var h=aG.setAndGetJssoCrosswalkObj(),g=aG.getLoginType(),i=$('#toi-login input[name="emailId"]').val(),j;
i=(g==="email"?aG.getValidEmailId(i):aG.getValidMobileNumber(i));if(c.is(":visible")||d.is(":visible")){j=(g==="email"?h.verifyEmailLogin:h.verifyMobileLogin);k=c.is(":visible")?c.val():d.val();aG.fireGAEvent(aG.getPageName()+(c.is(":visible")?"_PW":"_OTP")+"_Entry");if(k.length===0){f.html(ao.emptyPassword).show();return}else{if(typeof j==="function"){$(".errorMsg").html("").hide();aG.showLoader();j.call(h,i,k,aG.handleLoginCallback)}}}else{if(typeof h.checkUserExists==="function"){aG.showLoader();
h.checkUserExists(i,aG.checkUserExists);aG.setPageName(g);aG.fireGAEvent(aG.getPageName()+"_Continue")}else{a.prop("disabled",false)}}};aG.getValidEmailId=function(c){var a=/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,6})$/;var b="";if(a.test(c)){b=c}return b};aG.getValidMobileNumber=function(c,b){var g=(b?/^[789]\d{9}$/:/^(\+91)?[0]?[789]\d{9}$/);var d=["7777777777","8888888888","9999999999"];var f="";var a=c.length;if(g.test(c)){f=c.substring(c.length-10,c.length)}if(d.indexOf(f)!==-1){f=""
}return f};aG.closeModalOnEscapeKeyPress=function(a){if(!aB.loginPopup.hasClass("active")){return}var b=a.keyCode||a.which;if(b===27){aB.closeBtn.click()}};aG.isPasswordValid=function(a){return a&&a.length>=6&&a.length<=14&&aG.hasNumber(a)&&aG.hasSpecialCharacters(a)&&aG.hasLowerCase(a)};aG.hasLowerCase=function(a){return(/[a-z]/.test(a))};aG.hasNumber=function(a){return(/[0-9]/.test(a))};aG.hasSpecialCharacters=function(a){return(/[!@#$%^&*()]/.test(a))};aG.passwordErrors=function(a){var b=$(this);
setTimeout(function(){var c=b.val();if(c.length<6||c.length>14){$("#charCnt").removeClass("success").addClass("error")}else{$("#charCnt").removeClass("error").addClass("success")}if(aG.hasLowerCase(c)){$("#lwCnt").removeClass("error").addClass("success")}else{$("#lwCnt").removeClass("success").addClass("error")}if(aG.hasNumber(c)){$("#numCnt").removeClass("error").addClass("success")}else{$("#numCnt").removeClass("success").addClass("error")}if(aG.hasSpecialCharacters(c)){$("#spclCharCnt").removeClass("error").addClass("success")
}else{$("#spclCharCnt").removeClass("success").addClass("error")}},0)};aG.showPassword=function(a){var b=$(this);b.prev().attr("type","text");b.removeClass("view-password").addClass("hide-password")};aG.hidePassword=function(a){var b=$(this);b.prev().attr("type","password");b.removeClass("hide-password").addClass("view-password")};aG.showPasswordCondition=function(a){a.stopPropagation();$(".password-conditions").show()};aG.stopEventProp=function(a){a.stopPropagation()};aG.setLoginType=function(a){aq=a
};aG.getLoginType=function(){return aq};aG.setPageName=function(a){af=(a==="email"?"Email":"MobNo")};aG.getPageName=function(){return af};aG.setScreenName=function(a){at=a};aG.getScreenName=function(a){return at};aG.setAndGetJssoCrosswalkObj=function(){var a={};if(typeof ax==="object"){a=ax}else{if(typeof JssoCrosswalk==="function"){ax=new JssoCrosswalk("toi","web");a=ax}}return a};aG.showLoader=function(){$("#user-sign-in").addClass("loader")};aG.hideLoader=function(){$("#user-sign-in").removeClass("loader")
};aG.closeBtnHandler=function(){aB.loginPopup.removeClass("active");$("body").removeClass("disable-scroll");if(typeof grecaptcha==="object"&&$("#toi-register").is(":visible")&&aG.showCaptcha()){grecaptcha.reset(aH)}};aG.init=function(b){var a=function(){aB.loginPopup.show();aG.updateConfig(b);if(ae.renderer===true){aG.onStatusChange(function(c){aG.renderPlugins(c)})}aG.isLoggedIn(function(){});aG.initActions()};TimesApps.checkGdprAndCall(a,aG.logout)};aG.initActions=function(){aB.closeBtn.on("click",function(){aG.closeBtnHandler();
aG.fireGAEvent("Close")});$("[data-plugin='user-isloggedin']").on("click","[data-plugin='user-logout']",function(){aG.logout()});$("[data-plugin='user-notloggedin']").on("click","[data-plugin='user-login']",function(){$("body").addClass("disable-scroll");aB.loginPopup.addClass("active");aG.showLoginScreen();aG.setScreenName("Login_Screen");aG.fireGAEvent("Load")}).on("click","[data-plugin='user-register']",function(){aG.register()}).on("click","[data-plugin='user-login-facebook']",function(){aG.loginWithFacebook()
}).on("click","[data-plugin='user-login-twitter']",function(){aG.loginWithTwitter()}).on("click","[data-plugin='user-login-google']",function(){aG.loginWithGoogle()});$(document).on("keyup",aG.closeModalOnEscapeKeyPress);$("#user-sign-in").off("keyup paste",'#toi-login input[name="emailId"]').on("keyup paste",'#toi-login input[name="emailId"]',aG.handleEmailIdKeyUp).off("click",'#sso-signInButtonDiv input[type="submit"]').on("click",'#sso-signInButtonDiv input[type="submit"]',aG.handleEmailIdClick).off("submit","#toi-login form").on("submit","#toi-login form",aG.handleEmailIdClick).off("click","#changeEmailIdDiv").on("click","#changeEmailIdDiv",aG.changeEmailIdHandler).off("click","#changeRegisterEmailId").on("click","#changeRegisterEmailId",aG.changeRegisterEmailIdHandler).off("click","#sso-forgot-pass").on("click","#sso-forgot-pass",aG.forgotPasswordHandler).off("click","#sso-fb-login").on("click","#sso-fb-login",aG.fbLoginHandler).off("click","#sso-gplus-login").on("click","#sso-gplus-login",aG.gplusLoginHandler).off("click","#sso-generate-otp").on("click","#sso-generate-otp",aG.loginWithOTP).off("click","#sso-regenerate-otp").on("click","#sso-regenerate-otp",aG.regenerateLoginOTP).off("click","#sso-fp-regenerate-otp").on("click","#sso-fp-regenerate-otp",aG.fpRegenerateOTP).off("click","#sso-verify-regenerate-otp").on("click","#sso-verify-regenerate-otp",aG.verifyPageRegenerateOTP).off("click","#sso-registerBtn").on("click","#sso-registerBtn",aG.registerButtonHandler).off("submit","#toi-register form").on("submit","#toi-register form",aG.registerButtonHandler).off("click","#sso-verify-btn").on("click","#sso-verify-btn",aG.verifyButtonHandler).off("click","#sso-verify-email-btn").on("click","#sso-verify-email-btn",aG.verifyEmailButtonHandler).off("submit","#toi-verifyotp-password form").on("submit","#toi-verifyotp-password form",aG.verifyButtonHandler).off("click","#sso-fp-btn").on("click","#sso-fp-btn",aG.forgotPasswordBtnHandler).off("submit","#toi-forgot-password form").on("submit","#toi-forgot-password form",aG.forgotPasswordBtnHandler).off("focus",'input[name="registerPwd"]').on("focus",'input[name="registerPwd"]',aG.showPasswordCondition).off("keyup paste",'#toi-register input[name="registerPwd"]').on("keyup paste",'#toi-register input[name="registerPwd"]',aG.passwordErrors).off("keyup paste",'#toi-register input[type="text"]').on("keyup paste",'#toi-register input[type="text"]',aG.registerFormErrorHandler).off("keyup paste",'#toi-register input[name!="registerPwd"][type="password"]').on("keyup paste",'#toi-register input[name!="registerPwd"][type="password"]',aG.registerFormErrorHandler).off("change",'#toi-register input[name="agree"]').on("change",'#toi-register input[name="agree"]',aG.registerFormErrorHandler).off("focus blur","[placeholder]").on("focus blur","[placeholder]",aG.stopEventProp).off("keyup paste","#toi-forgot-password input").on("keyup paste","#toi-forgot-password input",aG.fpInputKeyupHandler).off("keyup paste",'#toi-verifyotp-password input[name="otpverify"]').on("keyup paste",'#toi-verifyotp-password input[name="otpverify"]',aG.enableVerifyButton).off("click",".view-password").on("click",".view-password",aG.showPassword).off("click",".hide-password").on("click",".hide-password",aG.hidePassword)
};aB.loginPopup.off("click").on("click",function(a){if(a.srcElement&&a.srcElement.id==="login-popup"){aB.closeBtn.click()}});aG.updateConfig(ap);return aG});define("login",["tiljs/apps/times/usermanagement"],function(b){return b});define("index",["./preload","./config","tiljs/compatibility","login","./api","tiljs/plugin/dynamic","./rodate","tiljs/plugin/lazy","tiljs/event","tiljs/util","./comments","./homepage","./crwdcnctrl","tiljs/social/facebook","tiljs/social/twitter","tiljs/social/pinterest","tiljs/social/linkedin","tiljs/social/googleplus","tiljs/plugin/pre_event","pgtrack","breakingnews","navigation","localstoragec","global","tiljs/load","jquery","./compatibility_toi","tiljs/apps/times/authorcomments","./nlwidget","toinotification","./tpwidget","onetapsignin"],function(W,N,an,R,P,ah,ab,aa,V,am,af,Y,J,ak,ae,T,L,K,X,ao,ai,al,S,e,ac,ag,U,O,aj,M,ad,Z){setTimeout(function(){R.init()
},1000);window.toicommonjs=true;V.subscribe(["user.login","user.logout"],function(a){am.reloadIframe("#fbk");document.cookie="ssolt=null; domain=.indiatimes.com; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT"});try{ag(document).on("click",'[data-action="login"]',function(){R.login();return false})}catch(Q){}Z.init();ag(document).off("contextmenu").on("contextmenu","img",function(a){return false});require(["ajax","cookie","event","tiljs/social/facebook","tiljs/social/twitter","tiljs/social/pinterest","tiljs/social/linkedin","tiljs/social/googleplus","./nlwidget"],function(a,h,j,c,g,i,f,d,b){TimesApps.hideads();
ag("blockquote").each(function(){if(typeof FB=="undefined"&&/facebook/.test(ag(this).attr("cite"))){c.init({init:true,parse:true})}if(typeof twttr=="undefined"&&/twitter/.test(ag(this).attr("class"))){g.init({parse:true})}});ag(window).load(function(){b.run();if(ag(".g-ytsubscribe").length){ac.js("https://apis.google.com/js/platform.js",function(){})}if(ag("#gaanaplayer").length){require(["gaanaplayer"],function(k){k.init()})}});j.subscribe("user.status",function(l){var k=h.get("ssoid");var m=h.get("ssolt");
if((m===undefined&&k!==undefined)||(m&&k&&m!=k)){a.ajax({url:"https://jsso.indiatimes.com/sso/crossdomain/getTicket?channel=toi&platform=web&version=v1",dataType:"jsonp",success:function(n){if(n&&n.ticketId){var o="https://socialappsintegrator.indiatimes.com/socialsite/v1validateTicket?ticketId="+n.ticketId+"&channel=toi";a.getJSONP(o,function(p){if(p&&p.code==200){now=new Date();then=new Date(new Date().setHours(24,0,0,0));h.set("ssolt",k,(then.getTime()-now.getTime())/(1000*60*60*24),"/",".indiatimes.com","")
}})}}})}});TimesApps.checkGdprAndCall(function(){ac.js("https://image.timespoints.iimg.in/tpwidgets/static/dist/js/main.js")});ag(document.body).on("tpwidget-ready",function(){require(["./tpwidget"],function(k){k.init()})})});TimesApps.thirdPartyAnalytics=(function(){var b,a,c;c={loadingScripts:false};N={urls:["https://static.chartbeat.com/js/chartbeat_video.js","https://ade.clmbtech.com/cde/ae/2658/var=_ccaud?_u="+encodeURIComponent(window.location.href),"https://static.clmbtech.com/ase/2658/3/aa.js"]};
a={_loadScripts:function(){for(var d=0;d<N.urls.length;d++){require(["tiljs/load"],function(f){f.js(N.urls[this.i],"","","async")}.bind({i:d}))}c.loadingScripts=true},_loadMouseflow:function(){window._mfq=window._mfq||[]},_isLoadingScripts:function(){return c.loadingScripts},_init:function(){a._loadMouseflow();a._loadScripts()}};P={init:function(){a._init()},isLoadingScripts:function(){return a._isLoadingScripts()}};return P})();TimesApps.initWeather=function(){var a="/geocities/version-9,minify-1.cms",b="/forecast_js_com/version-40,minify-1.cms";
if(typeof(getCityJSON)=="undefined"){ac.js(a,function(){TimesApps.initWeather()})}else{if(typeof(CastObj)=="undefined"){ac.js(b,function(){TimesApps.initWeather()})}else{CastObj.init()}}};ag(document).ready(function(){TimesApps.handleThirdPartyCalls()});TimesApps.SignIn=function(){require(["tiljs/apps/times/usermanagement"],function(a){a.login()})};TimesApps.comscoreTrackingConfig={comscoreCustomerId:"6036484",stationTitle:"TOI-Desktop",publisherName:"The Times of India",contentGenre:"News",c3:"10"};
(function(D,x,H){var a=H(x),c={configSelectors:{},urls:{},cssClasses:{hover:"active",twoColumn:"two-column",rightColumn:"right-column",leftColumn:"left-column",loader:"nav-loading",dropdown:"dropdown"}},p={domSelectors:{navigation:"#main-nav",navItem:"li[data-menu-type]",preloadData:"[data-preload]",leftColumnItem:"li[data-id]",cyclicContainer:".cyclicnav",menuItem:"li[data-id]",preloaded:"[data-preloaded]",headerSearch:".jSearchLens"}},A={},ar={processing:false},m,g=false,w={},k={};function C(){var au={};
return H.extend(true,p,au)}function l(au){A.$navigation=H(m.domSelectors.navigation);A.$navItems=A.$navigation.find(m.domSelectors.navItem);A.$header=H("#header");A.$headerSearch=A.$header.find(m.domSelectors.headerSearch);A.$subNav=A.$header.find("#sub-nav");A.$bottomArea=A.$header.find(".bottom-area");A.$allMenu=H("#allmenu");A.$menuMore=H("[data-more-nav]");A.$allMenuContent=H("#allmenu-content")}function o(aA,aE){var az=H("#main-nav").find('li[data-id="'+aA+'"]'),aB=az.text(),aD=az.find("a").attr("href"),aC={title:aB,link:aD};
if(aE===c.cssClasses.twoColumn){az.closest("."+c.cssClasses.dropdown).find("."+c.cssClasses.rightColumn).html("").addClass(c.cssClasses.loader)}else{az.find("."+c.cssClasses.dropdown).html("").addClass(c.cssClasses.loader)}}function z(ay){var aw=ay;if(typeof ay==="string"){aw=aw.replace(/\s\s+/g," ");while(aw.indexOf("<!--")>-1){aw=aw.substr(0,aw.indexOf("<!--"))+aw.substr(aw.indexOf("-->")+3,aw.length)}try{aw=JSON.parse(aw)}catch(ax){aw=null}}return aw}function B(az,aB){var aE,aA=az.data("id"),aC=az.data("params"),aD=az.data("external");
if(aD){aE=aD}else{aE="/navjson/nav-"+aA+".cms";if(aB&&aC&&aA){aE+="?"+aC}}return aE}function h(aw,ax,ay){H.ajax({url:B(aw,ay)}).then(function(at){if(typeof ax==="function"){ax(at)}}).fail(function(at){o(aw.data("id"))})}function ap(aE,aG){var aL,aJ=false,aI=false,aD=aE,aM,aK,aF=aG.data("menu-type"),aH=aG.find("."+c.cssClasses.dropdown);switch(aF){case"top-stories":(aE.stories&&aE.stories.length&&(aJ=true))||(aI=true);break;case"multi-list":(aE.lists&&aE.lists.length&&(aJ=true))||(aI=true);break;case"simple-list":(aE.items&&aE.items.length&&(aJ=true))||(aI=true);
break;case"two-column":(aE.items&&aE.items.length&&(aJ=true))||(aI=true);break}if(aI){o(aG.data("id"))}else{if(aJ){aL=H.templates("#"+aF+"-menu-tmpl");if(aF==="two-column"){aM=aH.find("."+c.cssClasses.leftColumn+" "+p.domSelectors.leftColumnItem);aK=aM.filter("."+c.cssClasses.hover);aH=aH.find("."+c.cssClasses.rightColumn)}aD=aL.render(aE)}}aH.html(aD);aH.removeClass(c.cssClasses.loader);if(aE.items&&aE.items.length){b(aE)}if(aK&&aK.length){G.call(aK.get(0))}require(["tiljs/plugin/lazy"],function(at){at.load()
})}function f(au){au.data("loading",true);h(au,function(aw){var at=aw;if(au.data("menu-type")!=="external-html"){at=z(aw)}if(!at){return}au.data("loaded",true);au.data("loading",false);ap(at,au)})}function F(aw){var ay=aw.find("."+c.cssClasses.leftColumn),ax=ay.find("li").get(0);G.call(ax)}function r(ax){var aw=H(this),ay=aw.find(m.domSelectors.leftColumnItem+"."+c.cssClasses.hover);if(!aw.data("loaded")&&!aw.data("loading")){f(aw)}if(!ay.length){F(aw)}}function y(aw){var av=H(this);H("#main-nav .active").removeClass("active")
}function b(au){H.each(au.items,function(){w[this.catkey]={stories:this.stories,className:(this.className?this.className:null),domain:(this.domain?this.domain:null),catkey:this.catkey}})}function q(){}function i(aB){var az=new Date().getTime();try{var ay=JSON.parse(localStorage.getItem(aB));var aC=ay.timestamp+(ay.expires*24*60*60*1000);if(aC>az){return ay.value}return false}catch(aA){j()}}function j(){var aA=new Date().getTime();var az=new RegExp("taffy_");for(_x in localStorage){try{var ax=JSON.parse(localStorage[_x]);
if(!ax.timestamp){continue}ed=(ax.expires)?ax.expires:1;ed=ax.timestamp+(ed*24*60*60*1000);if(aA>ed){localStorage.removeItem(_x)}}catch(ay){}}}function t(){function au(aw){var at=H(m.domSelectors.navItem+m.domSelectors.preloadData).length?H(m.domSelectors.navItem+m.domSelectors.preloadData):H(m.domSelectors.preloadData);H(at).each(function(){var az=H(this),av=az.data("id"),aA=i(av);if(aA&&nl===undefined){ap(aA,az)}else{if(aw==1){h(az,function(ax){var ay=ax,aC=az.data("menu-type");if(aC!=="external-html"){ay=z(ax);
if(aC==="top-stories"){az.data("loaded",true)}}if(!ay){return}ap(ay,az);if(av){localStorage.setItem(av,JSON.stringify(ay))}},true)}}})}setTimeout(function(){au(1)},"3000")}function n(){var aG=H(".main-area").offset().top+H(".main-area").outerHeight(true),aF=H("#main-nav").outerHeight(true),aC=H(window).height(),aB=A.$allMenuContent.outerHeight(),aH=H("#allsection-data").height(),aI=aC-(aG+aF)-(aB-aH),aD=H("#header").hasClass("blackrock")?"light":"dark-2",aE=aB>aI;if(H.fn.mCustomScrollbar&&aE){A.$allMenuContent.height(aI);
A.$allMenuContent.mCustomScrollbar("destroy");A.$allMenuContent.mCustomScrollbar({theme:aD,scrollButtons:{},advanced:{updateOnContentResize:true,updateOnBrowserResize:true}})}}function E(){A.$navigation.on("mouseover",m.domSelectors.navItem,r);A.$menuMore.on("mouseover",function(){H(this).toggleClass(c.cssClasses.hover);A.$allMenuContent.addClass(c.cssClasses.hover);if(!A.$allMenuContent.data("loaded")){A.$allMenuContent.addClass(c.cssClasses.loader);H.ajax({url:"/allmenu.cms"}).then(function(au){A.$allMenuContent.html(au);
A.$allMenuContent.removeClass(c.cssClasses.loader);A.$allMenuContent.data("loaded",true);n()}).fail(function(){})}});H(document).on("mouseover",function(au){if(H(au.target).hasClass("all-sections")){return}if(!(A.$allMenu.hasClass(c.cssClasses.hover))&&!H(au.target).closest(A.$allMenuContent).length){A.$allMenuContent.removeClass(c.cssClasses.hover)}});require(["tiljs/is"],function(aw){var av="click";if(aw.touch()){av="touchend"}H(".mobiletopnav").on(av,function(){A.$bottomArea.toggleClass("navactive")
})});H(document).on("click",function(aA){if(!H(aA.target).closest(A.$navigation).length){return}var aB=require("is");var aD=!H(aA.target).closest(".no-hover").length;var az=H(aA.target);if(az.closest(".left-column").length){var aE=true;H(".left-column .active").removeClass("active")}else{if(az.closest(".jDropdownOpen").length){var aC=true}}ar.tapTrack=ar.tapTrack||{};ar.tapTrack.latesttap=ar.tapTrack.latesttap||new Date().getTime();if((!aE&&!aC&&aD&&aB.touch())||(aE&&!az.parent("li.jDropdownOpen").length&&aD&&aB.touch())){H(aA.target).closest(".left-column li").addClass("active");
H(".jDropdownOpen").removeClass("jDropdownOpen");H(aA.target).closest("li").addClass("jDropdownOpen");if(!(H(aA.target).closest(A.$allMenu).length||H(aA.target).closest(A.$menuMore).length)){A.$allMenuContent.removeClass(c.cssClasses.hover);A.$allMenu.removeClass(c.cssClasses.hover)}ar.tapTrack.latesttap=new Date().getTime();return false}});A.$allMenu.on("click",function(){A.$allMenuContent.toggleClass(c.cssClasses.hover);H("body").toggleClass("allmenu-active");if(A.$allMenuContent.hasClass(c.cssClasses.hover)){A.$allMenu.addClass(c.cssClasses.hover)
}else{A.$allMenu.removeClass(c.cssClasses.hover)}if(!A.$allMenuContent.data("loaded")){A.$allMenuContent.addClass(c.cssClasses.loader);H.ajax({url:"/allmenu.cms"}).then(function(au){A.$allMenuContent.html(au);A.$allMenuContent.removeClass(c.cssClasses.loader);A.$allMenuContent.data("loaded",true);n()}).fail(function(){})}});if(!H("#pageType").val()||(H("#pageType").val()&&H("#pageType").val().indexOf("video")==-1)){H(".search-form .search-btn").click(function(){var aA=H(this).closest(".search-form"),ax=aA.hasClass("active"),ay=aA.find("form input#query"),az=TimesApps.getGACategory();
if(ax){aA.removeClass("active");ay.blur();ga("send","event",az,"NavBar-Search","Close")}else{aA.addClass("active");ay.focus();ga("send","event",az,"NavBar-Search","Click")}})}}function d(aC,aD){var aE,az=aC.stories,aB=az.length,aA;for(aE=0;aE<aB;aE++){aA=az[aE];aA.pg=(aD+aA.pg.substr(aA.pg.indexOf("#")))}}function G(){var aK=H(this),aI=aK.data("id"),aM=aK.data("external"),aO=aK.data("param-lang"),aF,aH=aK.closest("."+c.cssClasses.dropdown+"."+c.cssClasses.twoColumn),aL=aH.find("."+c.cssClasses.leftColumn),aJ=aL.find("li[data-id]"),aG=aH.find("."+c.cssClasses.rightColumn),aN=H.templates("#top-stories-menu-tmpl"),aE=aK.find("[pg]").attr("pg");
aJ.removeClass(c.cssClasses.hover);aK.addClass(c.cssClasses.hover);if(aM){if(k[aI]){aG.html(k[aI]);aK.closest("."+c.cssClasses.dropdown).find("."+c.cssClasses.rightColumn).removeClass(c.cssClasses.loader);require(["tiljs/plugin/lazy"],function(at){at.load()})}else{require(["tiljs/cookie"],function(av){var au=av.get("geolocation"),at=(window.getCityJSON&&getCityJSON[au]&&getCityJSON[au]["lang"])?getCityJSON[au]["lang"]:"hindi",aw=aM;if(aO){aw=aw+(aw.indexOf("?")>-1?"&":"?")+aO+"="+at}aK.closest("."+c.cssClasses.dropdown).find("."+c.cssClasses.rightColumn).html("").addClass(c.cssClasses.loader);
H.ajax({url:aw}).then(function(ax){k[aI]=ax;aG.html(ax);aK.closest("."+c.cssClasses.dropdown).find("."+c.cssClasses.rightColumn).removeClass(c.cssClasses.loader);require(["tiljs/plugin/lazy"],function(ay){ay.load()})}).fail(function(){o(aI,c.cssClasses.twoColumn)})})}}else{if(w[aI]&&w[aI].stories&&w[aI].stories.length){d(w[aI],aE.substr(0,aE.indexOf("#")));aF=aN.render(w[aI]);aG.html(aF);aK.closest("."+c.cssClasses.dropdown).find("."+c.cssClasses.rightColumn).removeClass(c.cssClasses.loader);require(["tiljs/plugin/lazy"],function(at){at.load()
})}else{o(aI,c.cssClasses.twoColumn)}}}function I(){$leftColumns=A.$navigation.find("."+c.cssClasses.leftColumn);$leftColumns.each(function(){var au=H(this);au.on("mouseover",p.domSelectors.leftColumnItem,function(at){at.stopPropagation();G.call(this)})})}function aq(aw){var ax=aw.offset()?aw.offset().top:0,ay;a.scroll(function(){ay=a.scrollTop();if(!aw.hasClass("sticky")){ax=aw.offset()?aw.offset().top:0}if(ay>ax){aw.addClass("sticky")}else{aw.removeClass("sticky")}})}function u(){H("."+c.cssClasses.leftColumn+" "+p.domSelectors.leftColumnItem).each(function(){var aw=H(this),ax=aw.data("id"),ay=(function(){try{return JSON.parse(localStorage.getItem(ax))
}catch(at){return null}})();if(ay&&ay.items&&ay.items.length){b(ay)}})}function v(aL){var aP=aL.attr("id"),aV=aL.offset().left,aS=aL.width(),aU=aL.children("ul.show-extra"),aQ=aU.width(),aR=aU.children(m.domSelectors.menuItem),aN=aU.find("[data-more-nav]"),aI=aL.find(m.domSelectors.cyclicContainer),aJ=aI.width(),aK=aI.find(".cyclicList"),aM=aK.children(m.domSelectors.menuItem),aT=aV+aS-aJ,aO=0,aW;if(aP==="main-nav"){aO=A.$headerSearch.length?A.$headerSearch.outerWidth(true):50;if(aN){aO+=aN.outerWidth(true)
}}if(aM.length){aM.insertAfter(aR.last());aR=aU.children(m.domSelectors.menuItem)}aR.each(function(av,au){var aw=H(au),ax=aw.offset().left,at=aw.outerWidth(true);if(av===(aR.length-1)&&!aW){aT+=aJ}if((ax+at+aO)>aT&&!aW){aW=av;return false}});if(aW){aR.filter(":gt("+(aW-1)+")").appendTo(aK);aI.removeClass("hidenav")}else{aI.addClass("hidenav")}}D.NavigationManager={init:function(){m=C();l();E();u();t();q();I();aq(A.$bottomArea);if(!H("#pageType").val()||(H("#pageType").val()&&H("#pageType").val().indexOf("video")==-1)){require(["navsearchbox"],function(au){})
}A.$navigation&&A.$navigation.length&&A.$navigation.children("ul").addClass("show-extra");A.$subNav&&A.$subNav.length&&A.$subNav.children("ul").addClass("show-extra")},handleCyclicItems:function(){A.$navigation&&A.$navigation.length&&v(A.$navigation);A.$subNav&&A.$subNav.length&&v(A.$subNav)}}})(window.TimesApps,window,jQuery);if(ag("#main-nav").length){ag(function(){setTimeout(function(){window.TimesApps.NavigationManager.init();window.TimesApps.NavigationManager.handleCyclicItems()})});require(["event"],function(a){a.subscribe("window.resize",window.TimesApps.NavigationManager.handleCyclicItems)
});window.top.adsCallback=function(a){if(typeof a!="undefined"&&a=="gutter"){setTimeout(function(){window.TimesApps.NavigationManager.handleCyclicItems()},1000)}}}});require(["index"]);TimesApps.removeGeoCookies=function(){var d=["geolocation","geostate"];try{localStorage.clear();sessionStorage.clear()}catch(c){}require(["tiljs/cookie"],function(a){for(var b=d.length-1;b>=0;b--){a.remove(d[b],"/","indiatimes.com")}})};TimesApps.handleThirdPartyCalls=function(){var c=function(){TimesApps.thirdPartyAnalytics.init();
if($("#weathershow").html()==""){TimesApps.initWeather()}};var d=function(){TimesApps.removeGeoCookies()};TimesApps.checkGdprAndCall(c,d)};TimesApps.hideads=function(){if(typeof toiprops==="object"&&toiprops.toipr==1){$(".colombia,.ad1,.ctn_ads_rhs,.colombia,.ad,.ads,.ad-widget,div[id^=div-gpt-ad],div[class^=ctn_ads]").remove()}};(function(){TimesApps.removeIfEmpty=function(c){var d=c&&c.find('[data-hide-if-empty="container"]')||$('[data-hide-if-empty="container"]');d.each(function(g,b){var h=$(b),a=h.closest('[data-hide-if-empty="parent"]');
if(h.children().length===0){if(a.length){a.remove()}else{h.remove()}}})};TimesApps.addTinyScrollBar=function(b){require(["tiljs/is"],function(e){var f="desktop";if(e.mobile()){f="mobile"}else{if(e.tablet()){f="tablet"}}var a=b&&b.find('[data-tinyscroll="yes"]')||$('[data-tinyscroll="yes"]');a.each(function(i,d){var j=$(d),c=[];if(j.data("exclude-devices")){c=j.data("exclude-devices").split(",")}if(c.indexOf(f)!==-1){return}j.mCustomScrollbar({theme:j.data("theme")||"dark",scrollButtons:{enable:j.data("scroll-button")||false},scrollInertia:j.data("scroll-inertia")||0,mouseWheel:{enable:j.data("mouse-wheel-enable")||true,scrollAmount:j.data("mouse-wheel-scrollamount")||52},advanced:{updateOnContentResize:j.data("update-on-content-resize")||true}})
})})};$(document).ready(function(){TimesApps.removeIfEmpty();TimesApps.addTinyScrollBar();require(["tiljs/cookie"],function(d){var c=d.get("prc");if(c&&c.split("#")[0]==="0"){d.remove("prc");d.remove("prc","/","indiatimes.com")}})})})();TimesApps.primeCongratsPopup=(function(){var c,d;fn={_init:function(){var a=TimesApps.PopUpManager;d=a&&a.registerPopup("primeCongratsPopup",fn._getPrimeCongratsPopup);require(["event"],function(b){b.subscribe("user.status",function(f){if(f){this._showPrimeCongratsPopup()
}}.bind({_showPrimeCongratsPopup:fn._showPrimeCongratsPopup}))})},_showPrimeCongratsPopup:function(){var a;if(toiprops.cookie.get("prc")&&toiprops.cookie.get("ssoid")){require(["localstoragec"],function(b){a=b.get("congrats_popup");if(a!=="1"){d&&d.onReadyCallback(1)}})}},_getPrimeCongratsPopup:function(){var a=$("body");$.get("/prime_congrats_popup.cms?version=1",function(b){a.append(b);d&&d.onShowCallback(true)});a.on("click",".close-congrats-popup",function(){$("#congrats_popup").remove();require(["localstoragec"],function(b){b.set("congrats_popup","1",365,"/")
})})},_getPopCbs:function(){return d}};c={getPopCbs:fn._getPopCbs};return c})();var TimesApps=window.TimesApps||{};var NotificationCentre=(function(){var g,f,h,i,j;f={apiUrl:"https://timesofindia.indiatimes.com/ncCentreFeed",msgTemplate:null,defaultImg:"https://static.toiimg.com/thumb/imgsize-193484,msid-47529300,width-200,resizemode-4/47529300.jpg",storageKey:"ntCentre_showTime",scrollBarConfig:{theme:"light",scrollButtons:{enable:false},mouseWheel:{enable:true,scrollAmount:52},advanced:{updateOnContentResize:true}},gaAction:"Header-Notification",gaLabelForMsgClick:"Story_View"};
g={container:null,jNtList:null,jNtBell:null,jNtDropdown:null};h=function(){$(document).on("click",i._hide);g.jNtBell.on("click",i._showHide)};i={_init:function(){g.container=$("[data-plugin='nt-centre']");if(!g.container.length){console.log("NotificationCentre, dom template missing");return}g.jNtBell=g.container.find(".jNtBell");g.jNtDropdown=g.container.find(".jNtDropdown");g.jNtList=g.container.find(".jNtList");f.$msgTemplate=$(".jNotificationMsgTemplate").eq(0).clone();h();i._getData(i._render)
},_getData:function(a){$.ajax({url:f.apiUrl,dataType:"json"}).done(function(c){var d;console.log("notification_centre ",c);try{d=typeof c=="object"?c:JSON.parse(c)}catch(b){}a(d)}).fail(function(){g.container.hide()})},_getImgUrl:function(a){var e,b=f.defaultImg,n,m,d=new RegExp("#msid#","g");var c=(a&&a.trim().length)&&a.split("/photo/")[1];e=c?c.split(".cms")[0]:"";if(e){n=f.$msgTemplate.clone();m=n.find(".jNtThumb").eq(0).data("imgsrctemplate")||"";b=m.replace(d,e)}return b},_shouldMarkActive:function(c){var b;
try{b=localStorage.getItem(f.storageKey)}catch(a){}if(c>b){return true}},_getLabelForMsgClickGA:function(c,a){var b="#"+f.gaLabelForMsgClick;b+="-"+c+"-"+a;return b},_createPgAttrForMsgClickGA:function(b,a){return i._getLabelForMsgClickGA(b,a)+"~"+f.gaAction},_render:function(a){var o=0,e=$("<div>");if(!(a&&a.multiBreakingNews)){return}var c=a.multiBreakingNews;for(var d=0;d<c.length;d++){var p=f.$msgTemplate.clone();var q=i._getImgUrl(c[d].icon);var b=c[d].title?(c[d].title+": "):"";b+=c[d].message?c[d].message:"";
p.find("a").attr("href",c[d].path||"");p.find("[pg]").attr("pg",i._createPgAttrForMsgClickGA(d+1,c[d].path));if(i._shouldMarkActive(c[d].bnupdatetime)){p.find("a").addClass("active");o++}p.find(".jNtText").text(b);q&&p.find(".jNtThumb").attr("data-src",q);p.removeClass("jNotificationMsgTemplate").find("[rodate]").attr("rodate",c[d].bnupdatetime);e.append(p)}if(!c.length){var p=f.$msgTemplate.clone();p.find(".jNtThumb").remove();p.find("[rodate]").remove();p.find(".jNtText").text("No Data Available")
}g.jNtList.html(e.html()).mCustomScrollbar(f.scrollBarConfig);if(c.length){o&&g.container.find(".cnt").text(o);require(["rodate"],function(k){k.uptime()})}},_hideShowGA:function(a){TimesApps.GA.send(f.gaAction,a)},_hide:function(b,a){if(!a&&$(b.target).closest(g.container).length){return}g.jNtDropdown.slideUp()},_showHide:function(a){if(g.jNtDropdown.is(":visible")){i._hide(a,true);return}g.jNtDropdown.slideDown();var b=function(){require(["tiljs/plugin/lazy"],function(c){c.load()})};setTimeout(b,0);
try{localStorage.setItem(f.storageKey,Date.now())}catch(a){}i._hideShowGA("Open");g.container.find(".cnt").text("")},_onListScroll:function(a){g.container.find(".notification_title").addClass("ntShadow")},_onTotalScrollBack:function(){g.container.find(".notification_title").removeClass("ntShadow")}};j={};$(document).ready(function(){i._init()});return j}());var TimesApps=window.TimesApps||{};TimesApps.Popup=function(h,i,f,g,j){g=g?g:{};this.id=h;this.lastShownTimeStamp=!!g.lastShownTimeStamp?g.lastShownTimeStamp:null;
this.showPopCallback=i;this.ready=j?j:0;this.priority=f;this.status;this.userActionStatus=null;this.retryDone=0};TimesApps.Popup.prototype.showPopCallback=function(){return this.showPopCallback()};TimesApps.Popup.prototype.getPriority=function(){return this.priority};TimesApps.Popup.prototype.onReadyCallback=function(b){this.ready=b};TimesApps.Popup.prototype.isReady=function(){return this.ready};TimesApps.Popup.prototype.onShowCallback=function(b){this.status=b;if(!!b){this.lastShownTimeStamp=Date.now()
}};TimesApps.Popup.prototype.getStatus=function(){return this.status};TimesApps.Popup.prototype.setStatus=function(){return this.status=false};TimesApps.Popup.prototype.getLastShownTime=function(b){return this.lastShownTimeStamp};TimesApps.Popup.prototype.onUserActionCallback=function(b){this.userActionStatus=b};TimesApps.PopUpManager=(function(){var i,j,k,h,g,l;g={browserStorageKey:"popUpManager",defaultFrequency:7,waitTimeToCheckStatusInMSec:10000,maxRetryCount:2,popupsConfig:{primeCongratsPopup:{frequency:"7",priority:"0"},notification:{frequency:"7",priority:"1"},onetapsignin:{frequency:"7",priority:"2"}}};
l={HRS_IN_DAY:24,MINS_IN_HR:60,SEC_IN_MIN:60,MilliSEC_IN_SEC:1000};i={_popupQueue:[]};j={_init:function(){require(["tiljs/event"],function(a){a.publish("popUpManagerLoaded")})},_register:function(a,c){var b={},d=j._createPopUpObject(a,c);j._addToQueue(d);b={onReadyCallback:j._onReadyCallback.bind(d),onShowCallback:j._onShowCallback.bind(d),onUserActionCallback:d.onUserActionCallback};return b},_onReadyCallback:function(a){this.onReadyCallback(a);$(document).ready(function(){setTimeout(j._analyseQueue,0)
})},_onShowCallback:function(a){this.onShowCallback(a);j._setStatusInStorage()},_createPopUpObject:function(a,d){var f={},b,c,e=j._getPriorityFromConfig(a);c=j._getStatusFromStorage();f.lastShownTimeStamp=c[a]&&c[a].lastShownTime;return new TimesApps.Popup(a,d,e,f)},_addToQueue:function(a){j._sortAndInsert(a)},_sortAndInsert:function(d){var f=i._popupQueue,a=d.getPriority(),e=[];if(!f.length){e.push(d)}for(var b=0;b<f.length;b++){var c=j._getPriorityFromConfig(f[b].id);if(a<c&&b==0){e=[d].concat(f);
break}else{if(a<c){e=f.slice(0,b-1).concact([d]).concat(f.slice(b));break}else{e=f.push(d);break}}}console.log("****popup ",i._popupQueue,e);if(e.length){i._popupQueue=e}},_removeFromQueue:function(a){var d=i._popupQueue,c;for(var b=0;b<d.length;b++){if(d[b].id==a){c=d.slice(0,b).concat(d.slice(b+1));break}}i._popupQueue=c},_getPriorityFromConfig:function(a){var b=null;b=g.popupsConfig[a]&&g.popupsConfig[a]["priority"];return b},_getShowFrequencyFromConfig:function(a){var b;days=g.popupsConfig[a]&&g.popupsConfig[a]["frequency"];
days=(!!days&&!isNaN(days))?days:g.defaultFrequency;b=days*l.HRS_IN_DAY*l.MINS_IN_HR*l.SEC_IN_MIN*l.MilliSEC_IN_SEC;return b},_analyseQueue:function(){console.log("****popup _analyseQueue");var b=j._getStatusFromStorage();latestDisplayedPopup=b.latestDisplayedPopup||{},popUpCoolDownTime=l.HRS_IN_DAY*l.MINS_IN_HR*l.SEC_IN_MIN;if((Date.now()-latestDisplayedPopup.time)<popUpCoolDownTime){console.log("***popup  _pop already displayed in 24hrs");return}for(var c=0;c<i._popupQueue.length;c++){var d=i._popupQueue[c];
var a=d&&j._getShowFrequencyFromConfig(d.id);if(d.getStatus()===false){continue}else{if(d.isReady()&&d.getStatus()!==false&&Date.now()-d.getLastShownTime()>=a){console.log("***popup  analyse showPopCallback ",d.id);d.showPopCallback();j._waitAndCheckStatus(d);break}else{if(d.isReady()&&Date.now()-d.getLastShownTime()<=a){d.setStatus(false);break}else{if(!d.isReady(d.id)){j._waitAndCheckStatus(d);break}}}}}},_waitAndCheckStatus:function(a){a.retryDone+=1;setTimeout(function(){if(!this.popUP.getStatus()&&this.popUP.retryDone<=g.maxRetryCount){this.popUP.setStatus(false);
j._analyseQueue()}}.bind({popUP:a}),g.waitTimeToCheckStatusInMSec)},_setStatusInStorage:function(){var b={},d,c;c={time:null,id:null};for(var e=0;e<i._popupQueue.length;e++){var f=i._popupQueue[e];if(!!f.getLastShownTime()){b[f.id]={lastShownTime:f.getLastShownTime()};if(f.getLastShownTime()>c.time){c.time=f.getLastShownTime();c.id=f.id}}}b.latestDisplayedPopup=c;try{d=JSON.stringify(b)}catch(a){window.console&&console.log("popupManager, JSON error")}localStorage.setItem(g.browserStorageKey,d)},_getStatusFromStorage:function(){var c=localStorage.getItem(g.browserStorageKey),b;
try{b=JSON.parse(c)||{}}catch(a){b={};window.console&&console.log("popupManager, JSON error")}return b}};j._init();k={registerPopup:function(a,b){return j._register(a,b)}};return k}());